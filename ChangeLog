2000-06-28  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/bits/elfclass.h: Deleted.  Hash
	table entries are 32 bit on the ia64 (as specified by the ABI),
	not 64 bit as on the Alpha.

	* shlib-versions: Bump ia64 soname to ld-linux-ia64.so.2 to mark
	change of objects to use 32 bit hash table indices (see above).

2000-06-28  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/ieee754/dbl-64/e_exp.c: Add include stdlib.h to get
	prototype for abs().

2000-06-28  Wolfram Gloger  <wg@malloc.de>

	* malloc/malloc.c (chunk_alloc): If extension of the linear heap
	fails, try mmap_chunk() as a last resort even though n_mmaps_max
	may have been reached.

2000-06-28  Ulrich Drepper  <drepper@redhat.com>

	* locale/programs/ld-collate.c (insert_weights): Handle <Uxxxx>
	symbols in multi-character weights correctly.

	* wcsmbs/mbrtowc.c: Set flush to 1 for conversion function calls
	depending on whether the input string is empty or not.

	* wcsmbs/mbrtowc.c: Calling function without input means clearing the
	given state and not avoiding this by modifying a local object.
	* wcsmbs/wcrtomb.c: Likewise.

	* iconv/skeleton.c: If no EMIT_SHIFT_TO_INIT is defined clear state
	object since some incomplete characters might be in there.

	* iconvdata/euc-jp.c: In conversion to UCS4, handling invalid
	sequences with first by 0x8e correctly.

	* iconvdata/jis0208.h: Remove redundant test.

2000-06-27  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/generic/initfini.c (SECTION): Remove trailing semicolon.
	Add it where it is needed now.

	* locale/programs/ld-ctype.c (ctype_finish): Take all characters from
	the input charset into account when generating the hash table.
	(allocate_arrays): Correct setting default width.  Not all empty slots
	in the table are filled, only those not covert explicitly by the
	locale description and in the charset.

	* wctype/towctrans.c (__towctrans): Be graceful and accept error
	return values from the wctrans function.

	* stdio-common/vfscanf.c: Make sure to always return WEOF and EOF for
	wide character version.
	For %C handling, test correct pointer variable for NULL.

	* wcsmbs/wctob.c: Handle WEOF special.

	* wcsmbs/wcwidth.h: 0xff in width array means invalid character.

	* wctype/wctype.h: Protect gcc-isms with __extension__.  Avoid
	always-true test to avoid warning.

2000-06-27  Greg McGary  <greg@mcgary.org>

	* elf/dl-open.c (_dl_sysdep_start): Wrap weak_extern decl in BP_SYM ().
	* include/libc-symbols.h (weak_extern): Add extra level of expansion.
	(symbol_version, default_symbol_version): Factor redundant
	definitions out of conditional.

2000-06-27  Jakub Jelinek  <jakub@redhat.com>

	* libio/obprintf.c (_IO_obstack_vprintf): Call obstack_make_room,
	not obstack_blank.

2000-06-26  Ulrich Drepper  <drepper@redhat.com>

	* include/libc-symbols.h (symbol_version): Add extra level of
	macro expansion.
	(default_symbol_version): Likewise.

2000-06-26  Greg McGary  <greg@mcgary.org>

	* sysdeps/i386/bp-asm.h (POP_ERRNO_LOCATION_RETURN): Fold insns.
	* sysdeps/unix/i386/sysdep.S (syscall_error): Push & pop space
	for BP return value & push implicit struct-return pointer to
	__errno_location.
	* sysdeps/unix/sysv/linux/i386/sysdep.h: Likewise.
	(SYSCALL_ERROR_HANDLER): Likewise.
	* sysdeps/unix/sysv/linux/i386/i686/sysdep.h
	(SYSCALL_ERROR_HANDLER): Likewise.

	* Makeconfig: Add missing comment.
	* csu/Makefile (extra-objs, omit-deps, install-lib): Add
	BP-flavored startup object.
	($(objpfx)b$(start-installed-name)): New rule.
	* include/libc-symbols.h (symbol_set_declare): Change type
	of `__start_##set' and `__stop_##set' to pointer-to-function.
	(symbol_set_declare): Change type of `set' to array of
	pointer-to-function.
	* include/set-hooks.h (RUN_HOOK): Change type of `ptr' to
	pointer-to-function.

	* string/bits/string2.h: Inhibit inlines if __BOUNDED_POINTERS__.

	* sysdeps/unix/sysv/linux/syscalls.list: Add missing signatures.
	Remove clock_* and timer_* entries.
	* sysdeps/unix/sysv/linux/powerpc/syscalls.list: Replace
	arg-count with signatures.

	* sysdeps/i386/add_n.S: Wrap entry-point symbol in BP_SYM ().
	Check bounds of arguments.
	* sysdeps/i386/addmul_1.S: Likewise.
	* sysdeps/i386/lshift.S: Likewise.
	* sysdeps/i386/mul_1.S: Likewise.
	* sysdeps/i386/rshift.S: Likewise.
	* sysdeps/i386/sub_n.S: Likewise.
	* sysdeps/i386/submul_1.S: Likewise.
	* sysdeps/i386/i586/add_n.S: Likewise.
	* sysdeps/i386/i586/addmul_1.S: Likewise.
	* sysdeps/i386/i586/lshift.S: Likewise.
	* sysdeps/i386/i586/rshift.S: Likewise.
	* sysdeps/i386/i586/sub_n.S: Likewise.
	* sysdeps/i386/i686/add_n.S: Likewise.

	* sysdeps/i386/memchr.S: Likewise.
	* sysdeps/i386/memcmp.S: Likewise.
	* sysdeps/i386/rawmemchr.S: Likewise.
	* sysdeps/i386/i586/bzero.S: Likewise.
	* sysdeps/i386/i586/memcpy.S: Likewise.
	* sysdeps/i386/i586/mempcpy.S: Likewise.
	* sysdeps/i386/i586/memset.S: Likewise.
	* sysdeps/i386/i686/bzero.S: Likewise.
	* sysdeps/i386/i686/memcpy.S: Likewise.
	* sysdeps/i386/i686/mempcpy.S: Likewise.
	* sysdeps/i386/i686/memset.S: Likewise.

	* sysdeps/i386/stpcpy.S: Likewise.
	* sysdeps/i386/stpncpy.S: Likewise.
	* sysdeps/i386/strchr.S: Likewise.
	* sysdeps/i386/strchrnul.S: Likewise.
	* sysdeps/i386/strcspn.S: Likewise.
	* sysdeps/i386/strpbrk.S: Likewise.
	* sysdeps/i386/strrchr.S: Likewise.
	* sysdeps/i386/strspn.S: Likewise.
	* sysdeps/i386/strtok.S: Likewise.
	* sysdeps/i386/strtok_r.S: Likewise.
	* sysdeps/i386/i486/strcat.S: Likewise.
	* sysdeps/i386/i486/strlen.S: Likewise.
	* sysdeps/i386/i586/strchr.S: Likewise.
	* sysdeps/i386/i586/strcpy.S: Likewise.
	* sysdeps/i386/i586/strlen.S: Likewise.
	* sysdeps/i386/i686/strcmp.S: Likewise.
	* sysdeps/i386/i686/strtok.S: Likewise.
	* sysdeps/i386/i686/strtok_r.S: Likewise.

	* sysdeps/i386/fpu/fegetenv.c: Wrap symbol names with BP_SYM ().
	* sysdeps/i386/fpu/fesetenv.c: Likewise.
	* sysdeps/i386/fpu/feupdateenv.c: Likewise.
	* sysdeps/i386/fpu/fgetexcptflg.c: Likewise.
	* sysdeps/i386/fpu/fsetexcptflg.c: Likewise.

	* sysdeps/i386/addmul_1.S: Exchange roles of %ebp and %ebx.
	* sysdeps/i386/mul_1.S: Likewise.
	* sysdeps/i386/submul_1.S: Likewise.
	* sysdeps/i386/i586/add_n.S: Likewise.
	* sysdeps/i386/i586/addmul_1.S: Likewise.
	* sysdeps/i386/i586/lshift.S: Likewise.
	* sysdeps/i386/i586/mul_1.S: Likewise.
	* sysdeps/i386/i586/rshift.S: Likewise.
	* sysdeps/i386/i586/sub_n.S: Likewise.
	* sysdeps/i386/i586/submul_1.S: Likewise.

2000-06-26  Ulrich Drepper  <drepper@redhat.com>

	* rt/Makefile (librt-routines): Add clock_nanosleep.
	* rt/Versions [GLIBC_2.2] (librt): Add clock_nanosleep.
	* sysdeps/generic/clock_nanosleep.c: New file.
	* sysdeps/unix/clock_nanosleep.c: New file.
	* sysdeps/unix/i386/i586/clock_nanosleep.c: New file.
	* time/time.h: Declare clock_nanosleep.

2000-06-26  Greg McGary  <greg@mcgary.org>

	* sysdeps/i386/asm-syntax.h (R, MEM, MEM_DISP, MEM_INDEX,
	INSN1, INSN2, TEXT, GLOBL): Remove macros.
	(ALIGN): Cleanup surrounding conditionals.

	* sysdeps/i386/addmul_1.S: Replace asm-syntax macros with gas syntax.
	Call ENTER/LEAVE macros.
	* sysdeps/i386/mul_1.S: Replace asm-syntax macros with gas syntax.
	* sysdeps/i386/submul_1.S: Likewise.

	* sysdeps/i386/i586/addmul_1.S: Replace asm-syntax macros with gas
	syntax.  Define & use symbolic argument stack offsets.  Call
	ENTER/LEAVE macros.
	* sysdeps/i386/i586/mul_1.S: Likewise.
	* sysdeps/i386/i586/submul_1.S: Likewise.

2000-06-25  Greg McGary  <greg@mcgary.org>

	* sysdeps/i386/i586/memcpy.S: Redefine memcpy as mempcpy,
	not as bcopy.

2000-06-25  Ulrich Drepper  <drepper@redhat.com>

	* iconvdata/gen-8bit-gap-1.sh: Update for new charmap format.
	* iconvdata/gen-8bit-gap.sh: Likewise.
	* iconvdata/gen-8bit.sh: Likewise.

	* iconv/gconv_open.c (__gconv_open): Move comment to correct position.

	* locale/programs/ld-collate.c (collate_read): Don't actually read
	the copy locale if we are ignoring the content.

	* locale/programs/ld-address.c (INT_STR_ELEM): Correct test for
	unknown character.

	* locale/programs/ld-collate.c: Correct handling of different
	collation sections.
	* locale/programs/localedef.c (add_to_readlist): Take locale pointer
	as extra parameter from which to copy category information.
	Change all callers.
	(load_locale): Likewise.
	* locale/programs/localedef.h: Update prototypes of add_to_readlist
	and load_locale.
	* locale/programs/ld-ctype.c: Update call to add_to_readlist.
	* locale/programs/locfile.h: Likewise.
	* locale/programs/locfile-kw.gperf: Add entry for script.
	* locale/programs/locfile-token.h: Add tok_script.

	* locale/programs/locale.c: Update copyright year.
	* locale/programs/localedef.c: Likewise.

2000-06-23  Thorsten Kukuk  <kukuk@suse.de>

	* sunrpc/xdr_rec.c (set_input_fragment): Fix PR libc/1549, patch from
	Jens Moeller <jens.moeller@waii.com>.

2000-06-24  Ulrich Drepper  <drepper@redhat.com>

	* locale/programs/ld-name.c (name_finish): Add missing format
	specifier to test for name_fmt.

	* locale/programs/ld-address.c (iso639): Correct length of string
	elements.
	(iso3166): Likewise.

	* sysdeps/unix/sysv/linux/i386/sys/elf.h (elf_fpxregset_t): Define.

	* sysdeps/unix/sysv/linux/i386/sys/user.h (struct user_fpxregs_struct):
	Define.

	* elf/elf.h (NT_PRFPXREG): Define.

2000-06-23  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/sys/ptrace.h (__ptrace_request): Define
	PTRACE_GETFPXREGS and PTRACE_SETFPXREGS.

2000-06-23  Andreas Schwab  <schwab@suse.de>

	* sysdeps/unix/sysv/linux/m68k/syscalls.list: Replace arg-count
	with signatures.

2000-06-23  Andreas Jaeger  <aj@suse.de>

	* iconv/gconv_int.h (norm_add_slashes): Protect suffix expansion.

	* io/test-stat.c: Add copyright header, mention Maciej.

	* sysdeps/unix/sysv/linux/mips/sys/syscall.h (SYS_pivot_root,
	SYS_mincore, SYS_madvise): Added.

	* sysdeps/unix/sysv/linux/mips/syscalls.list: Fix signature of
	execve.

2000-06-22  Ulrich Drepper  <drepper@redhat.com>

	* libio/Makefile (tests): Add tst-getwc and tst_putwc.
	(CFLAGS-tst_putwc.c): New definition.
	* libio/tst_getwc.c: New file.
	* libio/tst_getwc.input: New file.
	* libio/tst_putwc.c: New file.

	* include/string.h: Add prototype for __strdup.

2000-06-22  Greg McGary  <greg@mcgary.org>

	* sysdeps/unix/syscalls.list (sys_mknod): Fix signatures.
	* sysdeps/unix/inet/syscalls.list (accept, getpeername, getsockname):
	Fix signatures.

2000-06-23  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/ia64/memcpy.S: Disable branch predict instruction.

2000-06-22  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/bits/statfs.h: New file.

2000-06-22  Jes Sorensen  <jes@linuxcare.com>

	* shlib-versions: Bump so versions to 6.1 for libc and libm on the
	ia64 to allow 2.2+ libraries to coexist with 2.1 ones.

2000-06-22  Ulrich Drepper  <drepper@redhat.com>

	* io/sys/stat.h: Define S_TYPEISMQ, S_TYPEISSEM, and S_TYPEISSHM.
	* sysdeps/generic/bits/stat.h: Define __S_TYPEISMQ, __S_TYPEISSEM,
	and __S_TYPEISSHM.
	* sysdeps/mach/hurd/bits/stat.h: Likewise.
	* sysdeps/unix/bsd/bits/stat.h: Likewise.
	* sysdeps/unix/bsd/osf/alpha/bits/stat.h: Likewise.
	* sysdeps/unix/sysv/bits/stat.h: Likewise.
	* sysdeps/unix/sysv/irix4/bits/stat.h: Likewise.
	* sysdeps/unix/sysv/hpux/bits/stat.h: Likewise.
	* sysdeps/unix/sysv/linux/alpha/bits/stat.h: Likewise.
	* sysdeps/unix/sysv/linux/ia64/bits/stat.h: Likewise.
	* sysdeps/unix/sysv/linux/bits/stat.h: Likewise.
	* sysdeps/unix/sysv/linux/mips/bits/stat.h: Likewise.
	* sysdeps/unix/sysv/sysv4/i386/bits/stat.h: Likewise.
	* sysdeps/unix/sysv/sysv4/solaris2/bits/stat.h: Likewise.
	* sysdeps/unix/sysv/aix/bits/stat.h: Likewise.
	* manual/filesys.texi: Document S_TYPEISMQ, S_TYPEISSEM, and
	S_TYPEISSHM.

2000-06-22  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/mips/syscalls.list: Replace arg-count
	with signatures.

	* elf/dl-reloc.c (_dl_relocate_object): Fix typos.

	* sysdeps/unix/sysv/linux/mips/syscalls.list: Fix sysctl entry.

2000-06-21  Ulrich Drepper  <drepper@redhat.com>

	* iconv/gconv_trans.c: Move initialization of winbuf and winbufend
	ahead.

2000-06-21  Greg McGary  <greg@mcgary.org>

	* Makerules (elide-routines.*, elide-bp-thunks):
	Define unconditionally.

2000-06-21  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/Makefile: New file.

2000-06-21  Andreas Jaeger  <aj@suse.de>

	* io/Makefile (tests): Add test-stat.
	(CFLAGS-test-stat.c): New.

	* io/test-stat.c: New file from Maciej W. Rozycki
	<macro@ds2.pg.gda.pl>.

2000-06-21  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/bits/resource.h: Reorder elements
	in __rlimit_resource to make them match the kernel order.
	rlim_t is always 64 bit, use __rlim64_t to declare it
	unconditionally.

2000-05-04  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/bits/resource.h: Undef
	RLIM_INFINITY before defining it to avoid clash with kernel header

2000-05-03  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/bits/resource.h: New file.

2000-06-21  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/ia64/Versions: New file.

2000-06-21  Andreas Jaeger  <aj@suse.de>

	* stdio-common/temptest.c: Include <stdlib.h>.
	* stdio-common/tst-fileno.c: Likewise.
	* stdio-common/scanf4.c: Likewise.
	* stdio-common/scanf5.c: Likewise.
	* time/clocktest.c: Likewise.
	* posix/test-vfork.c: Likewise.
	* posix/globtest.c: Likewise.
	* io/test-utime.c: Likewise.
	* wctype/test_wcfuncs.c: Likewise.
	* crypt/cert.c: Likewise.

	* stdio-common/tst-printfsz.c: Include <string.h>.
	* libio/tst_swscanf.c: Likewise.
	* libio/tst_wscanf.c: Likewise.
	* posix/runtests.c: Likewise.
	* posix/tst-getaddrinfo.c: Likewise.
	* posix/wordexp-test.c: Likewise.
	* misc/tst-efgcvt.c: Likewise.

	* stdlib/tst-xpg-basename.c: Include <stdlib.h> and <string.h>.
	* nss/test-netdb.c: Likewise.

	* sysdeps/unix/sysv/linux/configure.in: Add check for minimal
	supported kernel for MIPS.

	* elf/vismod2.c: Include <stdlib.h> for abort prototype.
	* rt/aio_suspend.c: Likewise.

2000-06-20  Ulrich Drepper  <drepper@redhat.com>

	* math/libm-test.inc: Include <string.h>.

2000-06-20  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/syscalls.list: New file.

2000-06-20  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/machine-gmon.h: New file.
	* sysdeps/unix/sysv/linux/ia64/profil-counter.h: New file.

2000-06-20  David Mosberger-Tang  <davidm@hpl.hp.com>

	* sysdeps/unix/sysv/linux/ia64/getpagesize.c: New file.

2000-06-20  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/sys/ucontext.h: Fix typo.

2000-06-20  Ulrich Drepper  <drepper@redhat.com>

	* locale/programs/ld-collate.c (insert_value): Now take string and
	length instead of struct token* parameter.  Adjust use of token.
	(handle_ellipsis): Likewise.
	(collate_read): Allow <Uxxxx> names and transform them into names
	to be passed to insert_value and handle_ellipsis.

	* locale/programs/ld-ctype.c (uninames): New array with names of
	digits in <Uxxxxxxxx> format.
	(ctype_finish): Correct search for space character value.  Likewise
	for default outdigits values.

2000-06-20  Greg McGary  <greg@mcgary.org>

	* Makerules (objects): Add BP thunks.

2000-06-20  Ulrich Drepper  <drepper@redhat.com>

	* locale/programs/charmap.c (parse_charmap): Handle UCS names also
	in width definitions.

2000-06-20  Andreas Jaeger  <aj@suse.de>

	* sysdeps/mips/fpu/libm-test-ulps: New file.

	* sysdeps/mips/fpu/fesetenv.c (__fesetenv): Flush fpu pipeline
	first.

	* sysdeps/mips/fpu/feholdexcpt.c: New file.

	* sysdeps/mips/fpu/fraiseexcpt.c: New file.

2000-06-19  Ulrich Drepper  <drepper@redhat.com>

	* iconv/gconv_builtin.c (BUILTIN_TRANSFORMATION): Update for
	change in gconv_builtin.h.

	* malloc/Makefile: Change all references to memprof into memusage.
	* malloc/memprof.c: Rename to...
	* malloc/memusage.c: ...this.  New file.
	* malloc/memprof.sh: Rename to...
	* malloc/memusage.sh: ...this.  New file.
	* malloc/memprofstat.c: Rename to...
	* malloc/memusagestat.c: ...this.  New file.
	* sysdeps/alpha/memprof.h: Rename to..
	* sysdeps/alpha/memusage.h: ...this.  New file.
	* sysdeps/arm/memprof.h: Rename to..
	* sysdeps/arm/memusage.h: ...this.  New file.
	* sysdeps/generic/memprof.h: Rename to..
	* sysdeps/generic/memusage.h: ...this.  New file.
	* sysdeps/i386/memprof.h: Rename to..
	* sysdeps/i386/memusage.h: ...this.  New file.
	* sysdeps/ia64/memprof.h: Rename to..
	* sysdeps/ia64/memusage.h: ...this.  New file.
	* sysdeps/m68k/memprof.h: Rename to..
	* sysdeps/m68k/memusage.h: ...this.  New file.
	* sysdeps/mips/memprof.h: Rename to..
	* sysdeps/mips/memusage.h: ...this.  New file.
	* sysdeps/powerpc/memprof.h: Rename to..
	* sysdeps/powerpc/memusage.h: ...this.  New file.
	* sysdeps/sparc/memprof.h: Rename to..
	* sysdeps/sparc/memusage.h: ...this.  New file.
	* sysdeps/sh/memprof.h: Rename to..
	* sysdeps/sh/memusage.h: ...this.  New file.

	* elf/sprof.c (print_version): Update year.

	* elf/sprof.c (load_shobj): Don't always add load address to dynamic
	table entry values.  Use D_PTR.
	* elf/dl-reloc.c (_dl_relocate_object): Don't start profiling weird
	binaries without PLT.  Patches by James Mathiesen <james@curl.com>.

2000-06-20  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/Makefile: New file.
	* sysdeps/unix/sysv/linux/ia64/sys/io.h: New file.
	* sysdeps/unix/sysv/linux/ia64/sys/procfs.h: New file.
	* sysdeps/unix/sysv/linux/ia64/sys/ucontext.h: New file.

2000-05-05  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/bits/fcntl.h: New file.

2000-06-16  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/xstat.c: New file.
	* sysdeps/unix/sysv/linux/ia64/fxstat.c: New file.
	* sysdeps/unix/sysv/linux/ia64/lxstat.c: New file.

	* sysdeps/unix/sysv/linux/ia64/xstatconv.c: Deleted.

	* sysdeps/unix/sysv/linux/ia64/bits/stat.h: Update after latest
	kernel change.

	* sysdeps/unix/sysv/linux/ia64/bits/types.h: Make __ino_t,
	__nlink_t and __blkcnt_t 64 bit to accomodate new kernel stat data
	structure.
	Change __fsblkcnt_t and __fsfilcnt_t to 64 bit to match kernel
	implementation.

2000-06-15  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/kernel_stat.h: Deleted.

2000-06-08  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/mmap64.c: New file.

2000-06-19  Ulrich Drepper  <drepper@redhat.com>

	* iconv/gconv_int.h (strict gconv_module): Remove all members
	associated with regular expressions.  Use a simple string as the
	from name.
	* iconv/gconv_db.c: Remove code handling regular expressions.
	* iconv/gconv_conf.c: Likewise.
	* iconv/iconv_prog.c: Likewise.
	* iconv/gconv_builtin.h: Adjust for change in gconv_conf.c.

	* iconv/gconv.h (__gconv_trans_fct): Add new parameter.
	General namespace cleanup.
	(struct __gconv_trans_data): Add next field.
	(struct __gconv_step_data): Make __trans a pointer.
	* iconv/gconv_conf.c: Split out code to find gconv directories from
	__gconv_read_conf in new functions.
	* iconv/gconv_int.h: Define new data structure and declare new
	functions for handling of gconv directory list.
	* iconv/gconv_open.c: Allow more than one error handling step being
	used.  Call function to load error handling module if it is none
	of the builtin transformations.
	* iconv/gconv_close.c: Add code to free transliteration data.
	* iconv/gconv_trans.c: Add functions to load and unload modules
	implementing transliteration etc.
	* iconv/skeleton.c: Call all context functions now that more than
	one module is allowed.
	* iconv/loop.c (STANDARD_ERR_HANDLING): New macro.
	* iconv/gconv_simple.c: Use STANDARD_ERR_HANDLING macro for places
	where the full error handling using transliteration is needed.
	* iconvdata/8bit-gap.c: Likewise.
	* iconvdata/8bit-generic.c: Likewise.
	* iconvdata/ansi_x3.110.c: Likewise.
	* iconvdata/big5.c: Likewise.
	* iconvdata/big5hkscs.c: Likewise.
	* iconvdata/euc-cn.c: Likewise.
	* iconvdata/euc-jp.c: Likewise.
	* iconvdata/euc-kr.c: Likewise.
	* iconvdata/euc-tw.c: Likewise.
	* iconvdata/gbgbk.c: Likewise.
	* iconvdata/gbk.c: Likewise.
	* iconvdata/iso-2022-cn.c: Likewise.
	* iconvdata/iso-2022-jp.c: Likewise.
	* iconvdata/iso-2022-kr.c: Likewise.
	* iconvdata/iso646.c: Likewise.
	* iconvdata/iso8859-1.c: Likewise.
	* iconvdata/iso_6937-2.c: Likewise.
	* iconvdata/iso_6937.c: Likewise.
	* iconvdata/johab.c: Likewise.
	* iconvdata/sjis.c: Likewise.
	* iconvdata/t.61.c: Likewise.
	* iconvdata/uhc.c: Likewise.
	* iconvdata/unicode.c: Likewise.
	* iconvdata/utf-16.c: Likewise.
	* libio/iofwide.c: Reset __trans member of __gconv_trans_data
	structure correctly after last change.
	* wcsmbs/btowc.c: Likewise.
	* wcsmbs/mbrtowc.c: Likewise.
	* wcsmbs/mbsnrtowcs.c: Likewise.
	* wcsmbs/mbsrtowcs.c: Likewise.
	* wcsmbs/wcrtomb.c: Likewise.
	* wcsmbs/wcsnrtombs.c: Likewise.
	* wcsmbs/wcsrtombs.c: Likewise.
	* wcsmbs/wctob.c: Likewise.

	* localedata/Makefile: Set -Wno-format for some files since gcc does
	not know all the format specifiers.

2000-06-18  Ulrich Drepper  <drepper@redhat.com>

	* locale/loadlocale.c (_nl_unload_locale): Remove a bit of
	unneeded code.
	* locale/lc-time.c (_nl_init_era_entries): Likewise.

2000-06-18  Andreas Jaeger  <aj@suse.de>

	* sysdeps/mips/dl-machine.h: Always use $25 as jump register.
	Patch by Ralf Baechle <ralf@uni-koblenz.de>.

2000-06-17  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/alpha/fpathconf.c: Define and use
	LINUX_LINK_MAX.
	* sysdeps/unix/sysv/linux/alpha/pathconf.c: Likewise.

	* locale/programs/ld-ctype.c (ctype_output): Really write out
	mboutdigits information.
	* localedata/tst-trans.c: Add code to test printf's I flag with locale.
	* localedata/tst-trans.sh: Set GCONV_PATH for compilation environment.
	* localedata/tests/trans.def: Add outdigit information.

	* localedata/tst-mbswcs3.c: Remove comment.

	* stdio-common/vfprintf.c (vfprintf): Fix handling of I flag.
	* stdio-common/tiformat.c (sprint_ints): Add tests for I flag.
	* libio/tst_wprintf.c (main): Add test for I flag.

	* iconv/gconv_trans.c: Implement handling if translit_ignore.
	* locale/langinfo.h: Add entries for translit_ignore information.
	* locale/categories.def: Add entries for new LC_CTYPE elements.
	* locale/C-ctype.c: Add initializers for new fields.  Use NULL
	pointer instead of "" where possible.
	* locale/programs/ld-ctype.c: Write out translit_ignore information.
	* intl/Depend: Add localedata.
	* intl/tst-gettext.c: Call setlocale for LC_CTYPE.
	* intl/tst-gettext.sh: Set LOCPATH to localedata build dir.

2000-06-16  Ulrich Drepper  <drepper@redhat.com>

	* locale/langinfo.h: Add entries for default_missing information.
	* locale/C-ctype.c: Add initializers for new fields.
	* iconv/gconv_trans.c: If nothing matched, try to use default_missing
	information.
	* locale/categories.h: Add entries for all LC_CTYPE values.
	* locale/programs/ld-ctype.c (ctype_output): Write out default_missing
	information.

	* localedata/tst-trans.c: Write out an error message if class is
	not found.

	* iconv/gconv_int.h (norm_add_slashes): Optionally add given suffix.
	* iconv/gconv_open.c: Remove error handling specification from `from'
	character set name.
	* intl/loadmsgcat.c (_nl_load_domain): Call norm_add_slashes with
	new parameter to always enable transliteration.
	* locale/localeinfo.h (LIMAGIC): Bump number because of incompatible
	change.
	(struct locale_data): Add new members use_translit and options.
	* locale/findlocale.c (_nl_find_locale): Set use_translit flag is
	character set name contained modifier TRANSLIT.
	* locale/loadlocale.c (_nl_load_locale): Initialize new use_translit
	and options fields.
	(_nl_unload_locale): Free options string if necessary.
	* wcsmbs/wcsmbsload.c (__wcsmbs_load_conv): Enable translation if
	the locale names suggested this.
	* locale/C-address.c: Add two new initialilzers to adjust data
	structure for new format.
	* locale/C-collate.c: Likewise.
	* locale/C-ctype.c: Likewise.
	* locale/C-identification.c: Likewise.
	* locale/C-measurement.c: Likewise.
	* locale/C-messages.c: Likewise.
	* locale/C-monetary.c: Likewise.
	* locale/C-name.c: Likewise.
	* locale/C-numeric.c: Likewise.
	* locale/C-paper.c: Likewise.
	* locale/C-telephone.c: Likewise.
	* locale/C-time.c: Likewise.

	* locale/setlocale.c: Add some more __builtin_expect.

2000-06-15  Ulrich Drepper  <drepper@redhat.com>

	* iconv/gconv.h (__gconv_fct): Change type of fifth parameter to
	unsigned char **.
	(__gconv_init_fct): Remove two parameters.
	* iconv/gconv_int.h (__gconv_transliterate): Renamed from
	gconv_transliterate.  Remove two parameters.
	Change prototypes of builtin functions according to __gconv_fct change.
	* iconv/skeleton.c: Change type of fifth parameter.  make sure it is
	!= NULL only during error handling.  Stop in this case after the
	conversion.
	* iconv/gconv_trans.c: Replace with real implementation for
	__gconv_transliterate.
	* iconv/gconv_open.c: Adjust for renaming of __gconv_transliterate.
	* iconv/gconv.c: Change calls to downstream functions once again.
	Use NULL for the fifth parameter instead of pointer to output buffer.
	* libio/iofwide.c: Likewise.
	* wcsmbs/btowc.c: Likewise.
	* wcsmbs/mbrtowc.c: Likewise.
	* wcsmbs/mbsnrtowcs.c: Likewise.
	* wcsmbs/mbsrtowcs.c: Likewise.
	* wcsmbs/wcrtomb.c: Likewise.
	* wcsmbs/wcsnrtombs.c: Likewise.
	* wcsmbs/wcsrtombs.c: Likewise.
	* wcsmbs/wctob.c: Likewise.
	* iconv/gconv_simple.c: Remove two parameters from error handling
	function call.
	* iconvdata/8bit-gap.c: Likewise.
	* iconvdata/8bit-generic.c: Likewise.
	* iconvdata/ansi_x3.110.c: Likewise.
	* iconvdata/big5.c: Likewise.
	* iconvdata/big5hkscs.c: Likewise.
	* iconvdata/euc-cn.c: Likewise.
	* iconvdata/euc-jp.c: Likewise.
	* iconvdata/euc-kr.c: Likewise.
	* iconvdata/euc-tw.c: Likewise.
	* iconvdata/gbgbk.c: Likewise.
	* iconvdata/gbk.c: Likewise.
	* iconvdata/iso-2022-cn.c: Likewise.
	* iconvdata/iso-2022-jp.c: Likewise.
	* iconvdata/iso-2022-kr.c: Likewise.
	* iconvdata/iso646.c: Likewise.
	* iconvdata/iso8859-1.c: Likewise.
	* iconvdata/iso_6937-2.c: Likewise.
	* iconvdata/iso_6937.c: Likewise.
	* iconvdata/johab.c: Likewise.
	* iconvdata/sjis.c: Likewise.
	* iconvdata/t.61.c: Likewise.
	* iconvdata/uhc.c: Likewise.
	* iconvdata/unicode.c: Likewise.
	* iconvdata/utf-16.c: Likewise.

2000-06-15  Greg McGary  <greg@mcgary.org>

	* sysdeps/unix/make-syscalls.sh: Strip leading whitespace from lhs
	of callnum assignment.  Tolerate callnum expressions containing
	parens.

2000-06-14  Ulrich Drepper  <drepper@redhat.com>

	* login/Makefile (utmpd): Remove rule to build utmpd.

	* csu/Versions: Move libgcc frame handling functions from here...
	* sysdeps/unix/sysv/linux/alpha/Versions: ...to here...
	* sysdeps/unix/sysv/linux/arm/Versions: ...to here...
	* sysdeps/unix/sysv/linux/i386/Versions: ...to here...
	* sysdeps/unix/sysv/linux/m68k/Versions: ...to here...
	* sysdeps/unix/sysv/linux/powerpc/Versions: ...to here...
	* sysdeps/unix/sysv/linux/sparc/sparc32/Versions: ...and here.
	New file.
	* sysdeps/mach/hurd/i386/Versions: ...and here.  New file.

	* locale/programs/ld-ctype.c (allocate_arrays): Correct a comment.

	* misc/syslog.c (vsyslog): Initialize msgoff in all cases.

2000-06-14  Kazumoto Kojima  <kkojima@rr.iij4u.or.jp>

	* sysdeps/sh/sh4/fpu/fclrexcpt.c: Remove definitions for backward
	compatibility.
	* sysdeps/sh/sh4/fpu/fegetenv.c: Likewise.
	* sysdeps/sh/sh4/fpu/fesetenv.c: Likewise.
	* sysdeps/sh/sh4/fpu/fraiseexcpt.c: Likewise.
	* sysdeps/sh/sh4/fpu/fsetexcptflg.c: Likewise.

2000-06-14  Jakub Jelinek  <jakub@redhat.com>

	* include/libc-symbols.h (link_warning): If HAVE_SECTION_QUOTES is
	defined, terminate quotes and read them after the comment char.
	* configure.in (HAVE_SECTION_QUOTES): Test whether
	__attribute__((section ("x"))) puts quotes around x or not.
	* config.h.in (HAVE_SECTION_QUOTES): Add.
	* configure: Rebuilt.

2000-06-14  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/configure.in: Set libc_cv_sysconfdir
	depending on the configure option --sysconfdir.
	Closes PR libc/1762.
	Patch by Andreas Schwab <schwab@suse.de>.

	* sysdeps/mips/dl-machine.h: Pass finalizer correctly to user
	entry point.
	Reported by Jim Pick <jim@jimpick.com>.

2000-06-14  Ulrich Drepper  <drepper@redhat.com>

	* misc/syslog.c (vsyslog): Allow open_memstream to fail without
	crashing the application.  Emit some simple error message.
	Reported by mju@panasas.com [PR libc/1769].

2000-06-13  Ulrich Drepper  <drepper@redhat.com>

	* malloc/Makefile (distribute): Add memprof.sh and memprofstat.c.

	* crypt/Makefile (distribute): Add md5.h.

	* Makefile (distribute): Add include/shlib-compat.h.

	* Make-dist: Search for tests also in sysdeps hierachy.

	* crypt/Makefile (distribute): Add ufc-crypt.h, crypt-private.h,
	ufc.c, speeds.c, README.ufc-crypt, and Banner.

	* sysdeps/sparc/Subdirs: New file.

	* locale/Makefile (distribute): Add weightwc.h and
	programs/localedef.h.

	* time/Makefile (distribute): Add datemsk.

	* sysdeps/ia64/Dist: Add softpipe.h.

	* sysdeps/unix/sysv/aix/Dist: New file.

	* posix/setpgrp.c: Moved to...
	* sysdeps/generic/setpgrp.c: ...here.  New file.
	* io/mknod.c: Moved to...
	* sysdeps/generic/mknod.c: ...here.  New file.

	* sysdeps/unix/sysv/linux/ia64/Dist: New file.

	* sysdeps/unix/sysv/linux/sparc/Dist: Add sys/procfs.h.

	* sysdeps/unix/sysv/linux/arm/Dist: Add oldgetrlimit64.c.

	* sysdeps/powerpc/Dist: Add fprrest.S, fprsave.S, gprsave1.S,
	gprsave0.S, gprrest1.S, and gprrest0.S.

	* sysdeps/generic/Dist: Add bp-thunks.h, bp-sym.h, and bp-start.h.

	* posix/Makefile (routines): Add spawnattr_getsigmask,
	spawnattr_getschedpolicy, spawnattr_getschedparam,
	spawnattr_setsigmask, spawnattr_setschedpolicy, and
	spawnattr_setschedparam.
	* posix/Versions: Add posix_spawnattr_getschedpolicy,
	posix_spawnattr_setschedpolicy, posix_spawnattr_getschedparam, and
	posix_spawnattr_setschedparam.

	* posix/spawnattr_setschedparam.c: Fix typo.

	* posix/spawnattr_setsigmask.c (posix_spawnattr_setsigmask):
	Correct typo.

	* login/programs/utmpd.c: Removed.
	* login/programs/utmpd.h: Removed.
	* login/programs/utmpd-private.h: Removed.

	* Makefile (distribute): Add include/db_185.h and include/db.h.

	* iconvdata/Makefile (distribute): Add iso-ir-165.c and
	iso-ir-165.h.

	* elf/Makefile (distribute): Add missing files.

	* dlfcn/Makefile: Add back rules to include eval in libdl.so.
	* elf/eval.c: Moved to...
	* dlfcn/eval.c: ...here.  New file.

	* Makefile (distribute): Also distribute ChangeLog.1?.

	* Make-dist (+tsrcs): Remove .args handling here as well.

	* rt/Makefile (tests): Add tst-timer.
	* sysdeps/generic/tst-timer.c: New file.

	* Makerules (sources): Don't add BP sources here.

	* login/Makefile (distribute): Remove xtmp.h.

	* iconv/iconv_prog.c (main): Fix appending slashes if omit_invalid
	is true.  Reported by Bruno Haible <haible@ilog.fr>.

2000-06-13  Andreas Jaeger  <aj@suse.de>

	* sysdeps/mips/elf/start.S (ENTRY_POINT): Remove mips64 defines.
	Patch by Ralf Baechle <ralf@gnu.org>.

2000-06-13  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/syscalls.list: Add parameter information
	for mincore syscall.

	* misc/sys/cdefs.h: Define __bounded and __unbounded if
	__BOUNDED_POINTERS__ is not defined.

2000-06-07  Greg McGary  <greg@mcgary.org>

	* sysdeps/generic/bp-sym.h: New file.
	* sysdeps/generic/bp-start.h: New file.
	* sysdeps/i386/elf/start.S: Designate BP symbols.
	* sysdeps/generic/libc-start.c: Wrap bounds around
	argv & envp and each of their string members.

2000-06-07  Greg McGary  <greg@mcgary.org>

	* sysdeps/unix/make-syscalls.sh: Add comments to
	output that aid debugging & comprehension.
	Map simple syscall signatures to number of args.
	Generate BP syscall thunk definitions.
	* sysdeps/generic/bp-thunks.h: New file.
	* sysdeps/unix/syscalls.list: Replace arg-count with
	simple return+arg signature.
	* sysdeps/unix/common/syscalls.list: Likewise.
	* sysdeps/unix/inet/syscalls.list: Likewise.
	* sysdeps/unix/mman/syscalls.list: Likewise.
	* sysdeps/unix/sysv/syscalls.list: Likewise.
	* sysdeps/unix/sysv/linux/syscalls.list: Likewise.
	* sysdeps/unix/sysv/linux/i386/syscalls.list: Likewise.

2000-06-07  Greg McGary  <greg@mcgary.org>

	* Makeconfig (CPPFLAGS-.ob): Pass -fbounded-pointers
	for all files *.[cS].
	(CFLAGS-.ob): Don't optimize sibling calls.
	(bppfx): New variable.
	* Makerules (elide-bp-thunks): New variable.
	(elide-routines.*): Elide BP-* files for all but *.ob.
	(sources): Include bp-thunks.

2000-06-12  Ulrich Drepper  <drepper@redhat.com>

	* iconv/gconv_simple.c: Remove unnecessary prototype.

	* iconv/gconv_trans.c: Pretty print.

	* elf/elf.h (R_SH_NUM): Got accidently dropped.

	* sysdeps/unix/sysv/linux/configure.in: Improve handling of
	minimal kernel versions.  Add information about IA-64 kernel.

	* sysdeps/unix/sysv/linux/configure.in: Allow architecture
	specific minimal supported kernel versions to be specified.

	* libio/iofwide.c (_IO_fwide): Initialize transliteration part of
	step data structure.
	* wcsmbs/btowc.c: Likewise.
	* wcsmbs/mbrtowc.c: Likewise.
	* wcsmbs/mbsnrtowcs.c: Likewise.
	* wcsmbs/mbsrtowcs.c: Likewise.
	* wcsmbs/wcrtomb.c: Likewise.
	* wcsmbs/wcsnrtombs.c: Likewise.
	* wcsmbs/wcsrtombs.c: Likewise.
	* wcsmbs/wctob.c: Likewise.

	* sysdeps/unix/sysv/linux/sh/Dist: There is no ioperm file.
	* sysdeps/unix/sysv/linux/sh/oldgetrlimit64.c: Removed.

	* shlib-versions: Earliest backward compatible version for SH is 2.2.

	* misc/sys/cdefs.h: Remove one more __P.

	* sysvipc/sys/shm.h: Move __getpagesize declaration inside extern C.
	Reported by HJ Lu.

	* sysdeps/sh/sh3/bits/setjmp.h: Removed.
	* sysdeps/sh/sh4/bits/setjmp.h: Moved to...
	* sysdeps/sh/bits/setjmp.h: ...here.  New file.

2000-06-12  Kazumoto Kojima  <kkojima@rr.iij4u.or.jp>
	    Yutaka Niibe  <gniibe@chroot.org>

	* configure.in: Add machine sh3, sh4.
	* elf/elf.h: Add SH specific declarations of relocations.
	* shlib-versions: Add sh*-*-linux* cases.

2000-06-12  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/sh/sh3/bsd-_setjmp.S: Move to...
	* sysdeps/sh/bsd-_setjmp.S: ...here.  New file.
	* sysdeps/sh/sh4/bsd-_setjmp.S: Removed.
	* sysdeps/sh/sh3/bsd-setjmp.S: Move to...
	* sysdeps/sh/bsd-setjmp.S: ...here.  New file.
	* sysdeps/sh/sh4/bsd-setjmp.S: Removed.

	* sysdeps/sh/dl-machine.h (FGR_SAVE): Protect using HAVE_FPU macro
	instead of KERNEL_MATH_EMULATION.
	* sysdeps/sh/sh4/dl-machine.h: Define HAVE_FPU not
	KERNEL_MATH_EMULATION.

	* sysdeps/sh/Dist: Removed.  There is no ieee754.h file.
	* sysdeps/sh/sh3/dl-machine.h: Moved to...
	* sysdeps/sh/dl-machine.h: ...here.  New file.
	* sysdeps/sh/sh4/dl-machine.h: Simply define KERNEL_MATH_EMULATION
	and include generic SH version.
	* sysdeps/sh/sh3/bits/endian.h: Move to...
	* sysdeps/sh/bits/endian.h: ...here.  New file.
	* sysdeps/sh/sh4/bits/endian.h: Removed.
	* sysdeps/sh/sh3/bits/huge_val.h: Move to...
	* sysdeps/sh/bits/huge_val.h: ...here.  New file.
	* sysdeps/sh/sh4/bits/huge_val.h: Removed.

	* include/libc-symbols.h (link_warning): Work around a change in
	GAS which warns about changing section attributes.
	Proposed by Nick Clifton <nickc@redhat.com>.

2000-06-12  H.J. Lu  <hjl@gnu.org>

	* sysdeps/i386/fpu/bits/mathinline.h (__sgn1l): Add __extension__.

2000-06-11  H.J. Lu  <hjl@gnu.org>

	* sysdeps/i386/fpu/Versions: New file.

2000-06-12  Ulrich Drepper  <drepper@redhat.com>

	* iconv/gconv.h (__gconv_trans_context_fct): Remove two
	parameters.
	* iconv/skeleton.c (FUNCTION_NAME): Call __trans_context_fct if it
	exists.

2000-06-12  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/kernel_stat.h: New file.
	* sysdeps/unix/sysv/linux/ia64/xstatconv.c: New file.
	* sysdeps/unix/sysv/linux/ia64/bits/stat.h: New file.

	* sysdeps/unix/sysv/linux/ia64/fxstat64.c: New file.
	* sysdeps/unix/sysv/linux/ia64/lxstat64.c: New file.
	* sysdeps/unix/sysv/linux/ia64/xstat64.c: New file.

2000-06-12  Kazumoto Kojima  <kkojima@rr.iij4u.or.jp>
	    Yutaka Niibe  <gniibe@chroot.org>

	* sysdeps/sh/Dist: New file.
	* sysdeps/sh/Implies: New file.
	* sysdeps/sh/elf/initfini.c: New file.
	* sysdeps/sh/gmp-mparam.h: New file.
	* sysdeps/sh/init-first.c: New file.
	* sysdeps/sh/machine-gmon.h: New file.
	* sysdeps/sh/memcpy.S: New file.
	* sysdeps/sh/memprof.h: New file.
	* sysdeps/sh/memset.S: New file.
	* sysdeps/sh/sh3/__longjmp.S: New file.
	* sysdeps/sh/sh3/bits/endian.h: New file.
	* sysdeps/sh/sh3/bits/huge_val.h: New file.
	* sysdeps/sh/sh3/bits/setjmp.h: New file.
	* sysdeps/sh/sh3/bsd-_setjmp.S: New file.
	* sysdeps/sh/sh3/bsd-setjmp.S: New file.
	* sysdeps/sh/sh3/dl-machine.h: New file.
	* sysdeps/sh/sh3/setjmp.S: New file.
	* sysdeps/sh/sh4/__longjmp.S: New file.
	* sysdeps/sh/sh4/bits/endian.h: New file.
	* sysdeps/sh/sh4/bits/huge_val.h: New file.
	* sysdeps/sh/sh4/bits/setjmp.h: New file.
	* sysdeps/sh/sh4/bsd-_setjmp.S: New file.
	* sysdeps/sh/sh4/bsd-setjmp.S: New file.
	* sysdeps/sh/sh4/dl-machine.h: New file.
	* sysdeps/sh/sh4/fpu/bits/fenv.h: New file.
	* sysdeps/sh/sh4/fpu/bits/huge_val.h: New file.
	* sysdeps/sh/sh4/fpu/bits/mathdef.h: New file.
	* sysdeps/sh/sh4/fpu/fclrexcpt.c: New file.
	* sysdeps/sh/sh4/fpu/fegetenv.c: New file.
	* sysdeps/sh/sh4/fpu/fegetround.c: New file.
	* sysdeps/sh/sh4/fpu/feholdexcpt.c: New file.
	* sysdeps/sh/sh4/fpu/fesetenv.c: New file.
	* sysdeps/sh/sh4/fpu/fesetround.c: New file.
	* sysdeps/sh/sh4/fpu/fpu_control.h: New file.
	* sysdeps/sh/sh4/fpu/fraiseexcpt.c: New file.
	* sysdeps/sh/sh4/fpu/fsetexcptflg.c: New file.
	* sysdeps/sh/sh4/fpu/ftestexcept.c: New file.
	* sysdeps/sh/sh4/fpu/libm-test-ulps: New file.
	* sysdeps/sh/sh4/setjmp.S: New file.
	* sysdeps/sh/elf/start.S: New file.
	* sysdeps/sh/sys/ucontext.h: New file.
	* sysdeps/sh/strlen.S: New file.
	* sysdeps/sh/sysdep.h: New file.
	* sysdeps/unix/sh/sysdep.S: New file.
	* sysdeps/unix/sh/sysdep.h: New file.
	* sysdeps/unix/sysv/linux/sh/Dist: New file.
	* sysdeps/unix/sysv/linux/sh/Makefile: New file.
	* sysdeps/unix/sysv/linux/sh/Versions: New file.
	* sysdeps/unix/sysv/linux/sh/bits/mman.h: New file.
	* sysdeps/unix/sysv/linux/sh/bits/resource.h: New file.
	* sysdeps/unix/sysv/linux/sh/brk.c: New file.
	* sysdeps/unix/sysv/linux/sh/chown.c: New file.
	* sysdeps/unix/sysv/linux/sh/clone.S: New file.
	* sysdeps/unix/sysv/linux/sh/fchown.c: New file.
	* sysdeps/unix/sysv/linux/sh/fxstat.c: New file.
	* sysdeps/unix/sysv/linux/sh/getegid.c: New file.
	* sysdeps/unix/sysv/linux/sh/geteuid.c: New file.
	* sysdeps/unix/sysv/linux/sh/getgroups.c: New file.
	* sysdeps/unix/sysv/linux/sh/getresgid.c: New file.
	* sysdeps/unix/sysv/linux/sh/getresuid.c: New file.
	* sysdeps/unix/sysv/linux/sh/getrlimit.c: New file.
	* sysdeps/unix/sysv/linux/sh/getrlimit64.c: New file.
	* sysdeps/unix/sysv/linux/sh/getuid.c: New file.
	* sysdeps/unix/sysv/linux/sh/lchown.c: New file.
	* sysdeps/unix/sysv/linux/sh/lxstat.c: New file.
	* sysdeps/unix/sysv/linux/sh/msgctl.c: New file.
	* sysdeps/unix/sysv/linux/sh/oldgetrlimit64.c: New file.
	* sysdeps/unix/sysv/linux/sh/pipe.S: New file.
	* sysdeps/unix/sysv/linux/sh/profil-counter.h: New file.
	* sysdeps/unix/sysv/linux/sh/semctl.c: New file.
	* sysdeps/unix/sysv/linux/sh/setegid.c: New file.
	* sysdeps/unix/sysv/linux/sh/seteuid.c: New file.
	* sysdeps/unix/sysv/linux/sh/setfsgid.c: New file.
	* sysdeps/unix/sysv/linux/sh/setfsuid.c: New file.
	* sysdeps/unix/sysv/linux/sh/setgid.c: New file.
	* sysdeps/unix/sysv/linux/sh/setgroups.c: New file.
	* sysdeps/unix/sysv/linux/sh/setregid.c: New file.
	* sysdeps/unix/sysv/linux/sh/setresgid.c: New file.
	* sysdeps/unix/sysv/linux/sh/setresuid.c: New file.
	* sysdeps/unix/sysv/linux/sh/setreuid.c: New file.
	* sysdeps/unix/sysv/linux/sh/setrlimit.c: New file.
	* sysdeps/unix/sysv/linux/sh/setuid.c: New file.
	* sysdeps/unix/sysv/linux/sh/sh3/register-dump.h: New file.
	* sysdeps/unix/sysv/linux/sh/sh4/register-dump.h: New file.
	* sysdeps/unix/sysv/linux/sh/shmctl.c: New file.
	* sysdeps/unix/sysv/linux/sh/sigcontextinfo.h: New file.
	* sysdeps/unix/sysv/linux/sh/socket.S: New file.
	* sysdeps/unix/sysv/linux/sh/sys/io.h: New file.
	* sysdeps/unix/sysv/linux/sh/sys/ucontext.h: New file.
	* sysdeps/unix/sysv/linux/sh/sys/user.h: New file.
	* sysdeps/unix/sysv/linux/sh/syscalls.list: New file.
	* sysdeps/unix/sysv/linux/sh/sysdep.S: New file.
	* sysdeps/unix/sysv/linux/sh/sysdep.h: New file.
	* sysdeps/unix/sysv/linux/sh/vfork.S: New file.
	* sysdeps/unix/sysv/linux/sh/xstat.c: New file.

2000-06-12  Ulrich Drepper  <drepper@redhat.com>

	* Rules (%.out): Define GCONV_PATH in the environment.
	* assert/Depend: New file.
	* iconvdata/Depend: New file.
	* intl/Depend: New file.
	* timezone/Makefile (build-testdata): Add GCONV_PATH to environment.
	* intl/tst-gettext.sh: Likewise.
	* iconv/Makefile (routines): Add gconv_trans.
	* iconv/gconv_trans.c: New file.
	* iconv/gconv.h (struct __gconv_trans_data): New type.
	(__gconv_fct): New parameter with starting position in output buffer.
	(__gconv_trans_fct, __gconv_trans_context_fct, __gconv_trans_query_fct,
	__gconv_trans_init_fct, __gconv_trans_end_fct): New types.
	(struct __gconv_step): Add new member __trans.
	* iconv/gconv_int.h: Pretty print prototypes.
	(gconv_transliterate): New prototype.
	(__BUILTIN_TRANS): Update for new conversion function interface.
	* iconv/gconv.c (__gconv): Pass new parameter to conversion function.
	* iconv/gconv_open.c (__gconv_open): Recognize error handling suffix
	in names, find appropriate function, and install in the conversion
	steps it can be used.
	* iconv/skeleton.c: Add additional parameter for beginning of output
	buffer.  Change calls of downstream functions.
	* iconv/loop.c: Change loop function interface completely.  Pass in
	step and step_data structure.  Remove optimization for BODY with
	NEED_LENGTH_TEST == 0.
	* iconv/gconv_simple.c: Update interfaces of functions.  Insert
	appropriate error handling code to use transliteration steps.  Remove
	optimization for BODY with NEED_LENGTH_TEST == 0.
	* iconvdata/8bit-gap.c: Likewise.
	* iconvdata/8bit-generic.c: Likewise.
	* iconvdata/ansi_x3.110.c: Likewise.
	* iconvdata/big5.c: Likewise.
	* iconvdata/big5hkscs.c: Likewise.
	* iconvdata/euc-cn.c: Likewise.
	* iconvdata/euc-jp.c: Likewise.
	* iconvdata/euc-kr.c: Likewise.
	* iconvdata/euc-tw.c: Likewise.
	* iconvdata/gbgbk.c: Likewise.
	* iconvdata/gbk.c: Likewise.
	* iconvdata/iso-2022-cn.c: Likewise.
	* iconvdata/iso-2022-jp.c: Likewise.
	* iconvdata/iso-2022-kr.c: Likewise.
	* iconvdata/iso646.c: Likewise.
	* iconvdata/iso8859-1.c: Likewise.
	* iconvdata/iso_6937-2.c: Likewise.
	* iconvdata/iso_6937.c: Likewise.
	* iconvdata/johab.c: Likewise.
	* iconvdata/sjis.c: Likewise.
	* iconvdata/t.61.c: Likewise.
	* iconvdata/uhc.c: Likewise.
	* iconvdata/unicode.c: Likewise.
	* iconvdata/utf-16.c: Likewise.
	* libio/iofwide.c: Adjust to new interface of gconv functions.  Use
	DL_CALL_FCT.
	* wcsmbs/btowc.c: Likewise.
	* wcsmbs/mbrtowc.c: Likewise.
	* wcsmbs/mbsnrtowcs.c: Likewise.
	* wcsmbs/mbsrtowcs.c: Likewise.
	* wcsmbs/wcrtomb.c: Likewise.
	* wcsmbs/wcsnrtombs.c: Likewise.
	* wcsmbs/wcsrtombs.c: Likewise.
	* wcsmbs/wctob.c: Likewise.

2000-04-11  Geoff Keating  <geoffk@cygnus.com>

	* sysdeps/powerpc/dl-machine.c: Include dl-machine.h after the
	other header files.  Mention about 128-byte cache line sizes.
	(__elf_machine_fixup_plt): Make types match elf_machine_fixup_plt.
	* sysdeps/powerpc/dl-machine.h (elf_machine_fixup_plt): Update
	for current calling sequence.
	* sysdeps/powerpc/dl-start.S (_dl_start_user): Close comment.

	* sysdeps/powerpc/fpu/s_rint.c: Handle rounding to -0 correctly.
	* sysdeps/powerpc/fpu/s_rintf.c: Likewise.

	* sysdeps/unix/sysv/linux/powerpc/syscalls.list: Add getrlimit
	and setrlimit syscalls for backwards compatibility.

2000-06-10  Ulrich Drepper  <drepper@redhat.com>

	* iconv/skeleton.c:  Rename converted written to correcter name
	irreversible.
	* iconv/gconv.c: Rename converted variable to correcter name
	irreversible.
	* iconv/gconv_int.h: Likewise.
	* iconv/gconv_simple.c: Likewise.
	* iconv/iconv.c: Likewise.
	* iconv/loop.c: Likewise.
	* iconvdata/8bit-gap.c: Likewise.
	* iconvdata/8bit-generic.c: Likewise.
	* iconvdata/ansi_x3.110.c: Likewise.
	* iconvdata/big5.c: Likewise.
	* iconvdata/big5hkscs.c: Likewise.
	* iconvdata/euc-cn.c: Likewise.
	* iconvdata/euc-jp.c: Likewise.
	* iconvdata/euc-kr.c: Likewise.
	* iconvdata/gbgbk.c: Likewise.
	* iconvdata/gbk.c: Likewise.
	* iconvdata/iso-2022-cn.c: Likewise.
	* iconvdata/iso-2022-jp.c: Likewise.
	* iconvdata/iso-2022-kr.c: Likewise.
	* iconvdata/iso646.c: Likewise.
	* iconvdata/iso8859-1.c: Likewise.
	* iconvdata/iso_6937-2.c: Likewise.
	* iconvdata/iso_6937.c: Likewise.
	* iconvdata/johab.c: Likewise.
	* iconvdata/sjis.c: Likewise.
	* iconvdata/t.61.c: Likewise.
	* iconvdata/uhc.c: Likewise.
	* iconvdata/unicode.c: Likewise.
	* iconvdata/utf-16.c: Likewise.

	* sysdeps/unix/sysv/linux/bits/socket.h (struct cmsghdr): Mark
	__cmsg_data field with __extension__.

2000-06-10  David Mosberger  <davidm@hpl.hp.com>

	* sysdeps/unix/sysv/linux/ia64/syscall.S: Fix it so it actually works.

2000-06-10  Ulrich Drepper  <drepper@redhat.com>

	* iconv/gconv_simple.c: Fix various small bugs in several
	functions.

	* iconv/loop.c: Fix comment.

2000-06-10  Jakub Jelinek  <jakub@redhat.com>

	* elf/link.h: Remove libc internal declarations.
	* include/link.h: Move them here.

2000-06-09  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/ia64/getsysstats.c: New file.
	Patch by Dan Pop <Dan.Pop@cern.ch>.

	Rewrite error message handling.
	* elf/dl-deps.c (_dl_map_object_deps): Pass new parameter to
	_dl_catch_error.
	* elf/dl-error (struct catch): Add objname member.
	(_dl_signal_error): Take new parameter with object name.  When
	passing message on simply store object name and duplicate error
	message.
	(_dl_catch_error): Take new parameter.  Store object name in the
	place pointed to.
	* include/dlfcn.h: Adjust _dl_catch_error prototype.
	* sysdeps/generic/ldsodefs.h: Adjust _dl_signal_error prototype.
	* dlfcn/dlerror.c (struct dl_action_result): Add objname member.
	(dlerror): Add objname to asprintf() parameters.
	(_dl_error_run): Pass new parameter to _dl_catch_error.
	* elf/dl-libc.c (dlerror_run): Pass new parameter to _dl_catch_error.
	* elf/dl-open.c (_dl_open): Likewise.
	* elf/rtld.c (dl_main): Likewise.
	* elf/dl-close.c: Mark error messages with N_().
	* elf/dl-deps.c: Likewise.
	* elf/dl-error.c: Likewise.
	* elf/dl-load.c: Likewise.
	* elf/dl-open.c: Likewise.
	* elf/dl-reloc.c: Likewise.
	* elf/dl-support.c: Likewise.
	* elf/dl-sym.c: Likewise.
	* elf/dl-version.c: Likewise.
	* elf/dl-lookup.c: Add comments about problems with error message
	translations.
	* elf/dl-reloc.c: Likewise.
	* elf/dl-version.c: Likewise.

2000-06-09  H.J. Lu  <hjl@gnu.org>

	* dlfcn/dlerror.c (_dlerror_run): Set result->errstring to NULL
	after freeing it.

	* dlfcn/Makefile (distribute): Add failtestmod.c.
	(tests): Add failtest.
	Add rules to build and run failtest.
	* dlfcn/failtest.c: New file.
	* dlfcn/failtestmod.c: New file.

2000-06-09  David Mosberger-Tang  <davidm@hpl.hp.com>

	* sysdeps/unix/sysv/linux/ia64/__longjmp.S: new file
	* sysdeps/unix/sysv/linux/ia64/bsd-_setjmp.S: new file
	* sysdeps/unix/sysv/linux/ia64/bsd-setjmp.S: new file
	* sysdeps/unix/sysv/linux/ia64/setjmp.S: new file
	* sysdeps/unix/sysv/linux/ia64/bits/setjmp.h: new file

2000-06-09  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/brk.S: New file.
	* sysdeps/unix/sysv/linux/ia64/pipe.S: New file.

2000-06-09  Jes Sorensen  <jes@linuxcare.com>
	    Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/ia64/sigaction.c: New file.
	* sysdeps/unix/sysv/linux/ia64/sigpending.c: New file.
	* sysdeps/unix/sysv/linux/ia64/sigprocmask.c: New file.
	* sysdeps/unix/sysv/linux/ia64/sigsuspend.c: New file.
	* sysdeps/unix/sysv/linux/ia64/bits/sigaction.h: New file.
	* sysdeps/unix/sysv/linux/ia64/bits/sigstack.h: New file.

2000-06-09  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/shm_open.c (where_is_shmfs): Try harder
	to find correct mount point despite wrong information from the
	kernel.

2000-06-09  Jes Sorensen  <jes@linuxcare.com>

	* elf/dl-libc.c (__libc_dlsym): Use DL_SYMBOL_ADDRESS() to obtain
	the address of a symbol so function pointers are handled properly.

2000-06-08  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/i386/Dist: Add bp-asm.h.

	* sysdeps/unix/sysv/linux/shm_open.c (where_is_shmfs): Use
	defaultdir variable instead of "/var/shm" everywhere.
	(defaultdir): Change to /dev/shm/.

2000-06-08  Greg McGary  <greg@mcgary.org>

	* sysdeps/i386/bp-asm.h: New file.
	* sysdeps/i386/__longjmp.S: Define & use symbolic argument stack
	offsets.  Add ENTER/LEAVE macros for optionally maintaining
	frame-pointer chain when debugging.
	* sysdeps/i386/add_n.S: Likewise.
	* sysdeps/i386/addmul_1.S: Likewise.
	* sysdeps/i386/lshift.S: Likewise.
	* sysdeps/i386/memchr.S: Likewise.
	* sysdeps/i386/memcmp.S: Likewise.
	* sysdeps/i386/mul_1.S: Likewise.
	* sysdeps/i386/rawmemchr.S: Likewise.
	* sysdeps/i386/rshift.S: Likewise.
	* sysdeps/i386/stpcpy.S: Likewise.
	* sysdeps/i386/stpncpy.S: Likewise.
	* sysdeps/i386/strchr.S: Likewise.
	* sysdeps/i386/strchrnul.S: Likewise.
	* sysdeps/i386/strcspn.S: Likewise.
	* sysdeps/i386/strpbrk.S: Likewise.
	* sysdeps/i386/strrchr.S: Likewise.
	* sysdeps/i386/strspn.S: Likewise.
	* sysdeps/i386/strtok.S: Likewise.
	* sysdeps/i386/sub_n.S: Likewise.
	* sysdeps/i386/submul_1.S: Likewise.
	* sysdeps/i386/elf/setjmp.S: Likewise.
	* sysdeps/i386/i486/strcat.S: Likewise.
	* sysdeps/i386/i486/strlen.S: Likewise.
	* sysdeps/i386/i586/add_n.S: Likewise.
	* sysdeps/i386/i586/lshift.S: Likewise.
	* sysdeps/i386/i586/memcpy.S: Likewise.
	* sysdeps/i386/i586/memset.S: Likewise.
	* sysdeps/i386/i586/rshift.S: Likewise.
	* sysdeps/i386/i586/strchr.S: Likewise.
	* sysdeps/i386/i586/strcpy.S: Likewise.
	* sysdeps/i386/i586/strlen.S: Likewise.
	* sysdeps/i386/i586/sub_n.S: Likewise.
	* sysdeps/i386/i686/add_n.S: Likewise.
	* sysdeps/i386/i686/memcpy.S: Likewise.
	* sysdeps/i386/i686/mempcpy.S: Likewise.
	* sysdeps/i386/i686/memset.S: Likewise.
	* sysdeps/i386/i686/strcmp.S: Likewise.

2000-06-08  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/getdtsz.c: New file.

	* sysdeps/unix/sysv/linux/sys/param.h: Define NOFILE directly as
	256 and don't use OPEN_MAX.

	* sysdeps/unix/sysv/linux/pathconf.c: Define LINUX_LINK_MAX and
	use it instead of LINK_MAX.
	* sysdeps/unix/sysv/linux/fpathconf.c: Likewise.

2000-06-08  Andreas Jaeger  <aj@suse.de>

	* libio/genops.c (_IO_list_lock): Only compile body if we're
	thread safe.
	(_IO_list_unlock): Likewise.
	(_IO_list_resetlock): Likewise.

2000-06-07  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/bits/local_lim.h: Undefine OPEN_MAX
	unless user defined it.

	* sysdeps/unix/sysv/linux/bits/local_lim.h: Also undefine LINK_MAX
	if not defined by the user.

	* libio/iofwrite_u.c (fwrite_unlocked): Remove obsolete comment.
	* libio/iofwrite.c (_IO_fwrite): Likewise.

	* time/time.h: Add missing __THROW for clock_getcpuclockid
	prototype.

	* elf/Makefile (distribute): Add dl-dtprocnum.h.
	* include/elf.h: Include also <dl-dtprocnum.h>.
	* elf/dl-deps.c: Likewise.
	* elf/dl-lookup.c: Likewise.
	* elf/dl-runtime.c: Likewise.
	* elf/dl-version.c: Likewise.
	* elf/do-rel.h: Likewise.
	* elf/dynamic-link.h: Likewise.
	* elf/link.h: Likewise.
	* elf/rtld.c: Likewise.
	* sysdeps/generic/dl-dtprocnum.h: New file.
	* sysdeps/ia64/dl-dtprocnum.h: New file.
	* sysdeps/mips/dl-dtprocnum.h: New file.
	* sysdeps/sparc/dl-dtprocnum.h: New file.

	* sysdeps/i386/dl-machine.h: Add more __builtin_expect.

	* elf/do-lookup.h: Add some __builtin_expect.

	* dlfcn/dlfcn.h: Pretty print dladdr declaraction.

	* elf/rtld.c (process_envvars): Recognize LD_DYNAMIC_WEAK.
	(_dl_dynamic_weak): New variable.
	* elf/dl-support.c: Likewise.
	* sysdeps/generic/ldsodefs.h: Declare _dl_dynamic_weak.
	* elf/do-lookup.h: If we find a weak definition treat it like a
	normal symbol unless _dl_dynamic_weak is nonzero.  In the latter
	case treat it like before.

	* elf/dl-addr.c (_dl_addr): Fill in correct information if symbol
	is in main program.
	* elf/Versions [ld] (GLIBC_2.2): Export _dl_argv.

	* elf/dl-addr.c (_dl_addr): Do exact testing of address range
	using l_map_start and l_map_end.

	* elf/dl-version.c: Add __builtin_expect in many places.

	* sysdeps/unix/sysv/linux/i386/dl-procinfo.h (x86_cap_flags):
	Update.

2000-06-04  Kaz Kylheku  <kaz@ashi.footprints.net>

	Lock for stdio stream list becomes global, for use in LinuxThreads.

	* libio/genops.c (_IO_iter_begin, _IO_iter_end,
	_IO_iter_next, _IO_iter_file, _IO_list_lock, _IO_list_unlock,
	_IO_list_resetlock): New interface for iterating global list of
	streams without accessing the _IO_list_all global variable,
	and for manipulating the lock which protects this list.
	* libio/libioP.h: Likewise.
	* libio/Version: Add entries for the new functions.

	* libio/libioP.h (_IO_ITER): New typedef, just an alias for
	pointer to _IO_FILE.

2000-06-07  Ulrich Drepper  <drepper@redhat.com>

	* locale/programs/ld-ctype.c (set_class_defaults): Several uses of
	BIT() must actually be BITw().

	* locale/programs/ld-ctype.c: Handle SP and space consistently.

	* locale/programs/charmap.c: Allow string arguments for
	code_set_name and repertoiremap.

2000-06-07  Andreas Jaeger  <aj@suse.de>

	* elf/Makefile: Build ldconfig only when building shared libraries.

2000-06-07  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/alpha/fpu/bits/mathinline.h (__fdimf): Only declare if
	__USE_ISOC99.
	(fdimf, __fdim, fdim): Likewise.

2000-06-07  Ulrich Drepper  <drepper@redhat.com>

	* locale/findlocale.c: Add __builtin_expect in many places.
	* locale/loadlocale.c: Likewise.

2000-06-06  Greg McGary  <greg@mcgary.org>

	* sysdeps/mips/elf/start.S: Trim redundant code.

	* sysdeps/powerpc/memset.S: Define & use symbolic register names.
	Use C comments throughout.  Line up operands column with tabs.
	* sysdeps/powerpc/strchr.S: Likewise.
	* sysdeps/powerpc/strcmp.S: Likewise.
	* sysdeps/powerpc/strcpy.S: Likewise.
	* sysdeps/powerpc/strlen.S: Likewise.

	* sysdeps/unix/sysv/linux/powerpc/brk.S [!PIC]:
	Get low part of &__curbrk with @l.

2000-06-06  Ulrich Drepper  <drepper@redhat.com>

	* iconvdata/utf-16.c: Add __builtin_expect in many places.
	* iconvdata/unicode.c: Likewise.
	* iconvdata/uhc.c: Likewise.
	* iconvdata/t.61.c: Likewise.
	* iconvdata/sjis.c: Likewise.
	* iconvdata/johab.c: Likewise.
	* iconvdata/iso_6937.c: Likewise.
	* iconvdata/iso_6937-2.c: Likewise.
	* iconvdata/iso8859-1.c: Likewise.
	* iconvdata/iso646.c: Likewise.
	* iconvdata/iso-2022-kr.c: Likewise.
	* iconvdata/iso-2022-jp.c: Likewise.
	* iconvdata/iso-2022-cn.c: Likewise.
	* iconvdata/gbgbk.c: Likewise.
	* iconvdata/gbk.c: Likewise.
	* iconvdata/euc-kr.c: Likewise.
	* iconvdata/euc-jp.c: Likewise.
	* iconvdata/euc-cn.c: Likewise.

2000-06-05  Ulrich Drepper  <drepper@redhat.com>

	* iconvdata/big5hkscs.c: Add __builtin_expect in many places.
	* iconvdata/big5.c: Likewise.
	* iconvdata/ansi_x3.110.c: Likewise.
	* iconvdata/8bit-generic.c: Likewise.
	* iconvdata/8bit-gap.c: Likewise.
	* iconv/loop.c: Likewise.
	* iconv/gconv_db.c: Likewise.
	* iconv/gconv_dl.c: Likewise.
	* iconv/gconv_simple.c: Likewise.
	* iconv/skeleton.c: Likewise.

	* iconv/gconv.h (__GCONV_IS_LAST, __GCONV_IGNORE_ERRORS): Define.
	(struct __gconv_step_data): Rename __is_last to __flags.
	* iconv/gconv_close.c: Change all uses of __is_last.
	* iconv/skeleton.c: Likewise.
	* iconvdata/iso-2022-cn.c: Likewise.
	* iconvdata/iso-2022-jp.c: Likewise.
	* iconvdata/iso-2022-kr.c: Likewise.
	* iconv/gconv_open.c: Likewise.  Avoid unneeded initializations.
	Recognize IGNORE error handling, set flag, and remove from name.
	* iconv/loop.c (ignore_errors_p): Define.
	Add flags parameter to both functions.
	* iconv/skeleton.c: Pass flags to all conversion functions.
	* iconv/gconv_simple.c: Add flags parameter to all functions.
	Don't return error for invald error if ignore flag is set.
	(ucs4_internal_loop_single): Add missing pointer increment.
	(internal_ucs4le_loop_single): Likewise.
	* iconv/iconv_prog.c: Implement handling of -c parameter.
	* iconvdata/8bit-gap.c: Don't return error for invald error if
	ignore flag is set.
	* iconvdata/8bit-generic.c: Likewise.
	* iconvdata/ansi_x3.110.c: Likewise.
	* iconvdata/big5.c: Likewise.
	* iconvdata/big5hkscs.c: Likewise.
	* iconvdata/euc-cn.c: Likewise.
	* iconvdata/euc-jp.c: Likewise.
	* iconvdata/euc-kr.c: Likewise.
	* iconvdata/gbgbk.c: Likewise.
	* iconvdata/gbk.c: Likewise.
	* iconvdata/iso-2022-cn.c: Likewise.
	* iconvdata/iso-2022-jp.c: Likewise.
	* iconvdata/iso-2022-kr.c: Likewise.
	* iconvdata/iso646.c: Likewise.
	* iconvdata/iso8859-1.c: Likewise.
	* iconvdata/iso_6937-2.c: Likewise.
	* iconvdata/iso_6937.c: Likewise.
	* iconvdata/johab.c: Likewise.
	* iconvdata/sjis.c: Likewise.
	* iconvdata/t.61.c: Likewise.
	* iconvdata/uhc.c: Likewise.
	* iconvdata/unicode.c: Likewise.
	* iconvdata/utf-16.c: Likewise.
	* libio/fileops.c: Likewise.
	* libio/iofwide.c: Likewise.
	* wcsmbs/btowc.c: Likewise.
	* wcsmbs/mbrtowc.c: Likewise.
	* wcsmbs/mbsnrtowcs.c: Likewise.
	* wcsmbs/mbsrtowcs.c: Likewise.
	* wcsmbs/wcrtomb.c: Likewise.
	* wcsmbs/wcsnrtombs.c: Likewise.
	* wcsmbs/wcsrtombs.c: Likewise.
	* wcsmbs/wctob.c: Likewise.

	* iconvdata/ksc5601.h (ksc5601_to_ucs4): Undo *s change in all cases of
	an error.

2000-06-04  Ulrich Drepper  <drepper@redhat.com>

	* iconv/gconv_dl.c (do_release_shlib): Don't reset reference
	counter for the object we are releasing, just decrement it.
	Patch by Akira Higuchi <a-higuti@math.sci.hokudai.ac.jp>.

2000-06-04  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/i386/fpu/bits/mathinline.h: Only inline sinh, cosh and tanh
	if -ffast-math.

2000-06-04  Ulrich Drepper  <drepper@redhat.com>

	* iconvdata/big5hkscs.c: New file.
	Modified from big5.c by Roger So <rogerso@sis.dhs.org>.

	* iconvdata/gconv-modules: Add entry for new module.
	* iconvdata/Makefile (modules): Add BIG5HKSCS.
	(distribute): Add big5hkscs.c.

2000-06-01  Jakub Jelinek  <jakub@redhat.com>

	* libc/sysdeps/alpha/fpu/bits/mathinline.h: Add __THROW to all
	inlines to match prototypes in mathcalls.h.
	* libc/sysdeps/i386/fpu/bits/mathinline.h: Likewise.
	* libc/sysdeps/m68k/fpu/bits/mathinline.h: Likewise.
	* libc/sysdeps/powerpc/fpu/bits/mathinline.h: Likewise.
	* libc/sysdeps/sparc/fpu/bits/mathinline.h: Likewise.

2000-06-03  Ulrich Drepper  <drepper@redhat.com>

	* elf/elf.h (SHT_SUNW_move): Define.

	* elf/elf.h: Add more Solaris compatiblity definitions.

2000-06-03  Andreas Jaeger  <aj@suse.de>

	* sysdeps/powerpc/dl-start.S: Close open comment.

2000-06-03  Jakub Jelinek  <jakub@redhat.com>

	* inet/Versions: Fix typo in rresvport_af export.

2000-06-02  Ulrich Drepper  <drepper@redhat.com>

	* math/tgmath.h: Pretty print.

2000-06-02  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/mips/sys/ucontext.h: Fix typo.
	Reported by Maciej W. Rozycki <macro@ds2.pg.gda.pl>.

2000-06-02  Ulrich Drepper  <drepper@redhat.com>

	* elf/rtld.c (process_envvars): Test for = after variable name.

2000-06-01  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/generic/initfini.c (_init): One less relocation.  Don't
	have extra call to __gmon_start__, use the pointer we already have.

	* elf/elf.h (ELF64_R_INFO): Cast sym value to Elf64_Xword before
	shifting.

	* sysdeps/i386/elf/setjmp.S: Work around change is recent
	binutils.  gas now emits a jump through the PLT instead of a
	relative jump if the jump target is an exported symbol.

2000-05-31  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/powerpc/aix/aix-termios.h: Define AIX_CBAUD.

2000-05-31  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/mips/sys/ucontext.h: Use array for
	gregset_t.

	* sysdeps/unix/sysv/linux/mips/Versions: Export _flush_cache.
	Patches by Maciej W. Rozycki <macro@ds2.pg.gda.pl>.

	* sysdeps/unix/sysv/linux/mips/ftruncate64.c: Fix prototype of
	syscall.
	* sysdeps/unix/sysv/linux/mips/truncate64.c: Likewise.

2000-05-30  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/alpha/oldglob.c (__old_glob): Loose __P.

	* locale/Versions [libc] (GLIBC_2.2): Add localeconv.
	* locale/localeconv.c: Make function versioned (with same definition).

	* elf/Makefile (modules-names): Strip before using it.

2000-05-30  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/mips/truncate64.c: New file.
	* sysdeps/unix/sysv/linux/mips/ftruncate64.c: New file.
	* sysdeps/unix/sysv/linux/mips/pread64.c: Readded file.
	* sysdeps/unix/sysv/linux/mips/pwrite64.c: Readded file.
	* sysdeps/unix/sysv/linux/mips/pread.c: Readded file.
	* sysdeps/unix/sysv/linux/mips/pwrite.c: Readded file.

2000-05-29  Ulrich Drepper  <drepper@redhat.com>

	* Makefile: Add GNU make magic.

	* inet/Makefile (CFLAGS-rcmd.c, CFLAGS-rexec.c, CFLAGS-ruserpass.c):
	Removed.
	* inet/rcmd.c: Remove __P.  Remove unused variables.
	(iruserfopen): Make first parameter const.
	(ruserok_sa): Return result of ruserok2_sa.
	(__checkhost_sa): Correctly iterate through results of getaddrinfo.
	* inet/rexec.c: Remove unused variables.  Other small cleanups.
	* inet/ruserpass.c: Remove __P.  Remove unused variables.
	(ruserpass): Check results of memory allocation.
	* include/netdb.h: Add prototype for ruserpass.

2000-05-29  Andreas Jaeger  <aj@suse.de>

	* elf/readlib.c (interpreters): Use LD_SO since this is supported
	for all platforms.

2000-05-29  Jakub Jelinek  <jakub@redhat.com>

	* inet/rcmd.c (rresvport_af): Use correct port number.

2000-05-26  Andreas Schwab  <schwab@suse.de>

	* Makeconfig ($(common-objpfx)soversions.mk): Prepend `$lib=' to
	entries in all-sonames.
	($(common-objpfx)gnu/lib-names.h): Use it for the CPP symbol,
	preserving the old name if different for compatibility.

2000-05-29  Ulrich Drepper  <drepper@redhat.com>

	* posix/Makefile (tests): Add tst-spawn.
	(tst-spawn-ARGS): New variable.
	* posix/tst-spawn.c: New file.

	* posix/spawn_faction_addclose.c: Correctly account for new entry.
	* posix/spawn_faction_adddup2.c: Likewise.
	* posix/spawn_faction_addopen.c: Likewise.
	* posix/spawni.c: Correctly test for success of dup2 calls.

	* posix/tst-preadwrite.c: Check success of malloc call.

2000-05-28  Ulrich Drepper  <drepper@redhat.com>

	* posix/Makefile (tests): Add tst-exec.
	(tst-exec-ARGS): New variable.
	* posix/tst-exec.c: New file.

	* sysdeps/arm/atomicity.h (compare_and_swap): Return result.

2000-05-04  Andreas Jaeger  <aj@suse.de>

	* string/string.h: Remove __strdup prototype, it's not needed in
	this file anymore.

2000-05-28  Ulrich Drepper  <drepper@redhat.com>

	* posix/Makefile (tests): Add tst-fork.
	* posix/tst-fork.c: New file.

	* resolv/inet_pton.c: Loose __P.

2000-05-21  Jakub Jelinek  <jakub@redhat.com>

	* libio/libioP.h (_IO_CHECK_WIDE): Define.
	* libio/iosetbuffer.c (_IO_setbuffer): Use it.
	* libio/iosetvbuf.c (_IO_setvbuf): Likewise.
	* libio/fileops.c (_IO_new_file_fopen): Return NULL if
	_IO_CHECK_WIDE fails.

2000-05-28  Ulrich Drepper  <drepper@redhat.com>

	* po/da.po: New file.

	* manual/arith.texi (Rounding Functions): Fix documentation of trunc.
	Patch by Steven G. Johnson <stevenj@gil-galad.mit.edu>.

	* manual/charset.texi (Extended Char Intro): Fix typo (and -> as).
	(Other iconv Implementations): Fix typo.
	Patch by Martin Pool <mbp@wistful.humbug.org.au>.

2000-05-27  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/i386/pread.c: Removed, we can use the
	normal version now.
	* sysdeps/unix/sysv/linux/i386/pwrite.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/pwrite64.c: Likewise.
	* sysdeps/unix/sysv/linux/mips/pread.c: Likewise.
	* sysdeps/unix/sysv/linux/mips/pwrite.c: Likewise.
	* sysdeps/unix/sysv/linux/arm/pread.c: Likewise.
	* sysdeps/unix/sysv/linux/arm/pwrite.c: Likewise.

	* sysdeps/unix/sysv/linux/pread.c (__libc_pread): Check
	endianness to decide how to pass arguments.
	* sysdeps/unix/sysv/linux/pwrite.c (__libc_pwrite): Likewise.

	* elf/vismain.c: Use test-skeleton interface.
	(TEST_FUNCTION): New macro.
	(do_test): Renamed from main.

2000-05-27  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/posix/getaddrinfo.c (gaih_inet): If req->ai_family ==
	AF_UNSPEC don't allow the IPv6 lookup to return mapped IPv4 addresses.

	* nss/nss_files/files-hosts.c (LINE_PARSER): Simplify.  Correct
	handling of AI_V4MAPPED flag.

	* resolv/nss_dns/dns-host.c (_nss_dns_gethostbyname2_r): If lookup
	of IPv6 address failed and RES_USE_INET6 bit in _res.options is set,
	perform lookup for T_A type and tell getanswer_r to convert the
	result with new argument.
	(_nss_dns_gethostbyaddr_r): Pass zero as new argument to getanswer_r.
	Don't convert addresses from IPv4 to IPv6 here.
	(getanswer_r): Take new parameter indicating if mapping from IPv4 to
	IPv6 is wanted.  Allow qtype and type from reply to disagree if
	IPv4 mapping has to be done.  Perform mappings if required by the
	caller and not if RES_USE_INET6 bit in _res.options is set.
	Add several __builtin_expect.

2000-05-26  Ulrich Drepper  <drepper@redhat.com>

	* catgets/open_catalog.c (__open_catalog): Add a few __builtin_expect.

	* elf/dl-load.c (_dl_map_object): Don't ignore RPATHs if loader ==
	NULL.

	* posix/tst-preadwrite.c: Allow parallel execution of
	tst-preadwrite and tst-preadwrite64.

	* posix/Makefile (tests): Add tst-truncate and tst-truncate64.
	* posix/tst-truncate.c: New file.
	* posix/tst-truncate64.c: New file.

	* sysdeps/unix/sysv/linux/pread64.c: The little/big endian code
	was switched.

	* posix/Makefile (tests): Add tst-preadwrite64.
	* posix/tst-preadwrite.c: Alloc file being used also for testing
	pread64 and pwrite64.
	* posix/tst-preadwrite64.c: New file.

2000-05-26  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/ftruncate64.c (ftruncate64): Make order
	of arguments dependend on endianness.
	* sysdeps/unix/sysv/linux/truncate64.c: Likewise.

	* sysdeps/unix/sysv/linux/i386/pread64.c: Removed, we can use the
	normal version now.
	* sysdeps/unix/sysv/linux/arm/pread64.c: Likewise.
	* sysdeps/unix/sysv/linux/arm/pwrite64.c: Likewise.
	* sysdeps/unix/sysv/linux/mips/pread64.c: Likewise.
	* sysdeps/unix/sysv/linux/mips/pwrite64.c: Likewise.

	* sysdeps/unix/sysv/linux/pwrite64.c (__libc_pwrite64): Check
	endianness to check how to pass argument.
	* sysdeps/unix/sysv/linux/pread64.c (__libc_pread64): Likewise.

	* elf/ldconfig.h: Update parameter list for process_elf_file.

	* sysdeps/unix/sysv/linux/sparc/readelflib.c (process_elf_file):
	Add parameter file_length and pass it ot process_elf*file.

	* sysdeps/generic/readelflib.c (check_ptr): New.
	(process_elf_file): Use check_ptr to check all accesses to the
	mmapped file. Add parameter file_length.

	* elf/readlib.c (known_libs): Use <gnu/lib-names.h> to specify
	library names.

	* sunrpc/xdr_intXX_t.c (xdr_uint8_t): Fix conversion.
	Closes PR libc/1573, reported by Bradley White
	<bww@laurelnetworks.com>.

2000-05-25  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/i386/fpu/bits/mathinline.h: Define expm1 inline only if
	__FAST_MATH__ is defined.

2000-05-22  Andreas Jaeger  <aj@suse.de>

	* math/Makefile: Add -D__FAST_MATH__ to CFLAGS-test-ifloat.c,
	CFLAGS-test-idouble.c, CFLAGS-test-ildoubl.c.

	* manual/math.texi (FP Function Optimizations): Document gcc
	-ffast-math behaviour with mathinlines.

	* sysdeps/i386/fpu/bits/mathinline.h: Only use save inline
	functions unless -ffast-math is given to gcc.

2000-05-23  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/i386/fpu/bits/mathinline.h (__sincos, __sincosf,
	__sincosl): Guard with __USE_GNU.

2000-05-24  Ulrich Drepper  <drepper@redhat.com>

	* csu/Makefile (routines): Add check_fds.
	* elf/rtld.c (dl_main): Call __libc_check_standard_fds for SUID
	binaries.  Add various __builtin_expect.
	* sysdeps/generic/libc-start.c: Move check_fds and helper functions...
	* sysdeps/generic/check_fds.c: ...here.  New file.

	* malloc/malloc.c (ptmalloc_init): Only enable debugging for SUID
	binaries if file /etc/suid-debug is available.

	* locale/programs/ld-collate.c (struct element_t): Add mbseqorder
	and wcseqorder members.
	(struct locale_collate_t): Likewise.
	(collate_finish): Assign collation sequence value to each character.
	Create tables for output.
	(collate_output): Write out tables with collation sequence information.
	* locale/C-collate.c: Provide C locale data for collation sequence
	table.
	* locale/langinfo.h: Add _NL_COLLATE_COLLSEQMB and
	_NL_COLLATE_COLLSEQWC.
	* locale/categories.def: Add entries for _NL_COLLATE_COLLSEQMB and
	_NL_COLLATE_COLLSEQWC.
	* posix/fnmatch.c: Define SUFFIX and WIDE_CHAR_VERSION before
	include fnmatch_loop.c.
	* posix/fnmatch_loop.c: Don't use strcoll while determining whether
	character is matched by range expression.  Use collation sequence
	table.  Outside glibc fall back on simple character value comparison.

2000-05-24  Andreas Jaeger  <aj@suse.de>

	* sysdeps/mips/elf/start.S (ENTRY_POINT): Align stack for double
	words.

	* intl/Makefile: Run gettext-test only if msgfmt is available.

	* sysdeps/unix/sysv/linux/kernel-features.h (__ASSUME_LDT_WORKS):
	Define it for newer kernels.

2000-05-23  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-sym.c: Minor cleanups.

	* configure.in: Add test for .protected.
	* config.make.in: Add have-protected variable.
	* elf/Makefile (tests): Add $(tests-vis-$(have-protected)).
	(tests-vis-yes): Add vismain.
	(modules-names): Add $(modules-vis-$(have-protected)).
	(modules-vis-yes): Add vismod1, vismod2, and vismod3.
	Add rules to generate and run vismain.
	* elf/vismain.c: New file.
	* elf/vismod1.c: New file.
	* elf/vismod2.c: New file.
	* elf/vismod3.c: New file.

2000-05-23  Andreas Jaeger  <aj@suse.de>

	* stdio-common/tfformat.c (sprint_doubles): Add testcase for %a.

	* manual/search.texi (Array Sort Function): Document that qsort is
	not necessarily in-place.

	* sunrpc/rpc_main.c (parseargs): Don't accept -M and -N.
	Closes PR libc/1731.

	* csu/munch-tmpl.c (__libc_init): Remove K&R support.
	* dirent/scandir64.c: Likewise.
	* pwd/getpw.c: Likewise.
	* stdlib/bsearch.c (bsearch): Likewise.
	* stdlib/tst-strtoll.c: Likewise.
	* localedata/collate-test.c: Likewise.
	* localedata/xfrm-test.c: Likewise.
	* posix/bsd-getpgrp.c: Likewise.
	* sysdeps/alpha/fpu/bits/fenv.h: Likewise.
	* sysdeps/generic/bits/siginfo.h: Likewise.
	* sysdeps/generic/bits/sockaddr.h: Likewise.
	* sysdeps/generic/sys/swap.h: Likewise.
	* sysdeps/generic/sys/sysinfo.h: Likewise.
	* sysdeps/generic/vfork.c: Likewise.
	* sysdeps/m68k/fpu/switch/68881-sw.h: Likewise.
	* sysdeps/mach/hurd/fdopen.c: Likewise.
	* sysdeps/unix/sysv/linux/alpha/sys/acct.h: Likewise.
	* sysdeps/unix/sysv/linux/poll.c: Likewise.
	* sysdeps/unix/sysv/linux/readv.c: Likewise.
	* sysdeps/unix/sysv/linux/writev.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/setgroups.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/bits/ipc.h: Likewise.
	* sysdeps/unix/sysv/linux/sparc/bits/sigaction.h: Likewise.

	* misc/tst-dirname.c: Remove K&R support, use ANSI C prototypes.
	* shadow/lckpwdf.c: Likewise.
	* stdlib/tst-strtol.c: Likewise.
	* sysdeps/generic/tcsetattr.c: Likewise.
	* sysdeps/unix/sysv/linux/ttyname.c: Likewise.
	* sysdeps/unix/sysv/linux/ttyname_r.c: Likewise.

2000-05-22  Jakub Jelinek  <jakub@redhat.com>

	* elf/dl-load.c (_dl_init_paths): If env_path_list has 0 elements,
	free it and set to (void *) -1.

2000-05-22  Jakub Jelinek <jakub@redhat.com>

	* stdio-common/vfscanf.c (__vfscanf): Remove bogus check if '-' is
	not the second character in the range.
	* stdio-common/tstscanf.c (main): Add testcase for the above.
	Reported by jik@kamens.brookline.ma.us.

2000-05-21  H.J. Lu  <hjl@gnu.org>

	* elf/do-lookup.h (do_lookup_versioned): Replace reloc_type parameter
	with noexec and noplt parameter.
	(do_lookup): Likewise.

	* elf/dl-lookup.c (_dl_lookup_symbol): Change for new parameters of
	do_lookup.  Support STV_PROTECTED.
	(_dl_lookup_symbol_skip): Likewise.
	(_dl_lookup_versioned_symbol): Likewise.
	(_dl_lookup_versioned_symbol_skip): Likewise.

	* elf/dl-reloc.c (RESOLVE): Check STB_LOCAL instead of ST_VISIBILITY.

	* elf/dl-runtime.c (profile_fixup): Fix a typo in comment.

2000-05-21  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/arm/bits/huge_val.h: Prereq gcc 2.96+, not 2.95.
	* sysdeps/i386/bits/huge_val.h: Likewise.
	* sysdeps/ieee754/bits/huge_val.h: Likewise.
	* sysdeps/m68k/bits/huge_val.h: Likewise.
	* sysdeps/sparc/sparc32/bits/huge_val.h: Likewise.
	* sysdeps/sparc/sparc64/bits/huge_val.h: Likewise.

2000-05-22  Andreas Jaeger  <aj@suse.de>

	* iconv/tst-iconv1.c (main): Remove const from inbuf to follow
	change in iconv.h.

2000-05-19  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/i386/i686/sysdep.h
	(SYSCALL_ERROR_HANDLER): Remove unneeded syscall_error which
	breaks compilation without linuxthreads.

2000-05-21  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/ia64/memccpy.S: New file.
	* sysdeps/ia64/memchr.S: New file.
	* sysdeps/ia64/memcmp.S: New file.
	* sysdeps/ia64/memcpy.S: New file.
	* sysdeps/ia64/memmove.S: New file.
	* sysdeps/ia64/memset.S: New file.
	* sysdeps/ia64/strcat.S: New file.
	* sysdeps/ia64/strchr.S: New file.
	* sysdeps/ia64/strcmp.S: New file.
	* sysdeps/ia64/strcpy.S: New file.
	* sysdeps/ia64/strlen.S: New file.
	* sysdeps/ia64/strncmp.S: New file.
	* sysdeps/ia64/strncpy.S: New file.
	* sysdeps/ia64/softpipe.h: New file.
	Patches by Dan Pop <Dan.Pop@cern.ch>.

	* manual/memory.texi: Document memory handling functions (mlock,
	munlock, mlockall, munlockall, brk, and sbrk)
	* manual/time.texi: Document timespec and friends.
	* manual/conf.texi: Fix references.
	* manual/ctype.texi: Likewise.
	* manual/errno.texi: Likewise.
	* manual/intro.texi: Likewise.
	* manual/locale.texi: Likewise.
	* manual/sysinfo.texi: Likewise.
	Patches by Bryan Henderson <bryanh@giraffe-data.com>.

2000-05-09  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/ia64/dl-machine.h: Move DL_SYMBOL_ADDRESS definition to...
	* sysdeps/ia64/dl-lookupcfg.h: ...here.

2000-05-21  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/scsi/sg.h (sg_io_hdr_t): Remove duplicate
	dxfer_direction.

2000-05-21  Ulrich Drepper  <drepper@redhat.com>

	* locale/locale.h (struct lconv): Add new elements from ISO C99.
	* locale/localeconv.c: Initialize new elements from ISO C99.
	* locale/langinfo.h: Remove _NL_MONETARY prefix from descriptors for
	new standard elements.
	* locale/categories.def: Adjust accordingly.

	* iconv/iconv.h (iconv): Remove const from inbuf parameter.
	* iconv/iconv.c: Likewise.
	* conform/data/iconv.h-data: Likewise.
	* iconv/iconv_prog.c (process_block): Remove const from second
	parameter.
	(main): Remove const from addr definition.
	* manual/charset.texi (Generic Conversion Interface): Remove from
	inbuf parameter of iconv.

	* intl/dcigettext.c: Fix typo in comment.

2000-05-20 2000  H.J. Lu  <hjl@gnu.org>

	* resolv/res_libc.c (_res): Initialize _sock to -1.

2000-05-18  Jakub Jelinek  <jakub@redhat.com>

	* libio/iofopncook.c (_IO_fopencookie): Renamed from fopencookie.
	(fopencookie@@GLIBC_2.2): New.
	(_IO_old_cookie_seek, _IO_old_fopencookie, _IO_old_cookie_jumps): New.
	(fopencookie@GLIBC_2.0): New.
	* libio/Versions: Add fopencookie to GLIBC_2.2.

2000-05-18  Andreas Jaeger  <aj@suse.de>

	* sunrpc/rpc_main.c (parseargs): Don't accept -M and -N.
	Closes PR libc/1731.

	* manual/arith.texi (Parsing of Integers): Fix typo.
	Closes PR libc/1744, reported by blp@gnu.org.

2000-05-17  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/arm/bits/huge_val.h (HUGE_VAL, HUGE_VALF): Add
	__extension__ to hexadecimal floating constant notation.
	* sysdeps/i386/bits/huge_val.h (HUGE_VAL, HUGE_VALF, HUGE_VALL):
	Likewise.
	* sysdeps/ieee754/bits/huge_val.h (HUGE_VAL, HUGE_VALF): Likewise.
	* sysdeps/m68k/bits/huge_val.h (HUGE_VAL, HUGE_VALF, HUGE_VALL):
	Likewise.
	* sysdeps/sparc/sparc64/bits/huge_val.h (HUGE_VAL, HUGE_VALF,
	HUGE_VALL): Likewise.
	* sysdeps/sparc/sparc32/bits/huge_val.h (HUGE_VAL, HUGE_VALF,
	HUGE_VALL): Likewise.
	(HUGE_VALL): Set to HUGE_VAL on sparc32.

2000-05-17  Andreas Jaeger  <aj@suse.de>

	* string/envz.h: Add pure attributes if possible.

	* string/argz.h: argz_count is a pure function.

	* string/strings.h: Add pure and const attributes if possible.

	* sysdeps/generic/memmem.c (memmem): Check arguments to avoid
	possibly searching through the whole memory.
	Closes PR libc/1730, reported by Greg Hudson <ghudson@mit.edu>.

2000-05-17  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/generic/dl-cache.h (_DL_CACHE_DEFAULT_ID): Only define if
	not yet defined.
	(_dl_cache_check_flags): Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/dl-cache.h: include_next
	dl-cache.h.

2000-05-17  Andreas Jaeger  <aj@suse.de>

	* manual/creature.texi (Feature Test Macros): Remove paragraph
	since the description is wrong.
	Closes PR libc/1691, reported by Geoff Clare <gwc@unisoft.com>.

	* scripts/config.sub: New version.
	* scripts/config.guess: Likewise.
	* manual/texinfo.tex: Likewise.

	* time/test_time.args: Removed.
	* time/Makefile (test_time-ARGS): Added contents here instead.

	* posix/tstgetopt.args: Removed.
	* posix/Makefile (tstgetopt-ARGS): Added contents here instead.

	* Rules: Allow arguments for test files to be specified in
	Makefile with testname-ARGS; remove rules with .args in it.

	* dirent/Makefile (opendir-tst1-ARGS): Use this for opendir-tst1,
	remove old bogus rule for opendir-tst1.args.

	* stdlib/test-canon.c: Rewrite to use test-skeleton.c.

	* stdlib/Makefile (test-canon-ARGS): New, supply argument to chdir
	into objdir.  This allows a readonly sourcetree.
	Reported by lrgallardo@yahoo.com, closes PR libc/1421.

2000-05-16  Andreas Jaeger  <aj@suse.de>,
	    David Huggins-Daines <dhd@linuxcare.com>

	* sysdeps/generic/dl-cache.c (_dl_load_cache_lookup): Set
	cache_data in case of only new cache format correctly.

	* sysdeps/generic/dl-cache.c (_dl_load_cache_lookup): Align struct
	cache_file_new.

	* sysdeps/generic/dl-cache.h (ALIGN_CACHE): New macro to align
	struct cache_file_new.

	* elf/cache.c (save_cache): Fix str_offset if only new cache is
	present.

	* elf/cache.c (save_cache): Align struct new_file_cache.
	(print_cache): Likewise.

2000-05-13  Jakub Jelinek  <jakub@redhat.com>

	* elf/soinit.c (__libc_global_ctors): Move
	__pthread_initialize_minimal call out of HAVE_DWARF2_* defines.
	* resolv/resolv.h (__res_state): Added __attribute__((const)).
	(_res): If __RES_PTHREAD_INTERNAL is defined, declare it as
	variable, don't define it to __res_state call.

2000-05-13  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/bits/socket.h (PF_PPPOX): New, from
	Linux 2.3.99pre7.
	(AF_PPPOX): Likewise.
	* sysdeps/unix/sysv/linux/mips/bits/socket.h (PF_PPPOX): Likewise.
	(AF_PPPOX): Likewise.

2000-05-12  Andreas Jaeger  <aj@suse.de>

	* inet/netinet/in.h (IN6_ARE_ADDR_EQUAL): Correct indices.
	Reported by tmoestl@gmx.net, closes PR libc/1732.

2000-05-11  Jan Hubicka  <jh@suse.cz>

	* misc/sys/cdefs.h: Add support for pure attribute.

	* include/string.h: Add __attribute_pure__ to various functions.
	* string/string.h: Likewise.

2000-05-10  Jakub Jelinek  <jakub@redhat.com>

	* elf/dl-reloc.c (_dl_reloc_bad_type): Sync messages with plt
	argument.
	* sysdeps/sparc/sparc64/dl-machine.h (elf_machine_rela): Handle
	R_SPARC_UA64.
	* sysdeps/unix/sysv/linux/sparc/sparc64/time.c: New file.

2000-05-10  Jakub Jelinek  <jakub@redhat.com>

	* elf/dl-reloc.c (_dl_reloc_bad_type): Write type into the message
	at proper place.  Compute the high nibble correctly.

2000-05-09  Jakub Jelinek  <jakub@redhat.com>

	* elf/ldconfig.c: Include elf.h.

	* elf/dl-sym.c (_dl_sym): Test ref not result for non-zero.
	(_dl_vsym): Likewise.
	Reported by Owen Taylor <otaylor@redhat.com>.

	* elf/dl-deps.c (_dl_map_object_deps): Zero terminate L->l_initfini
	always.

2000-05-08  Andreas Jaeger  <aj@suse.de>

	* include/libintl.h: Add prototype for __bind_textdomain_codeset.

	* intl/bindtextdom.c (set_binding_values): Add prototype.

2000-05-08  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/alpha/dl-machine.h (elf_machine_rela): Fix arguments in
	call to elf_machine_fixup_plt.
	* sysdeps/sparc/sparc32/dl-machine.h (elf_machine_rela): Likewise.
	* sysdeps/sparc/sparc64/dl-machine.h (elf_machine_rela): Likewise.

2000-05-08  Jakub Jelinek  <jakub@redhat.com>

	* elf/dl-fini.c (_dl_fini): Bump l_opencount of all objects so that
	they are not dlclose'd from underneath us.

2000-05-08  Andreas Schwab  <schwab@suse.de>

	* posix/execle.c: Fix size parameter of memcpy.

2000-05-08  Andreas Schwab  <schwab@suse.de>

	* sysdeps/unix/sysv/linux/m68k/getpagesize.c: New file.  Use
	getpagesize syscall if available.

2000-05-08  Andreas Jaeger  <aj@suse.de>

	* sysdeps/generic/lockf64.c (lockf64): Return -1 for overflow and
	set errno.

2000-05-08  Jakub Jelinek  <jakub@redhat.com>

	* elf/dl-lookup.c (add_dependency): Reallocate l_reldeps in
	sizeof(struct link_map *) chunks, not in bytes.

2000-05-07  Ulrich Drepper  <drepper@redhat.com>

	* locale/Makefile (locale-CPPFLAGS): Renamed from CPPFLAGS.  It's
	only needed for locale.
	* catgets/Makefile (catgets-CPPFLAGS): Renamed from CPPFLAGS.
	It's only needed for catgets.
	Patches by Greg McGary <gkm@eng.ascend.com>.

2000-05-07  Mark Kettenis  <kettenis@gnu.org>

	* nss/nss_db/db-open.c: Cleanup and add comments.  Pretty print.
	Remove duplicate <errno.h> include.  Remove inclusion of
	<libintl.h> and "nsswitch.h".
	(set_cloexec_flag): New function, broken out of dbopen.
	(dbopen): Changed return type to `enum
	nss_status'.  Mostly rewritten to make sure that we do not report
	NSS_STATUS_SUCCESS if something went wrong.  Remove unnecessary casts.
	(internal_setent): Change return type to nss_status.
	Document, and make sure that the function
	behaves accordingly.  Make dynamically loading the database
	library really thread-safe and return NSS_STATUS_UNAVAIL if it
	failed.
	(db_cursor): Return ENOMEM is memory allocation failed.  Remove
	unecessary casts.
	* nss/nss_db/dummy-db.h: Add copyright notice.  Improve
	documentation.
	(struct dbc24, struct dbc27): Use DBT type in parameter lists for
	c_get function member.
	* nss/nss_db/nss_db.h: Add and tweak some comments.
	(DBT): Move typedef before NSS_DBC typedef.
	(NSS_DBC, NSS_DB): Use DBT in function member parameter lists.

2000-05-07  H.J. Lu  <hjl@gnu.org>

	* csu/initfini.c: Moved to ....
	* sysdeps/generic/initfini.c: ...here.

	* csu/Makefile (initfini.c): Set vpath to $(full_config_sysdirs).

2000-05-07  Ulrich Drepper  <drepper@redhat.com>

	* manual/resource.texi: Document POSIX scheduling functions.
	Patch by Bryan Henderson <bryanh@giraffe-data.com>.

	* inet/rcmd.c (rcmd_af): errno is not set if read returns without
	reading anything.  Reported by Andries.Brouwer@cwi.nl.

	* sysdeps/generic/memccpy.c (__memccpy): Don't use reg_char type
	for x since promotion in comparison might leads to unexpected
	results.  Reported by Dan Pop <Dan.Pop@cern.ch>.

	* iconv/Makefile (tests): Add tst-iconv1.
	* iconv/tst-iconv1.c: New file.
	* iconv/gconv_simple.c (internal_ucs4_loop): Prefer reporting
	empty input buffer over full output buffer.
	(ucs4_internal_loop): Likewise.
	(ucs4_internal_loop_unaligned): Likewise.
	(internal_ucs4le_loop): Likewise.
	(internal_ucs4le_loop_unaligned): Likewise.
	(ucs4le_internal_loop): Likewise.
	(ucs4le_internal_loop_unaligned): Likewise.
	Reported by yaoz@nih.gov.

2000-05-06  Bruno Haible  <haible@clisp.cons.org>

	* iconv/gconv_open.c (__gconv_open): If __gconv_find_transform
	returned != __GCONV_OK, there is nothing to clean up.

2000-05-06  Bruno Haible  <haible@clisp.cons.org>

	* intl/tst-gettext.c (main): Disable possibly existing LC_CTYPE and
	OUTPUT_CHARSET environment variables.

2000-05-06  Andreas Jaeger  <aj@suse.de>

	* sysdeps/generic/dl-cache.h (struct file_entry_new): New.
	(struct cache_file_new): New.
	(struct file_entry): New (moved from cache.c).
	(struct cache_file): New (moved from cache.c).

	* sysdeps/generic/dl-cache.c (SEARCH_CACHE): New macro, broken out
	from _dl_load_cache_lookup.
	(_dl_load_cache_lookup): Move search to SEARCH_CACHE macro, handle
	the different cache formats.
	New variable cache_new for new format.

	* elf/ldconfig.h: Change according to changes in cache.c and
	ldconfig.c; remove cache_libcmp; add opt_format.

	* elf/ldconfig.c: Include "dl-cache.h" and "dl-procinfo.h"; remove
	stuff that's defined in those headers.
	Add hwcap to struct lib_entry.
	(opt_format): New variable to select cache format.
	(options): Add format parameter.
	(is_hwcap): New function.
	(path_hwcap): New function.
	(parse_opt): Handle new format parameter.
	(search_dir): Handle hwcap, search also subdirectories with hwcap.

	* elf/cache.c (_GNU_SOURCE): Removed.  Not needed anymore since
	ldconfig is part of glibc.
	Include dl-cache.h and remove stuff that's defined there.
	(struct cache_entry): Add new member hwcap.
	(print_entry): Print hwcap, cleanup a bit.
	(print_cache): Print new and old formats.
	(compare): Use _dl_cache_libcmp from dl-cache.h; handle hwcap.
	(save_cache): Save new and old formats.
	(add_to_cache): Handle hwcap.

	* sysdeps/generic/dl-cache.c (_dl_cache_libcmp): Moved from here...
	* sysdeps/generic/dl-cache.h (_dl_cache_libcmp): ...to here.
	* sysdeps/generic/dl-cache.c (LD_SO_CACHE): Moved from here...
	* sysdeps/generic/dl-cache.h (LD_SO_CACHE): ...to here.
	* sysdeps/generic/dl-cache.c (CACHEMAGIC): Moved from here...
	* sysdeps/generic/dl-cache.h (CACHEMAGIC): ...to here.

2000-05-05  Bruno Haible  <haible@clisp.cons.org>

	* intl/dcigettext.c (alignof): New macro.
	(_nl_find_msg): Use it instead of __alignof__. Pass correct output
	buffer length to __gconv/iconv. If malloc (freemem_size) fails, set
	freemem_size to 0.

2000-05-05  Bruno Haible  <haible@clisp.cons.org>

	* intl/dcigettext.c (dcigettext): Fix interpretation of tsearch
	return value.

2000-05-06  Ulrich Drepper  <drepper@redhat.com>

	* intl/dcigettext.c (DCIGETTEXT): Always define local variable `index'.
	(mempcpy): Correct typo is parameter list.

2000-05-06  Andreas Jaeger  <aj@suse.de>

	* sysdeps/i386/fpu/bits/mathinline.h: Disable some inline
	functions unless -ffast-math is given to gcc.

2000-05-06  Ulrich Drepper  <drepper@redhat.com>

	* po/ko.po: Update from translation team.

2000-05-05  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/aix/linux/errnoconv.c: Moved to...
	* sysdeps/unix/sysv/linux/powerpc/aix/errnoconv.c: ...here.
	* sysdeps/unix/sysv/aix/linux/statconv.c: Moved to...
	* sysdeps/unix/sysv/linux/powerpc/aix/statconv.c: ...here.
	* sysdeps/unix/sysv/aix/linux/direntconv.c: Moved to...
	* sysdeps/unix/sysv/linux/powerpc/aix/direntconv.c: ...here.

	* sysdeps/unix/sysv/aix/linux/linux-errno.h: Removed.
	* sysdeps/unix/sysv/aix/linux/linux-stat.h: Removed
	* sysdeps/unix/sysv/aix/linux/linux-dirent.h: Removed.

	* sysdeps/unix/sysv/linux/powerpc/aix/aix-dirent.h: New file.
	* sysdeps/unix/sysv/linux/powerpc/aix/aix-errno.h: New file.
	* sysdeps/unix/sysv/linux/powerpc/aix/aix-stat.h: New file.
	* sysdeps/unix/sysv/linux/powerpc/aix/aix-termios.h: New file.

	* sysdeps/unix/sysv/linux/powerpc/aix/tcgetattr.c: New file.
	* sysdeps/unix/sysv/linux/powerpc/aix/tcsetattr.c: New file.

2000-05-05  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/unix/sysv/linux/ia64/sysdep.h: New file.
	* sysdeps/unix/sysv/linux/ia64/syscall.S: New file.

	* sysdeps/unix/sysv/linux/ia64/bits/types.h: New file.
	* sysdeps/unix/sysv/linux/ia64/bits/endian.h: New file.

	* sysdeps/ia64/Implies: New file.
	* sysdeps/ia64/Versions: New file.  Declare _dl_symbol_address.
	* sysdeps/ia64/Makefile: New file.
	* sysdeps/ia64/gmp-mparam.h: New file,

	* sysdeps/ia64/elf/start.S: New file.

	* sysdeps/ia64/bits/fenv.h: New file.

2000-05-05  David Mosberger-Tang  <davidm@hpl.hp.com>

	* sysdeps/unix/sysv/linux/ia64/sysdep.S: New file.

2000-04-26  Jes Sorensen  <Jes.Sorensen@cern.ch>

	* sysdeps/unix/sysv/linux/ia64/bits/elfclass.h: New file.  The
	ia64 has 64 bit .hash entries just as the Alpha.

2000-04-25  Jes Sorensen  <Jes.Sorensen@cern.ch>

	* sysdeps/ia64/memprof.h: New file.  Provide GETSP() macro.

2000-04-17  Jes Sorensen  <Jes.Sorensen@cern.ch>

	* sysdeps/ia64/fpu/fclrexcpt.c: New file.
	* sysdeps/ia64/fpu/fedisblxcpt.c: New file.
	* sysdeps/ia64/fpu/feenablxcpt.c: New file.
	* sysdeps/ia64/fpu/fegetenv.c: New file.
	* sysdeps/ia64/fpu/fegetexcept.c: New file.
	* sysdeps/ia64/fpu/fegetround.c: New file.
	* sysdeps/ia64/fpu/feholdexcpt.c: New file.
	* sysdeps/ia64/fpu/fesetenv.c: New file.
	* sysdeps/ia64/fpu/fesetround.c: New file.
	* sysdeps/ia64/fpu/feupdateenv.c: New file.
	* sysdeps/ia64/fpu/fgetexcptflg.c: New file.
	* sysdeps/ia64/fpu/fraiseexcpt.c: New file.
	* sysdeps/ia64/fpu/fsetexcptflg.c: New file.
	* sysdeps/ia64/fpu/ftestexcept.c: New file.

2000-05-05  Andreas Jaeger  <aj@suse.de>

	* misc/tst-tsearch.c (main): Correct type for initstate argument.

	* sysdeps/generic/dl-procinfo.h (_DL_HWCAP_COUNT): New.
	(_dl_string_hwcap): New, does nothing.

	* sysdeps/unix/sysv/linux/i386/dl-procinfo.h (_DL_HWCAP_COUNT): New.
	(_dl_procinfo): Use _DL_HWCAP_COUNT instead of a constant.
	(_dl_string_hwcap): New function, converts from string to hwcap
	encoding.
	* sysdeps/unix/sysv/linux/sparc/sparc32/dl-procinfo.h
	(_DL_HWCAP_COUNT): New.
	(_dl_procinfo): Use _DL_HWCAP_COUNT instead of a constant.
	(_dl_string_hwcap): New function, converts from string to hwcap
	encoding.
	* sysdeps/unix/sysv/linux/sparc/sparc64/dl-procinfo.h
	(_DL_HWCAP_COUNT): New.
	(_dl_procinfo): Use _DL_HWCAP_COUNT instead of a constant.
	(_dl_string_hwcap): New function, converts from string to hwcap
	encoding.

2000-05-05  Ulrich Drepper  <drepper@redhat.com>

	* elf/Makefile (distribute): Add dl-lookupcfg.h.
	* sysdeps/ia64/Dist: New file.

	* elf/dl-load.c (_dl_map_object_from_fd): Little of computation of
	parameter to mprotect and for variable assignments.

2000-05-03  Jes Sorensen  <jes@linuxcare.com>

	* sysdeps/generic/ldsodefs.h (LOOKUP_VALUE_ADDRESS): Check the
	validity of map before dereferencing it.

	* elf/dl-reloc.c (RESOLVE_MAP): Define.

2000-05-02  Jes Sorensen  <jes@linuxcare.com>

	* elf/dl-runtime.c (fixup): Add the value returned in the symbol
	lookup to the arguments to elf_machine_fixup_plt().

	* sysdeps/ia64/dl-machine.h (elf_machine_fixup_plt): Add Link_map
	of the symbol being resolved to input argument list and make the
	function return the pointer to the reloc.

	* sysdeps/alpha/dl-machine.h (elf_machine_fixup_plt): Change
	return valuie to lookup_t and return the value.
	* sysdeps/arm/dl-machine.h (elf_machine_fixup_plt): Likewise.
	* sysdeps/generic/dl-machine.h (elf_machine_fixup_plt): Likewise.
	* sysdeps/i386/dl-machine.h (elf_machine_fixup_plt): Likewise.
	* sysdeps/m68k/dl-machine.h (elf_machine_fixup_plt): Likewise.
	* sysdeps/sparc/sparc32/dl-machine.h (elf_machine_fixup_plt): Likewise.
	* sysdeps/sparc/sparc64/dl-machine.h (elf_machine_fixup_plt): Likewise.

	* sysdeps/powerpc/dl-machine.h (elf_machine_fixup_plt): Likewise.
	Make it an inline function returning value after calling
	__elf_machine_fixup_plt().

	* elf/dl-sym.c (_dl_vsym): Use DL_SYMBOL_ADDRESS() to obtain the
	symbol address.

	* elf/dl-symbol.c (_dl_symbol_value): Use LOOKUP_VALUE_ADDRESS to
	obtain the symbol address.

	* sysdeps/generic/ldsodefs.h: Add generic DL_SYMBOL_ADDRESS() macro
	depending on the definition of ELF_FUNCTION_PTR_IS_SPECIAL.

	* sysdeps/ia64/dl-machine.h: Add DL_SYMBOL_ADDRESS() macro calling
	_dl_symbol_address() - this way DL_SYMBOL_ADDRESS() turns into an
	inline on non ia64.

2000-04-28  Jes Sorensen  <jes@linuxcare.com>

	* elf/dl-runtime.c (fixup): Use the portable macros to get the
	symbol address of an object.

	* elf/dl-runtime.c (fixup-profile): Use the portable macros to get
	the symbol address of an object.

	* elf/dl-libc.c (struct do_dlsym_args): Change loadbase to a lookup_t.
	* elf/dl-lookup.c (_dl_lookup_symbol): Likewise.
	(_dl_lookup_symbol_skip): Likewise.
	(_dl_lookup_versioned_symbol): Likewise.
	(_dl_lookup_versioned_symbol_skip): Likewise.

2000-04-27  Jes Sorensen  <jes@linuxcare.com>

	* elf/rtld.c (_dl_start): Get the function pointer return address
	via _dl_start_address for architectures that need a function
	pointer descriptor rather than just a pointer (ia64).

	* sysdeps/generic/dl-lookupcfg.h: New file.
	* sysdeps/ia64/dl-lookupcfg.h: New file.
	* sysdeps/ia64/dl-machine.h: New file.
	* sysdeps/ia64/dl-symaddr.c: New file.
	* sysdeps/ia64/dl-fptr.c: New file.

	* elf/elf.h: Add IA-64 specific definitions.

2000-05-04  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/generic/bits/confname.h (_SC* enum): Avoid comma at the
	end of enum.

2000-05-04  Jakub Jelinek  <jakub@redhat.com>

	* iconv/gconv.h (__gconv_t): Add __extension__ to make gcc -pedantic
	happy.

2000-04-11  Geoff Keating  <geoffk@cygnus.com>

	* sysdeps/powerpc/dl-start.S (_dl_start): Add _dl_start_user
	symbol.  Call _dl_init rather than the old way.

2000-05-04  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-open.c (dl_open_worker): Use l_map_start and l_map_end to
	test for pointer in range of DSO address space.

2000-05-04  Andreas Jaeger  <aj@suse.de>

	* nscd/pwdcache.c (addpwbyname): Initialize oldeuid to silence GCC.

2000-05-03  Ulrich Drepper  <drepper@redhat.com>

	* locale/findlocale.c (_nl_find_locale): Add new parameter to
	calls of _nl_make_l10nflist.

	* libio/stdio.h: Make fseeko and ftello prototypes available is
	__USE_LARGEFILE.  Patch by Paul Eggert <eggert@twinsun.com>.

	* sysdeps/generic/dl-environ.c (unsetenv): Follow change to the
	real unsetenv implementation from 1999-07-29 [PR libc/1714].

2000-05-03  Bruno Haible  <haible@clisp.cons.org>

	* intl/dcigettext.c (dcigettext): Do the defaulting of 'domainname'
	before calling tfind.

2000-03-05  Jakub Jelinek  <jakub@redhat.com>

	* resolv/resolv.h (res_querydomain): Remove redefinition to
	__res_querydomain (reported by Owen Taylor <otaylor@redhat.com>).

2000-05-03  Ulrich Drepper  <drepper@redhat.com>

	* po/gl.po: Update from translation team.

	* manual/intro.texi (Program Basics): Change section title.
	* manual/process.texi: Fix reference.
	(Executing a File): Add reference exec in other section.
	* manual/signal.texi: Fix reference.
	* manual/startup.texi: Document syscall function.
	Patches by Bryan Henderson <bryanh@giraffe-data.com>.

2000-04-29  Bruno Haible  <haible@clisp.cons.org>

	* intl/libintl.h (bind_textdomain_codeset): New declaration.
	* intl/bindtextdom.c (set_binding_values): New function.
	(bindtextdomain): Call it.
	(bind_textdomain_codeset): New function.
	* intl/dcigettext.c (dcigettext): Pass binding to _nl_find_domain.
	(free_mem): Free each binding's codeset.
	* intl/gettextP.h (struct binding): Add codeset field.
	(_nl_find_domain): Add domainbinding argument.
	* intl/finddomain.c (_nl_find_domain): Add domainbinding argument.
	Pass it to _nl_make_l10nflist.
	* intl/loadinfo.h (struct loaded_l10nfile): Add domainbinding field.
	(_nl_make_l10nflist): Add domainbinding argument.
	* intl/l10nflist.c (_nl_make_l10nflist): Add domainbinding argument.
	* intl/loadmsgcat.c (_nl_load_domain): Look at the domainbinding's
	codeset when determining outcharset. If !_LIBC && HAVE_ICONV, call
	locale_charset().
	* manual/message.texi: New node "Charset conversion in gettext".

2000-04-30  Bruno Haible  <haible@clisp.cons.org>

	* catgets/open_catalog.c (__open_catalog): Use __builtin_expect where
	appropriate.  Handle possible __read error.

2000-04-29  Bruno Haible  <haible@clisp.cons.org>

	* intl/gettextP.h (__builtin_expect): Define as empty if not a
	compiler builtin.
	* intl/loadinfo.h (__builtin_expect): Likewise.
	* intl/dcigettext.c (dcigettext, _nl_find_msg): Use
	__builtin_expect where appropriate.
	* intl/loadmsgcat.c (_nl_load_domain): Likewise.
	* intl/localealias.c (extend_alias_table): Return an error indicator.
	(read_alias_file): Bail out if extend_alias_table fails.

2000-04-29  Bruno Haible  <haible@clisp.cons.org>

	* intl/loadmsgcat.c: Define _GNU_SOURCE as early as possible.
	* intl/localealias.c: Likewise.

2000-05-01  Bruno Haible  <haible@clisp.cons.org>

	* intl/loadmsgcat.c (_nl_load_domain): Initialize domain->conv_tab.
	Initialize domain->plural and domain->nplurals even if there is no
	nullentry.

2000-05-01  Bruno Haible  <haible@clisp.cons.org>

	* intl/dcigettext.c (_nl_find_msg): Terminate __gconv loop if return
	value is == __GCONV_OK or == __GCONV_EMPTY_INPUT, not != __GCONV_OK.
	In case of failure, goto converted.

2000-05-01  Bruno Haible  <haible@clisp.cons.org>

	* wcsmbs/wcsmbsload.c (norm_add_slashes): Move away.
	* iconv/gconv_int.h (norm_add_slashes): Move to here.
	* intl/loadmsgcat.c (_nl_load_domain): Normalize strings passed to
	__gconv_open.

2000-04-29  Bruno Haible  <haible@clisp.cons.org>

	* intl/dcigettext.c (transcmp): Compare the domains as well.
	(dcigettext): Call strlen (msgid1) after testing msgid1 against NULL,
	not before.
	* intl/loadmsgcat.c (_nl_load_domain): Deal with EINTR. Include
	<errno.h>.

2000-05-03  Ulrich Drepper  <drepper@redhat.com>

	* string/bits/string2.h: Declare __strdup and __strndup if necessary.
	Reported by Bruno Haible.

2000-04-29  Bruno Haible  <haible@clisp.cons.org>

	* manual/arith.texi: Remove @w from @itemize.

2000-05-02  Andreas Jaeger  <aj@suse.de>

	* conform/data/tar.h-data: Add some checks for specific values.

	* conform/data/stdlib.h-data: Add checks for value of EXIT_SUCCESS
	and RAND_MAX.

	* conform/data/stdio.h-data: Add checks for value of TMP_MAX and
	FOPEN_MAX.

	* conform/data/netinet/in.h-data: Add exact checks for the values
	fo INET_ADDRSTRLEN and INET6_ADDRSTRLEN.

	* conform/data/float.h-data: Add some minimal values.

	* conform/conformtest.pl: Test for macros with string constants,
	check for minimum and maximum values.
	Add limits.h to headers.

	* conform/data/cpio.h-data: Test for value of MAGIC.

	* conform/data/limits.h-data: New file.

2000-04-30  Bruno Haible  <haible@clisp.cons.org>

	* math/Makefile (headers): Add bits/fenvinline.h.

2000-05-01  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/aix/linux/linux-dirent.h: New file.
	* sysdeps/unix/sysv/aix/linux/direntconv.c: New file.

	* posix/Versions: Change posix_spawnattr_getdefault and
	posix_spawnattr_setdefault to posix_spawnattr_getsigdefault
	and posix_spawnattr_setsigdefault respectively.
	* posix/spawn.h: Likewise.
	* posix/spawnattr_getdefault.h: Likewise.
	* posix/spawnattr_setdefault.h: Likewise.
	* conform/data/spawn.h-data: Likewise.

2000-05-01  Andreas Jaeger  <aj@suse.de>

	* nscd/nscd.c: Include <grp.h> for setgroups prototype.

2000-04-30  Ulrich Drepper  <drepper@redhat.com>

	* manual/sysinfo.texi: Document getdomainname, setdomainname
	and sysctl.
	* manual/string.texi: Fix typo.
	* manual/terminal.texi: Document gtty and stty.
	Patch by Bryan Henderson <bryanh@giraffe-data.com>.

2000-04-30  Andreas Jaeger  <aj@suse.de>

	* posix/bits/posix1_lim.h (_POSIX_PATH_MAX): Increase to 256 in
	accordance with Austin Draft.

2000-04-30  Ulrich Drepper  <drepper@redhat.com>

	* catgets/gencat.c (read_input_file): Use isblank and not isspace
	to recognize second character in comment line.

	* sysdeps/unix/sysv/linux/if_index.c (if_nameindex): Set errno to
	ENOBUFS if we are out of memory.

	* sysdeps/generic/bits/fcntl.h (F_SETOWN, F_GETOWN): Make
	available if __USE_XOPEN2K.
	* sysdeps/mach/hurd/bits/fcntl.h: Likewise.
	* sysdeps/unix/common/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/alpha/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/i386/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/mips/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/sparc/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/aix/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/bits/fcntl.h: Likewise.

2000-04-29  Ulrich Drepper  <drepper@redhat.com>

	* iconv/iconv_prog.c (main): Handle input file name "-" correctly.
	Recognize option -s, -c, and -l.

2000-04-20  Thorsten Kukuk  <kukuk@suse.de>

	* nscd/nscd.c: Start new session for nscd, drop privilegs
	to configured user if requested and no -S parameter are used.
	* nscd/nscd.conf: Add new option "server-user".
	* nscd/nscd_conf.c: Add support for new "server-user" option.
	* nscd/nscd.h: Add declaration for server_user variable.
	Based on patch by Chris Wing <wingc@engin.umich.edu>

2000-04-29  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/unix/sysv/linux/i386/sigaction.c: Add comment explaining
	that changing the __restore and __restore_rt signal return code
	will break GDB.

2000-04-29  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/unix/sysv/linux/i386/sys/ucontext.h: Do not include
	<sys/user.h>.

2000-04-29  Mark Kettenis  <kettenis@gnu.org>

	* conform/data/ucontext.h-data: Allow ss_* instead of SS_*.

2000-04-29  Ulrich Drepper  <drepper@redhat.com>

	* conform/conformtest.pl (@headers): Add sys/utsname.h, sys/un.h,
	sys/socket.h, spawn.h, netinet/tcp.h, netinet/in.h, net/if.h, and
	arpa/inet.h.
	* conform/data/fcntl.h-data: Add F_GETOWN, F_SETOWN,
	SEEK_SET, SEEK_CUR, SEEK_END, S_IFMT, S_IFBLK, S_IFCHR, S_IFIFO,
	S_IFREG, S_IFDIR, S_IFLNK, S_IFSOCK, S_IRWXU, S_IRUSR S_IWUSR,
	S_IXUSR, S_IRWXG, S_IRGRP, S_IWGRP, S_IXGRP, S_IRWXO, S_IROTH,
	S_IWOTH, S_IXOTH, S_ISUID, S_ISGID, S_ISVTX, POSIX_FADV_NORMAL,
	POSIX_FADV_SEQUENTIAL, POSIX_FADV_RANDOM, POSIX_FADV_WILLNEED,
	POSIX_FADV_DONTNEED, POSIX_FADV_NOREUSE, posix_fadvise,
	posix_fallocate, and posix_madvise.
	* conform/data/netdb.h-data: New file.
	* conform/data/pthread.h-data: Add pthread_barrier_t,
	pthread_barrierattr_t, pthread_barrier_destroy,
	pthread_barrier_init, pthread_barrier_wait,
	pthread_barrierattr_destroy, pthread_barrierattr_getpshared,
	pthread_barrierattr_init, pthread_barrierattr_setpshared,
	pthread_condattr_getclock, pthread_condattr_setclock,
	pthread_getcpuclockid, pthread_mutex_timedlock,
	pthread_rwlock_timedrdlock, pthread_rwlock_timedwrlock,
	pthread_sigmask, pthread_spin_destroy, pthread_spin_init,
	pthread_spin_lock, pthread_spin_trylock, and pthread_spin_unlock.
	* conform/data/sched.h-data: Add sched_ss_low_priority,
	sched_ss_repl_period, sched_ss_init_budget, sched_ss_max_repl, and
	SCHED_SPORADIC.
	* conform/data/semaphore.h-data: Add sem_timedwait.
	* conform/data/signal.h-data: Add SIGIO.
	* conform/data/spawn.h-data: New file.
	* conform/data/stdlib.h-data: Add posix_memalign, setenv, and unsetenv.
	* conform/data/time.h-data: Add CLOCK_PROCESS_CPUTIME_ID,
	CLOCK_THREAD_CPUTIME_ID, clock_getcpuclockid, and clock_nanosleep.
	Fix typo in gmtime_r definition.
	* conform/data/unistd.h-data: Add _POSIX_ADVISORY_INFO,
	_POSIX_ASYNCHRONOUS_IO, _POSIX_BARRIERS, _POSIX_MONOTONIC_CLOCK,
	_POSIX_READER_WRITER_LOCKS, _POSIX_SHELL, _POSIX_SPAWN,
	_POSIX_SPIN_LOCKS, _POSIX_SPORADIC_SERVER, _POSIX_THREAD_CPUTIME,
	_POSIX_TYPED_MEMORY_OBJECTS, _POSIX_THREAD_SPORADIC_SERVER,
	_XOPEN_STREAMS, _POSIX_TIMEOUTS, _POSIX2_PBS,
	_POSIX2_PBS_ACCOUNTING, _POSIX2_PBS_CHECKPOINT,
	_POSIX2_PBS_LOCATE, _POSIX2_PBS_MESSAGE, _POSIX2_PBS_TRACK,
	_SC_2_PBS, _SC_2_PBS_ACCOUNTING, _SC_2_PBS_CHECKPOINT,
	_SC_2_PBS_LOCATE, _SC_2_PBS_MESSAGE, _SC_2_PBS_TRACK,
	_SC_BARRIERS, _SC_BASE, _SC_CLOCK_SELECTION, _SC_DEVICE_IO,
	_SC_DEVICE_SPECIFIC, _SC_DEVICE_SPECIFIC_R, _SC_FD_MGMT, _SC_FIFO,
	_SC_FILE_ATTRIBUTES, _SC_FILE_LOCKING, _SC_FILE_SYSTEM,
	_SC_MEMORY_PROTECTION, _SC_MESSAGE_PASSING, _SC_MONOTONIC_CLOCK,
	_SC_MESSAGE_PASSING, _SC_MONOTONIC_CLOCK, _SC_MULTIPLE_PROCESS,
	_SC_NETWORKING, _SC_PIPE, _SC_READER_WRITER_LOCKS, _SC_REGEXP,
	_SC_SHELL, _SC_SIGNALS, _SC_SINGLE_PROCESS, _SC_SPIN_LOCKS,
	_SC_TYPED_MEMORY_OBJECTS, _SC_USER_GROUPS, _SC_USER_GROUPS_R,
	_SC_STREAMS, _PC_REC_INCR_XFER_SIZE, _PC_REC_MAX_XFER_SIZE,
	_PC_REC_MIN_XFER_SIZE, _PC_REC_XFER_ALIGN, setegid, seteuid.  Fix
	typo in off_t definition.
	* conform/data/net/if.h-data: New file.
	* conform/data/netinet/in.h-data: New file.
	* conform/data/netinet/tcp.h-data: New file.
	* conform/data/sys/mman.h-data: Add POSIX_MADV_NORMAL,
	POSIX_MADV_SEQUENTIAL, POSIX_MADV_RANDOM, POSIX_MADV_WILLNEED,
	POSIX_MADV_DONTNEED, POSIX_TYPED_MEM_ALLOCATE,
	POSIX_TYPED_MEM_ALLOCATE_CONTIG, POSIX_TYPED_MEM_MAP_ALLOCATABLE,
	posix_typedmem_info, posix_mem_offset, posix_typed_mem_get_info,
	and posix_typed_mem_open.
	* conform/data/sys/socket.h-data: New file.
	* conform/data/sys/stat.h-data: Add S_TYPEISTMO and isfdtype.
	* conform/data/sys/types.h-data: Add pthread_barrier_t,
	pthread_barrierattr_t, and pthread_spinlock_t.
	* conform/data/sys/un.h-data: New file.
	* conform/data/sys/utsname.h-data: New file.

	* include/netdb.h (__gethostbyaddr_r): Fix types of first and second
	parameter.
	* inet/gethstbyad.c (gethostbyname): Likewise.
	* inet/gethstbyad_t.c (gethostbyname_r): Likewise.
	* inet/getipnodebyad.c (getipnodebyad): Likewise.
	* nis/nss_nis/nis-hosts.c (_nss_nis_gethostbyaddr_r): Likewise.
	* nis/nss_nisplus/nisplus-hosts.c (_nss_nisplus_gethostbyaddr_r):
	Likewise.
	* nscd/gethstbyad_r.c (gethostbyaddr_r): Likewise.
	* nscd/nscd_gethst_r.c (__nscd_gethostbyaddr_r): Likewise.
	* nscd/nscd_proto.h (__nscd_gethostbyaddr_r): Likewise.
	* nss/nss_files/files-hosts.c (_nss_files_gethostbyaddr_r): Likewise.
	* resolv/gethnamaddr.c (gethostbyname): Likewise.
	* resolv/netdb.h (struct hostent): Fix type of h_length member.
	(gethostbyaddr, getipnodebyaddr, gethostbyaddr_r): Fix types of first
	and second parameter.

	* wcsmbs/mbrtowc.c (__mbrtowc): Set end of buffer correctly if s
	== NULL.

2000-04-29  Andreas Jaeger  <aj@suse.de>

	* conform/data/arpa/inet.h-data: New file.

2000-04-28  Geoff Clare <gwc@unisoft.com>

	* io/ftw.c: Set errno to ENOENT (instead of ENOTDIR) when the
	path passed to ftw() or nftw() is an empty string.
	Closes PR libc/1710.

2000-04-27  Ulrich Drepper  <drepper@redhat.com>

	* localedata/Makefile (test-srcs): Add tst-mbswcs4 and tst-mbswcs5.
	(do-tst-mbswcs): Add tst-mbswcs4 and tst-mbswcs5 to dependencies.
	* localedata/tst-mbswcs.sh: Run tst-mbswcs4 and tst-mbswcs5.
	* localedata/tst-mbswcs4.c: New file.
	* localedata/tst-mbswcs5.c: New file.

	* wcsmbs/wcrtomb.c (__wcrtomb): Set end of buffer correctly if s
	== NULL.  Little optimization.

	* elf/dl-init.c (_dl_init): Correct typo (DT_PREINIT_ARRAY not
	DT_PREINIT_ARRAYSZ).
	Reported by Jes Sorensen <Jes.Sorensen@cern.ch>.

	* hesiod/nss_hesiod/hesiod-grp.c (_nss_hesiod_initgroups): Handle
	overflows in conversion from ASCII.

2000-04-26  Jakub Jelinek  <jakub@redhat.com>

	* Makeconfig (full_config_sysdirs): Renamed from full-config-sysdirs.
	* Makerules (full_config_sysdirs): Likewise.
	* MakeTAGS (full_config_sysdirs): Likewise.

2000-04-26  Jakub Jelinek  <jakub@redhat.com>

	* .cvsignore: Remove linuxthreads.
	* po/.cvsignore: Remove *.pot.
	* posix/glob/.cvsignore: Removed.
	* sysdeps/unix/bsd/osf/.cvsignore: Removed.

2000-04-25  Andreas Jaeger  <aj@suse.de>

	* conform/Makefile (distribute): Also distribute contents of
	subdirectories.

	* Makerules (no_deps): Remove abi-versions.h.

	* nis/nis_print_group_entry.c: Include alloca.h for alloca prototype.

2000-04-25  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/sparc/sparc64/elf/Dist: Remove.
	* sysdeps/sparc/sparc64/elf/crtbegin.S: Remove.
	* sysdeps/sparc/sparc64/elf/crtbeginS.S: Remove.
	* sysdeps/sparc/sparc64/elf/crtend.S: Remove.
	* sysdeps/sparc/sparc64/elf/crtendS.S: Remove.
	* sysdeps/sparc/sparc64/elf/Makefile: Don't build crtbegin/crtend
	objects.

2000-04-25  Thorsten Kukuk  <kukuk@suse.de>

	* nscd/grpcache.c: Fix gr_name pointer [PR/1702].

2000-04-23  Bruno Haible  <haible@clisp.cons.org>

	* intl/dcigettext.c: Define _GNU_SOURCE as early as possible.
	* intl/l10nflist.c: Likewise.

2000-04-23  Bruno Haible  <haible@clisp.cons.org>

	* intl/bindtextdom.c [!_LIBC]: Define __libc_rwlock_define,
	__libc_rwlock_wrlock, __libc_rwlock_unlock as empty.
	* intl/textdomain.c [!_LIBC]: Likewise.
	* intl/dcigettext.c [!_LIBC]: Define __libc_rwlock_define_initialized,
	__libc_rwlock_rdlock, __libc_rwlock_unlock as empty.
	* intl/loadmsgcat.c (_nl_load_domain) [!_LIBC, !HAVE_ICONV]: Avoid
	syntax error.

2000-04-23  Bruno Haible  <haible@clisp.cons.org>

	* intl/dcigettext.c (_nl_find_msg): Do the plural treatment and
	character set conversion also in the case the translation was found
	after a hash collision or through binary search.  Store the maximum
	index together with the converted message.  Use iconv() when available.
	In case of out of memory during conversion, return the unconverted
	translated string, not NULL.

2000-04-25  Jes Sorensen  <Jes.Sorensen@cern.ch>

	* shlib-versions: Rename ia64 dynamic linker to ld-linux-ia64.so.1
	to avoid name clashes with the ia32 linker.

2000-04-25  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/alpha/dl-machine.h (_dl_start_user): Fix the _dl_skip_args
	handling.

2000-04-27  Ulrich Drepper  <drepper@redhat.com>

	* manual/string.texi: Document strcasestr, strchrnul, strtoimax,
	strtoumax, strfry, and memfrob.
	* manual/arith.texi: Document {,u}int*_t types, and strto{i,u}max.
	Patch by Bryan Henderson <bryanh@giraffe-data.com>.

	* elf/soinit.c (__libc_global_ctors): Call __pthread_initialize_minimal
	if this function is available.

	* sysdeps/i386/i486/atomicity.h (exchange_and_add): Use uint32_t for
	all values.

2000-04-27  Jakub Jelinek  <jakub@redhat.com>

	* nss/getXXbyYY_r.c: Fix a typo in __old_getxxbyyy_r versioning.

2000-04-27  Ulrich Drepper  <drepper@redhat.com>

	* localedata/Makefile (test-srcs); Add tst-mbswcs3.
	Add rule to build tst-mbswcs3 before running tst-mbswcs.sh.
	* localedata/tst-mbswcs.sh: Run tst-mbswcs3.
	* localedata/tst-mbswcs3.c: New file.

2000-04-26  Ulrich Drepper  <drepper@redhat.com>

	* wcsmbs/mbsnrtowcs.c: Correctly compute number of converted
	characters.  Don't handle incomplete characters as errors.
	* wcsmbs/mbsrtowcs.c: Don't handle incomplete characters as errors.
	* localedata/Makefile (test-srcs): Add tst-mbswcs2.
	Add rule to build tst-mbswcs2 before running tst-mbswcs.sh.
	* localedata/tst-mbswcs.sh: Run tst-mbswcs2.
	* localedata/tst-mbswcs2.c: New file.

	* iconv/gconv_simple.c (utf8_internal_loop): Correctly reconstruct
	stored character in state in UNPACK_BYTES macro.
	* iconv/loop.c (SINGLE(LOOPFCT)): Make it actually work.  Correct
	test for available characters, handle result of BODY code correctly.
	* localedata/Makefile (test-srcs): Add tst-mbswcs1.
	(distribute): Add tst-mbswcs.sh.
	Add rule to run tst-mbswcs.sh.
	* localedata/tst-mbswcs.sh: New file.
	* localedata/tst-mbswcs1.c: New file.

2000-04-26  Jakub Jelinek  <jakub@redhat.com>

	* nis/nis_callback.c (__nis_create_callback): Do failed memory
	allocation fixups centrally, fix __builtin_expect call, return NULL
	on failure, not NIS_NOMEMORY.

2000-04-27  Bruno Haible  <haible@clisp.cons.org>

	* intl/ngettext.c [!_LIBC]: Fix definition of NGETTEXT.

	* intl/loadinfo.h (internal_function): Define if not already defined.

2000-04-27  Andreas Jaeger  <aj@suse.de>

	* intl/libintl.h: Fix typo, reported by Bruno Haible
	<haible@clisp.cons.org>.

2000-04-25  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-profile.c (_dl_mcount): Try to be thread-safe while not
	setting the state to GMON_PROF_BUSY.

2000-04-24  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-profile.c (_dl_start_profile): define all variables which
	do not have to be global as local variables.

	* nis/nis_callback.c (__nis_create_callback): Partially undo last
	patch.  Keep needed tests for failed memory allocation.

	* elf/dl-reloc.c (_dl_relocate_object): Add one more
	__builtin_expect saying that we don't normally expect to profile.

	* sysdeps/i386/dl-machine.h (elf_machine_rel): Add
	__builtin_expect where desirable.

2000-04-23  Ulrich Drepper  <drepper@redhat.com>

	* manual/Makefile (chapters): Add syslog.
	* manual/syslog.texi: New file.
	* manual/math.texi: Fix references.
	* manual/terminal.texi: Likewise.
	Patch by Bryan Henderson <bryanh@giraffe-data.com>.

2000-04-18  Jakub Jelinek  <jakub@redhat.com>

	* posix/sys/wait.h: Define __WAIT_STATUS and the like either if
	stdlib.h was not included or __USE_XOPEN not defined.

2000-04-23  Ulrich Drepper  <drepper@redhat.com>

	* nss/Makefile (libnss_db-dbs): Remove stray backslash.
	Patch by Zack Weinberg <zack@wolery.cumb.org>.

2000-04-22  Ulrich Drepper  <drepper@redhat.com>

	* manual/examples/subopt.c (mount_opts): Add missing terminating
	entry.
	Reported by Michael Deutschmann <michael@talamasca.ocis.net>.

	* assert/assert-perr.c: Include <stdlib.h> for abort prototype.
	* libio/ftello.c: Likewise.
	* libio/ftello64.c: Likewise.
	* libio/ioftell.c: Likewise.
	* sysdeps/generic/memrchr.c: Likewise.
	* sysdeps/posix/libc_fatal.c: Likewise.
	* sysdeps/unix/sysv/linux/init-first.c: Likewise.
	* misc/fstab.c: Include <string.h> for strcmp prototype.
	* sysdeps/generic/ldsodefs.h: Likewise.
	* sysdeps/unix/sysv/linux/i386/sigaction.c: Likewise.
	Patch by Kurt Roeckx <Q@ping.be>.

	* nss/Makefile (libnss_db-dbs): Renamed from libnss_db-routines.
	Remove db-open.  Change all uses.
	(libnss_db-routines): Define as $(libnss_db-dbs) db-open.

2000-04-21  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/alpha/msgctl.c (__syscall_msgctl): Declare.
	* sysdeps/unix/sysv/linux/alpha/semctl.c (__syscall_semctl): Declare.
	* sysdeps/unix/sysv/linux/alpha/shmctl.c (__syscall_shmctl): Declare.
	* sysdeps/unix/sysv/linux/alpha/getrusage.S: Surround uses of $f28
	with .set noat/at to shut up warnings.
	* sysdeps/unix/sysv/linux/alpha/syscalls.list (__fstatfs64): Add alias.
	* sysdeps/unix/sysv/linux/alpha/ioperm.c (init_iosys): Allow
	compilation if __NR_pciconfig_iobase is not defined.
	* sysdeps/unix/sysv/linux/sparc/sparc64/syscalls.list (__fstatfs64):
	Add alias.

2000-04-21  Ulrich Drepper  <drepper@redhat.com>

	* manual/sysinfo.texi: Fix typo.
	* manual/time.texi: Document timelocal, timegm, adjtimex, and stime.
	Replace "high precision time" with "high accuracy clock".
	Fix language.
	Patches by Bryan Henderson <bryanh@giraffe-data.com>.

	* nis/nis_findserv.c (__nis_findfastest): Improve memory handling.
	* nis/nis_print_group_entry.c (nis_print_group_entry): Use alloca
	instead of malloc.
	* nis/nis_subr.c: Use __builtin_expect.
	* nis/ypclnt.c: Likewise.
	* nis/nis_getservlist.c: Likewise.
	* nis/nis_creategroup.c: Likewise.

	* nis/nis_callback.c (__nis_create_callback): Check result of
	memory allocation.  Fix memory leaks.  Use __builtin_expect.
	(__nis_destroy_callback): Fix memory leaks.

2000-04-21  Andreas Jaeger  <aj@suse.de>

	* sysdeps/mips/elf/start.S: Use __PIC__ instead of PIC.
	* sysdeps/mips/mips64/add_n.S: Likewise.
	* sysdeps/mips/mips64/bsd-_setjmp.S: Likewise.
	* sysdeps/mips/mips64/lshift.S: Likewise.
	* sysdeps/mips/mips64/mul_1.S: Likewise.
	* sysdeps/mips/mips64/rshift.S: Likewise.
	* sysdeps/mips/mips64/setjmp.S: Likewise.
	* sysdeps/mips/mips64/sub_n.S: Likewise.
	* sysdeps/mips/mips64/submul_1.S: Likewise
	* sysdeps/unix/mips/sysdep.S: Likewise.

	* sysdeps/mips/dl-machine.h (elf_machine_got_rel): Remove strtab
	and update comment.  The strtab from _dl_relocate_object can be
	used.

2000-04-21  Ulrich Drepper  <drepper@redhat.com>

	* iconv/iconv.c (iconv): Add __builtin_expect where useful.
	* iconv/iconv_close.c (iconv_close): Likewise.
	* iconv/iconv_open.c (iconv_open): Likewise.

	* grp/putgrent.c (putgrent): Unlock steam if fprintf failed.  Add
	__builtin_expect where useful.

	* grp/initgroups.c (initgroups): Test for result of memory
	allocation and punt if it fails.

	* dirent/scandir.c (scandir): Add __builtin_expect where useful.
	* grp/fgetgrent.c (fgetfrent): Likewise.
	* grp/fgetgrent_r.c (__fgetgrent_r): Likewise.

2000-04-21  Jakub Jelinek  <jakub@redhat.com>

	* libio/vasprintf.c: Include string.h to get memcpy prototype.

2000-04-20  Ulrich Drepper  <drepper@redhat.com>

	* wcsmbs/wcsrtombs.c (__wcsrtombs): If output buffer is too small
	don't search for NUL byte to decrement counter.
	Reported by Ulrich.Brink@sap.com.

	* iconv/gconv_simple.c: Define separate functions to convert from
	UCS4/UCS4-LE to the internal encoding.
	* iconv/gconv_builtin.h: Use separate functions to convert from
	UCS4/UCS4-LE to the internal encoding.
	* iconv/gconv_int.h: Declare __gconv_transform_ucs4_internal and
	__gconv_transform_ucs4le_internal.

	* iconv/gconv_simple.c (internal_utf8_loop): Correct check for
	output buffer overflow.  Reported by Ulrich.Brink@sap.com.

	* iconv/skeleton.c: Add some more __builtin_expect.
	* iconv/loop.c: Likewise.

2000-03-08  H.J. Lu  <hjl@gnu.org>

	* posix/regex.c (regex_compile): Correctly handle "\{" when
	the RE_INTERVALS is set and the RE_NO_BK_BRACES bit is not set.

2000-04-20  Ulrich Drepper  <drepper@redhat.com>

	* manual/stdio.texi: Give advise about handling error when using
	stream functions.
	Patch by Michael Deutschmann <michael@talamasca.ocis.net>.

2000-04-19  Jakub Jelinek  <jakub@redhat.com>

	* locale/programs/ld-ctype.c (ctype_output): Set size of the idx
	field to nelems * sizeof (uint32_t).
	* locale/programs/ld-address.c (address_output): Align word fields
	properly.
	* locale/programs/ld-monetary.c (monetary_output): Likewise.
	Don't restart idx pointers to idx end at the duo_int_curr_symbol
	field.
	Avoid giving arbitrary garbage in the crncystr field.
	Use sizeof(uint32_t) instead of 4 for len in uno_valid_from,
	uno_valid_to, duo_valid_from, duo_valid_to and conversion_rate
	fields.
	* locale/programs/ld-numeric.c (numeric_output): Likewise.
	Don't restart idx pointers to idx end at the decimal_point_wc field.
	* locale/programs/ld-time.c (time_output): week_1stday should be
	word, not byte.  Align it properly.

2000-04-19  H.J. Lu  <hjl@gnu.org>

	* csu/gmon-start.c (_start): Declared as "extern void".
	(etext): Likewise.

2000-04-18  Andreas Jaeger  <aj@suse.de>

	* manual/install.texi (Running make install): Don't mention utmpd
	anymore.

2000-04-18  Andreas Jaeger  <aj@suse.de>

	* linuxthreads/Versions: Use ld instead of ld.so.

	* elf/Makefile (ld-map): Use ld.map.

	* Versions.def: Use ld instead of ld.so.
	* elf/Versions: Likewise.
	* sysdeps/mach/hurd/Versions: Likewise.

2000-04-20  Andreas Jaeger  <aj@suse.de>

	* elf/rtld.c (print_statistics): Move ifndef further up.
	(_dl_start_final): Added HP_TIMINIG_NONAVAIL to avoid warnings.
	(dl_main): Likewise.

2000-04-18  Ulrich Drepper  <drepper@redhat.com>

	* gmon/gmon.c: Add weak alias moncontrol for __moncontrol.
	* gmon/Versions: Move moncontrol to GLIBC_2.2.

	* po/cs.po: Update from translation team.

	* sysdeps/generic/updwtmp.c: Remove daemon support.

	* login/Makefile (routines): Remove utmp_daemon.

	* sysdeps/unix/sysv/aix/gethostname.c: Fix type of len argument.
	* sysdeps/unix/sysv/aix/access.c: Define ACC_INVOKER.
	* sysdeps/unix/sysv/aix/getegid.c: Define ID_EFFECTIVE.
	* sysdeps/unix/sysv/aix/geteuid.c: Likewise.

	* elf/rtld.c: Display statitics option also if hp timing is not
	available.

	* login/programs/connection.c: Removed.
	* login/programs/database.c Removed.
	* login/programs/error.c: Removed.
	* login/programs/request.c: Removed.
	* login/programs/xtmp.c: Removed.
	* login/programs/xtmp.h: Removed.
	* login/Makefile: Remove rules for utmpd.
	* login/README.utmpd: Removed.
	* login/utmp_daemon.c: Removed.
	* login/getutent_r.c: Remove references to daemon functions.
	* login/utmp-private.h (__libc_utmp_daemon_functions): Remove
	declaration.

2000-04-18  Andreas Jaeger  <aj@suse.de>

	* shlib-versions (mips.*-.*-linux.*): Support only GLIBC 2.0 and
	2.2 for libnsl, libresolv, librt, libnss_*.

	* elf/rtld.c (process_dl_debug): Remove obsolete comment.

	* sysdeps/mips/dl-machine.h (elf_machine_rel): Fix relocation.

2000-04-18  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/aix/geteuid.c: Don't try to include <sys/id.h>.
	* sysdeps/unix/sysv/aix/getegid.c: Likewise.
	* sysdeps/unix/sysv/aix/xstat64.c: Define STX_NORMAL and STX_64.
	* sysdeps/unix/sysv/aix/xstat.c: Define STX_NORMAL.
	* sysdeps/unix/sysv/aix/sys/param.h: Define NGROUPS.
	* sysdeps/unix/sysv/aix/setreuid.c: Define ID_EFFECTIVE and ID_REAL.
	* sysdeps/unix/sysv/aix/setregid.c: Likewise.
	* sysdeps/unix/sysv/aix/setuid.c: Define ID_REAL.
	* sysdeps/unix/sysv/aix/setgid.c: Likewise.
	* sysdeps/unix/sysv/aix/seteuid.c: Define ID_EFFECTIVE.
	* sysdeps/unix/sysv/aix/setegid.c: Likewise.
	* sysdeps/unix/sysv/aix/sbrk.c: Update parameter type.
	* sysdeps/unix/sysv/aix/nanosleep.c (struct timestruc_t): Define
	it here.
	* sysdeps/unix/sysv/aix/msync.c: New file.
	* sysdeps/unix/sysv/aix/msgsnd.c: New file.
	* sysdeps/unix/sysv/aix/net/if.h: New file.
	* sysdeps/unix/sysv/aix/pipe.c: New file.
	* sysdeps/unix/sysv/aix/poll.c: New file.
	* sysdeps/unix/sysv/aix/rename.c: New file.
	* sysdeps/unix/sysv/aix/rmdir.c: New file.
	* sysdeps/unix/sysv/aix/select.c: New file.
	* sysdeps/unix/sysv/aix/semctl.c: New file.
	* sysdeps/unix/sysv/aix/semget.c: New file.
	* sysdeps/unix/sysv/aix/semop.c: New file.
	* sysdeps/unix/sysv/aix/sendto.c: New file.
	* sysdeps/unix/sysv/aix/setgroups.c: New file.
	* sysdeps/unix/sysv/aix/setpgid.c: New file.
	* sysdeps/unix/sysv/aix/setpgrp.c: New file.
	* sysdeps/unix/sysv/aix/setpriority.c: New file.
	* sysdeps/unix/sysv/aix/setrlimit.c: New file.
	* sysdeps/unix/sysv/aix/setrlimit64.c: New file.
	* sysdeps/unix/sysv/aix/setsid.c: New file.
	* sysdeps/unix/sysv/aix/setsockopt.c: New file.
	* sysdeps/unix/sysv/aix/shmat.c: New file.
	* sysdeps/unix/sysv/aix/shmctl.c: New file.
	* sysdeps/unix/sysv/aix/shmdt.c: New file.
	* sysdeps/unix/sysv/aix/shmget.c: New file.
	* sysdeps/unix/sysv/aix/sigaltstack.c: New file.
	* sysdeps/unix/sysv/aix/sigstack.c: New file.
	* sysdeps/unix/sysv/aix/socket.c: New file.
	* sysdeps/unix/sysv/aix/socketpair.c: New file.
	* sysdeps/unix/sysv/aix/speed.c: New file.
	* sysdeps/unix/sysv/aix/symlink.c: New file.
	* sysdeps/unix/sysv/aix/sync.c: New file.
	* sysdeps/unix/sysv/aix/tcgetattr.c: New file.
	* sysdeps/unix/sysv/aix/tcsetattr.c: New file.
	* sysdeps/unix/sysv/aix/times.c: New file.
	* sysdeps/unix/sysv/aix/ulimit.c: New file.
	* sysdeps/unix/sysv/aix/umask.c: New file.
	* sysdeps/unix/sysv/aix/unlink.c: New file.
	* sysdeps/unix/sysv/aix/ustat.c: New file.
	* sysdeps/unix/sysv/aix/utimes.c: New file.

2000-04-18  Andreas Jaeger  <aj@suse.de>

	* manual/startup.texi (Environment Access): Fix putenv prototype
	according to recent changes.
	Reported by Andries Brouwer <Andries.Brouwer@cwi.nl>, closes
	PR libc/1692.

	* elf/rtld.c (print_statistics): Added HP_TIMINIG_NONAVAIL where
	needed.

2000-04-18  Ulrich Drepper  <drepper@redhat.com>

	* posix/Makefile (tests): Add tst-getaddrinfo.
	* posix/tst-getaddrinfo.c: New file.

2000-04-17  Ulrich Drepper  <drepper@redhat.com>

	* manual/sysinfo.texi: Document that umount2 is not widely available.

	* sysdeps/generic/hp-timing.h (HP_TIMING_NONAVAIL): Define to
	signal timing is not really implemented.

2000-04-17  Andreas Jaeger  <aj@suse.de>

	* elf/rtld.c (process_dl_debug): Mention statistics in help message.

2000-04-17  Jakub Jelinek  <jakub@redhat.com>

	* Makefile (install): Use slibdir and libdir instead of inst_slibdir
	and inst_libdir.

2000-04-17  Ulrich Drepper  <drepper@redhat.com>

	* manual/intro.texi: Change reference from System Information to
	System Management.
	* manual/users.texi: Likewise.
	* manual/conf.texi: Likewise.
	* manual/sysinfo.texi: Document mount, umount, and umount2.
	Patch by Bryan Henderson <bryanh@giraffe-data.com>.

2000-04-17  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/ieee754/ldbl-128/printf_fphex.c (PRINT_FPHEX_LONG_DOUBLE):
	Create wnumstr as well as numstr to support wide character output
	correctly.

2000-04-15  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/sparc/sparc64/Makefile: Remove sysdep-CFLAGS
	modification and move it...
	* sysdeps/unix/sysv/linux/sparc/sparc64/Makefile: ...here.
	Add -melf64_sparc switch to $(LD) on sparc64-linux.
	* sysdeps/unix/sysv/linux/sparc/sparc32/Makefile: Add -melf32_sparc
	switch to $(LD) on sparc-linux.

2000-04-17  Thorsten Kukuk  <kukuk@suse.de>

	* sysdeps/unix/sysv/linux/sparc/sparc32/Makefile: Remove setresgid
	and setresuid from sysdep_routines.

2000-04-17  Ulrich Drepper  <drepper@redhat.com>

	* manual/Makefile (chapters): Add resource.

	* manual/time.texi: Move section on resources to...
	* manual/resource.texi: ...here.  New file.  Document ulimit, vlimit,
	and vtimes.
	* manual/setjmp.texi: Adjust back reference.
	Patch by Bryan Henderson <bryanh@giraffe-data.com>.

	* sysdeps/unix/sysv/aix/lxstat64.c: Uncomment STX_LINK and STX_64
	definition.
	* sysdeps/unix/sysv/aix/lxstat.c: Uncomment STX_LINK definition.
	* sysdeps/unix/sysv/aix/kill.c: Add copyright.
	* sysdeps/unix/sysv/aix/getuid.c: Define ID_REAL.
	* sysdeps/unix/sysv/aix/getgid.c: Define ID_REAL.
	* sysdeps/unix/sysv/aix/execve.c: Add copyright.
	* sysdeps/unix/sysv/aix/euidaccess.c: Add copyright.
	* sysdeps/unix/sysv/aix/close.c: Add copyright.
	* sysdeps/unix/sysv/aix/brk.c: Add copyright.
	* sysdeps/unix/sysv/aix/bits/errno.h: Add EAFNOSUPPORT.
	* sysdeps/unix/sysv/aix/access.c: Add copyright.
	* sysdeps/unix/sysv/aix/Makefile: Add some temporary definitions.
	* sysdeps/unix/sysv/aix/Implies: New file.
	* sysdeps/unix/sysv/aix/Versions: New file.
	* sysdeps/unix/sysv/aix/bind.c: New file.
	* sysdeps/unix/sysv/aix/bits/ioctl-types.h: New file.
	* sysdeps/unix/sysv/aix/bits/ioctls.h: New file.
	* sysdeps/unix/sysv/aix/bits/poll.h: New file.
	* sysdeps/unix/sysv/aix/bits/termios.h: New file.
	* sysdeps/unix/sysv/aix/chdir.c: New file.
	* sysdeps/unix/sysv/aix/chmod.c: New file.
	* sysdeps/unix/sysv/aix/chroot.c: New file.
	* sysdeps/unix/sysv/aix/creat.c: New file.
	* sysdeps/unix/sysv/aix/dl-close.c: New file.
	* sysdeps/unix/sysv/aix/dl-open.c: New file.
	* sysdeps/unix/sysv/aix/dl-sym.c: New file.
	* sysdeps/unix/sysv/aix/fchdir.c: New file.
	* sysdeps/unix/sysv/aix/fchmod.c: New file.
	* sysdeps/unix/sysv/aix/getgroups.c: New file.
	* sysdeps/unix/sysv/aix/gethostname.c: New file.
	* sysdeps/unix/sysv/aix/getpriority.c: New file.
	* sysdeps/unix/sysv/aix/getrlimit.c: New file.
	* sysdeps/unix/sysv/aix/getrlimit64.c: New file.
	* sysdeps/unix/sysv/aix/getrusage.c: New file.
	* sysdeps/unix/sysv/aix/link.c: New file.
	* sysdeps/unix/sysv/aix/madvise.c: New file.
	* sysdeps/unix/sysv/aix/mkdir.c: New file.
	* sysdeps/unix/sysv/aix/mknod.c: New file.
	* sysdeps/unix/sysv/aix/mprotect.c: New file.
	* sysdeps/unix/sysv/aix/msgctl.c: New file.
	* sysdeps/unix/sysv/aix/msgget.c: New file.
	* sysdeps/unix/sysv/aix/msgrcv.c: New file.

2000-04-17  Andreas Jaeger  <aj@suse.de>

	* sysdeps/mips/dl-machine.h (elf_machine_got_rel): Optimize a bit
	as suggested by Ulrich Drepper.
	(__dl_runtime_resolve): Remove unused variable, initialize sym
	directly.
	(RTLD_START): Document OFFSET_GP_GOT.
	(OFFSET_GP_GOT): New magic value.
	(elf_mips_got_from_gpreg): Use OFFSET_GP_GOT.
	(elf_machine_got_rel): Only declare strtab if needed.
	(elf_machine_relplt): Removed, it's not needed.
	(_dl_runtime_resolve): Fix \n for a comment, safe gp and not pc.

	* sysdeps/mips/add_n.S: Add newline at EOF.
	* sysdeps/mips/rshift.S: Likewise.
	* sysdeps/mips/mul_1.S: Likewise.
	* sysdeps/mips/lshift.S: Likewise.
	* sysdeps/mips/addmul_1.S: Likewise.

2000-04-17  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/powerpc/fpu/s_isnan.c: Pretty printing.

	* elf/dl-reloc.c (_dl_relocate_object): Add more __builtin_expect.
	* elf/dl-lookup.c: Likewise.
	* elf/dl-init.c (_dl_init): Likewise.
	* elf/dl-fini.c (_dl_fini): Likewise.
	* elf/dl-deps.c (_dl_map_object_deps): Likewise.
	* elf/dl-close.c (_dl_close): Likewise.
	* elf/rtld.c (_dl_start_final): Likewise.

	* elf/dl-lookup.c (add_dependency): Correct __builtin_expect use.

2000-04-15  Ulrich Drepper  <drepper@redhat.com>

	* csu/Makefile ($(objpfx)version-info.h): Get OS name from uname and
	only fall back on using Linux.

	* elf/dl-version.c (_dl_check_map_versions): New argument trace_mode.
	Before testing versions check that we actually loaded the object
	and whether we are in trace mode.  If not loaded during tracing don't
	test versions in this object.
	(_dl_check_all_versions): Take new parameter and pass to
	_dl_check_map_versions.
	* sysdeps/generic/ldsodefs.h: Update prototypes for
	_dl_check_all_versions and _dl_check_map_versions.
	* elf/rtld.c (struct version_check_args): Add dotrace.
	(version_check_doit): Pass args->dotrace to _dl_check_all_versions.
	(dl_main): Pass info about trace mode to version_check_doit.
	* elf/dl-open.c (dl_open_worker): Pass zero as new argument to
	_dl_check_all_versions.

	* manual/users.texi (XPG Functions): Document utmpxname, getutmp,
	and getutmpx.
	Patch by Bryan Henderson <bryanh@giraffe-data.com>.

	* manual/argp.texi: Document index parameter of argp_parse.
	Fix typo.
	Reported by Andrew Schulman <SCHULMAN.ANDREW@epamail.epa.gov>.

2000-04-14  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/shm_open.c: Include linux_fsinfo for
	SHMFS_SUPER_MAGIC.  Remove definition of SHMFS_SUPER_MAGIC.

	* sysdeps/unix/sysv/linux/linux_fsinfo.h (SHMFS_SUPER_MAGIC): Added.

2000-04-15  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/alpha/adjtime.c: Fix typo in
	compat_symbol call for old adjtime.

	* sysdeps/alpha/dl-machine.h (RTLD_START): Rewrite for new init
	function interface.  Patch by Richard Henderson <rth@cygnus.com>.

	* posix/Makefile (headers): Add spawn.h.
	(distribute): Add spawn_int.h.
	(routines): Add spawn_faction_init, spawn_faction_destroy,
	spawn_faction_addclose, spawn_faction_addopen, spawn_faction_adddup2,
	spawnattr_init, spawnattr_destroy, spawnattr_getdefault,
	spawnattr_setdefault, spawnattr_getflags, spawnattr_setflags,
	spawnattr_getpgroup, spawnattr_setpgroup, spawn, spawnp, and spawni.
	* posix/Versions [libc] (GLIBC_2.2): Add posix_spawn_file_actions_init,
	posix_spawn_file_actions_destroy, posix_spawn_file_actions_addclose,
	posix_spawn_file_actions_addopen, posix_spawn_file_actions_adddup2,
	posix_spawnattr_init, posix_spawnattr_destroy,
	posix_spawnattr_getdefault, posix_spawnattr_setdefault,
	posix_spawnattr_getflags, posix_spawnattr_setflags,
	posix_spawnattr_getpgroup, posix_spawnattr_setpgroup, posix_spawn,
	and posix_spawnp.
	* posix/spawn.c: New file.
	* posix/spawn.h: New file.
	* posix/spawn_faction_addclose.c: New file.
	* posix/spawn_faction_adddup2.c: New file.
	* posix/spawn_faction_addopen.c: New file.
	* posix/spawn_faction_destroy.c: New file.
	* posix/spawn_faction_init.c: New file.
	* posix/spawn_int.h: New file.
	* posix/spawnattr_destroy.c: New file.
	* posix/spawnattr_getdefault.c: New file.
	* posix/spawnattr_getflags.c: New file.
	* posix/spawnattr_getpgroup.c: New file.
	* posix/spawnattr_getschedparam.c: New file.
	* posix/spawnattr_getschedpolicy.c: New file.
	* posix/spawnattr_getsigmask.c: New file.
	* posix/spawnattr_init.c: New file.
	* posix/spawnattr_setdefault.c: New file.
	* posix/spawnattr_setflags.c: New file.
	* posix/spawnattr_setpgroup.c: New file.
	* posix/spawnattr_setschedparam.c: New file.
	* posix/spawnattr_setschedpolicy.c: New file.
	* posix/spawnattr_setsigmask.c: New file.
	* posix/spawni.c: New file.
	* posix/spawnp.c: New file.

	* sysdeps/mach/hurd/bits/posix_opt.h: Add _POSIX_SPAWN.
	* sysdeps/unix/sysv/linux/bits/posix_opt.h: Likewise.

2000-04-14  Ulrich Drepper  <drepper@redhat.com>

	* malloc/Versions [libc] (GLIBC_2.2): Add posix_memalign.
	* malloc/malloc.c: Implement posix_memalign for glibc.
	* include/stdlib.h: Add prototype for __posix_memalign.
	* stdlib/stdlib.h: Add prototype for posix_memalign.

2000-04-14  Andreas Jaeger  <aj@suse.de>

	* sysdeps/mips/dl-machine.h (elf_machine_got_rel): Initialize
	symidx correctly.
	(elf_machine_got_rel): Cast sym correctly.

	* sysdeps/mips/add_n.S: Use __PIC__, add end directive.
	* sysdeps/mips/addmul_1.S: Likewise.
	* sysdeps/mips/lshift.S: Likewise.
	* sysdeps/mips/mul_1.S: Likewise.
	* sysdeps/mips/rshift.S: Likewise.
	* sysdeps/mips/sub_n.S: Likewise.
	* sysdeps/mips/submul_1.S: Likewise.

	* stdlib/stdlib.h: Fix typo in comment.

	* shlib-versions (mips.*-.*-linux.*): Support only GLIBC 2.0 and
	2.2 for libdl, ld and libm.

	* sysdeps/generic/madvise.c: Fix typos.

	* sysdeps/unix/sysv/linux/mips/clone.S (error): Use __PIC__.

	* sysdeps/mips/bits/setjmp.h: Remove K&R compatibility.

	* sysdeps/mips/setjmp_aux.c (__sigsetjmp_aux): Silence gcc
	warnings.

2000-04-14  Ulrich Drepper  <drepper@redhat.com>

	* include/sys/statfs.h: Add prototypes for __statfs64 and __fstatfs64.
	* sysdeps/generic/fstatfs64.c (__fstatfs64): Renamed to fstatfs64.
	Make old name weak alias.
	* sysdeps/unix/sysv/linux/fstatfs64.c: Likewise.
	* sysdeps/generic/statfs64.c (__statfs64): Renamed to statfs64.
	Make old name weak alias.
	* sysdeps/unix/sysv/linux/statfs64.c: Likewise.

	* io/Makefile (routines): Add posix_fadvise, posix_fadvise64,
	posix_fallocate, and posix_fallocate64.
	* io/Versions [libc] (GLIBC_2.2): Add posix_fadvise, posix_fadvise64,
	posix_fallocate, and posix_fallocate64.
	* io/fcntl.h: Declare posix_fadvise, posix_fadvise64,
	posix_fallocate, and posix_fallocate64.
	* sysdeps/generic/fadvise.c: New file.
	* sysdeps/generic/fadvise64.c: New file.
	* sysdeps/generic/fallocate.c: New file.
	* sysdeps/generic/fallocate64.c: New file.
	* sysdeps/posix/fallocate.c: New file.
	* sysdeps/posix/fallocate64.c: New file.
	* sysdeps/generic/bits/fcntl.h: Define POSIX_FADV_NORMAL,
	POSIX_FADV_RANDOM, POSIX_FADV_SEQUENTIAL, POSIX_FADV_WILLNEED,
	POSIX_FADV_DONTNEED, and POSIX_FADV_NOREUSE.
	* sysdeps/mach/hurd/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/alpha/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/i386/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/mips/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/sparc/bits/fcntl.h: Likewise.

	* sysdeps/generic/madvise.c (__madvise): Renamed to posix_madvise.
	* sysdeps/unix/sysv/linux/syscalls.list: Likewise.

2000-04-13  Ulrich Drepper  <drepper@redhat.com>

	* misc/Versions [libc] (GLIBC_2.2): Add posix_madvice.
	* misc/sys/mman.h (posix_madvise): Add prototype.
	* sysdeps/generic/madvise.c (madvise): Renamed to __madvise.  Make
	old name and posix_madvise weak aliases.
	* sysdeps/unix/sysv/linux/syscalls.list: Likewise.
	* sysdeps/generic/bits/mman.h: Add POSIX_MADV_* constants.
	* sysdeps/unix/sysv/linux/alpha/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/arm/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/i386/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/sparc/bits/mman.h: Likewise.

2000-04-13  Andreas Jaeger  <aj@suse.de>

	* sysdeps/mips/dl-machine.h (__dl_runtime_resolve): Handle symbol
	versioning.
	(elf_machine_got_rel): Only add runtime display if needed.
	(elf_machine_got_rel): Handle symbol versioning.

2000-04-13  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/mips/clone.S: Fix function.

	* sysdeps/unix/mips/pipe.S: Reorder instructions since .reorder is
	default.

	* sysdeps/mips/__longjmp.c (__longjmp): Use $25 to fix problems
	with some applications.
	Patches by Ralf Baechle <ralf@uni-koblenz.de>.

	* sysdeps/mips/bsd-setjmp.S: Use __PIC__.
	* sysdeps/mips/bsd-_setjmp.S: Likewise.
	* sysdeps/mips/setjmp.S: Likewise.

	* sysdeps/unix/sysv/linux/mips/pipe.S: New file.

2000-04-13  Ulrich Drepper  <drepper@redhat.com>

	* posix/globtest.sh: Work around inconsistency with expanding ~/
	in shell (PR libc/1690).  Reported by patsmith@pobox.com.

2000-04-12  Ulrich Drepper  <drepper@redhat.com>

	* posix/getconf.c: Add support for many more POSIX options.
	* sysdeps/posix/sysconf.c: Likewise.
	* sysdeps/generic/bits/confname.h: Add many more POSIX options.
	* sysdeps/mach/hurd/bits/posix_opt.h: Add _POSIX_REGEXP and
	_POSIX_SHELL.
	* sysdeps/unix/sysv/linux/bits/posix_opt.h: Likewise.
	* sysdeps/unix/sysv/linux/i386/bits/time.h: Rename __CLOCK_HIGHRES to
	CLOCK_PROCESS_CPUTIME_ID.  Add define CLOCK_MONOTONIC and
	CLOCK_THREAD_CPUTIME_ID.
	* sysdeps/unix/i386/clock_getcpuclockid.c: Set *clock_id to
	CLOCK_PROCESS_CPUTIME_ID.
	* sysdeps/unix/i386/i586/clock_getres.c: Change for renaming of
	__CLOCK_HIGHRES to CLOCK_PROCESS_CPUTIME_ID.  Handle
	CLOCK_THREAD_CPUTIME_ID and CLOCK_MONOTONIC the same.
	* sysdeps/unix/i386/i586/clock_gettime.c: Likewise.

	* malloc/Makefile (tests): Add tst-calloc.
	* malloc/tst-calloc.c: New file.

	* sysdeps/arm/libm-test-ulps: New file.

	* malloc/malloc.c: Undo all of today's changes.

	* locale/programs/locale.c (show_info): Don't try to look into
	data for LC_ALL (there is none).

	* malloc/malloc.c (cALLOc): Clear only what the user asked for and
	avoid writing over boundary.
	Patch by Greg McGary <gkm@eng.ascend.com>.

	* sysdeps/arm/memprof.h: New file.

2000-04-12  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/i386/i586/clock_gettime.c: Fix typo.

	* sysdeps/unix/sysv/linux/i386/get_clockfreq.c: Include <string.h>
	for memmem declaration.

2000-04-12  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/clock_gettime.c (clock_gettime): Initialize retval
	to -1.
	* sysdeps/posix/clock_getres.c (clock_getres): Likewise.

	* libio/iopopen.c (_IO_new_proc_open): Close pipes in case the
	mode is invalid.
	* libio/oldiopopen.c (_IO_old_proc_open): Likewise.
	Patch by Bart Veer <bartv@redhat.com>.

	* sysdeps/arm/dl-machine.h (RTLD_START): Rewrite for new init
	function interface.

2000-04-11  Andreas Jaeger  <aj@suse.de>

	* sysdeps/mips/dl-machine.h: Update some comments.
	(ELF_MACHINE_ALIGN_MASK): Removed, it's not needed.

2000-04-11  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/bits/posix_opt.h: Add
	_POSIX_SHARED_MEMORY_OBJECTS.

	* rt/Makefile (tests): Add tst-shm.
	Add rules to generate tst-shm.
	* rt/tst-shm.c: New file.

	* sysdeps/unix/sysv/linux/shm_open.c (shm_open): Set FD_CLOEXEC
	for descriptor.

	* misc/sys/mman.h: Add prototypes for shm_open and shm_unlink.
	* rt/Makefile (librt-routines): Add shm_open and shm_unlink.
	* rt/Versions [librt] (GLIBC_2.2): Add shm_open and shm_unlink.
	* sysdeps/generic/shm_open.c: New file.
	* sysdeps/generic/shm_unlink.c: New file.
	* sysdeps/unix/sysv/linux/shm_open.c: New file.
	* sysdeps/unix/sysv/linux/shm_unlink.c: New file.
	* sysdeps/unix/sysv/linux/Versions [libc] (GLIBC_2.2): Export
	 __endmntent, __getmntent_r, __setmntent, and __statfs.

	* libio/vasprintf.c (_IO_vasprintf): Try to avoid memory
	fragmentation by allocating new memory at the end instead of
	reallocating.

	* posix/globtest.sh: Fix last change.

2000-04-10  Philip Blundell  <philb@gnu.org>

	* sysdeps/unix/sysv/linux/bits/in.h (IPV6_JOIN_GROUP,
	IPV6_LEAVE_GROUP): New names for IPV6_ADD_MEMBERSHIP,
	IPV6_DROP_MEMBERSHIP.
	* sysdeps/generic/bits/in.h (IPV6_JOIN_GROUP, IPV6_LEAVE_GROUP):
	Likewise.

2000-04-11  Ulrich Drepper  <drepper@redhat.com>

	* elf/readlib (process_file): Close streams in case of an error.

2000-04-09  Andreas Jaeger  <aj@suse.de>

	* elf/readlib.c (process_file): Check if file is big enough to
	contain aout and ELF headers.
	Reported by Reinhard Moosauer <RMoosauer@steinecker.com>.

2000-04-10  Jes Sorensen  <Jes.Sorensen@cern.ch>

	* elf/dl-fini.c: Include alloca.h to get proper prototype for alloca().

2000-04-11  Ulrich Drepper  <drepper@redhat.com>

	* test-skeleton.c (main): If STDOUT_UNBUFFERED is defined, make stdout
	stream unbuffered.
	* rt/Makefile (tests): Add tst-clock.
	Add rules to build tst-clock.
	* rt/tst-clock.c: New file.
	* sysdeps/unix/i386/i586/clock_getres.c: Correct expression to decide
	about initialization of nsec.
	* sysdeps/unix/i386/i586/clock_gettime.c: Correct expression to decide
	about initialization of freq.  Set retval to zero if successful.
	* sysdeps/unix/sysv/linux/i386/get_clockfreq.c: Cache result.

2000-04-10  Ulrich Drepper  <drepper@redhat.com>

	* Versions.def (librt): Add GLIBC_2.2.
	* rt/Makefile (librt-routines): Add get_clockfreq, clock_getcpuclockid,
	clock_getres, clock_gettime, clock_settime, timer_create, timer_delete,
	timer_getoverr, timer_gettime, and timer_settime.
	* rt/Versions [librt] (GLIBC_2.2): Add clock_getres, clock_gettime,
	clock_settime, timer_create, timer_delete, timer_getoverrun,
	timer_gettime, and timer_settime.
	* sysdeps/generic/clock_getcpuclockid.c: New file.
	* sysdeps/generic/get_clockfreq.c: New file.
	* sysdeps/unix/i386/clock_getcpuclockid.c: New file.
	* sysdeps/unix/sysv/linux/i386/get_clockfreq.c: New file.
	* sysdeps/mach/hurd/i386/bits/time.h: New file.
	* sysdeps/unix/i386/i586/clock_getres.c: New file.
	* sysdeps/unix/i386/i586/clock_gettime.c: New file.
	* sysdeps/unix/i386/i686/Implies: New file.
	* sysdpes/unix/sysv/linux/i386/bits/time.h: New file.
	* time/Makefile (routines): Move clock_getres, clock_gettime,
	clock_settime, timer_create, timer_delete, timer_getoverr,
	timer_gettime, and timer_settime to rt/Makefile.
	* time/Versions [libc] (GLIBC_2.2): Remove clock_getres, clock_gettime,
	clock_settime, timer_create, timer_delete, timer_getoverrun,
	timer_gettime, and timer_settime.
	* time/time.h: Define pid_t.  Add prototype for clock_getcpuclockid.

	* sysdeps/mach/hurd/bits/time.h: Drop K&R compatibility.  Use __const__
	and not const as attribute name.

2000-04-10  Thorsten Kukuk  <kukuk@suse.de>

	* elf/cache.c (save_cache): Make sure /etc/ld.so.cache is mode 644.

2000-04-10  Andreas Schwab  <schwab@suse.de>

	* posix/globtest.sh: Skip tests that depend on unreadable
	directories if run as root.

2000-04-10  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/clock_settime.c (clock_settime): Test tv_nsec value
	for correct range.  From code by Kaz Kylheku <kaz@ashi.footprints.net>.

2000-04-09  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/clock_gettime.c: New file.
	* sysdeps/unix/clock_settime.c: New file.
	* sysdeps/posix/clock_getres.c: New file.

	* conform/data/ftw.h-data: Add allow-header sys/stat.h.

	* sysdeps/unix/sysv/linux/getdents.c (__getdents): Avoid initial
	lseek call be passing in a buffer which never allow a successful
	first getdents syscall if not at leas the initial entry can be
	stored in the user buffer.

	* localedata/Makefile: Add rules to clean up directories created by
	new strfmon tests.

2000-04-09  Geoff Clare  <gwc@unisoft.com>

	* localedata/tst-fmon.data: Added new tests for strfmon()
	using test locales with all combinations of cs_precedes,
	sign_posn and sep_by_space.
	* localedata/tst-fmon.sh: Updated to support the new tests.
	* localedata/tst-fmon-locales/tstfmon_n01y12: New file containing
	the localedef source for the new strfmon() test locale.
	* localedata/tst-fmon-locales/tstfmon_n02n40: Likewise.
	* localedata/tst-fmon-locales/tstfmon_n10y31: Likewise.
	* localedata/tst-fmon-locales/tstfmon_n11y41: Likewise.
	* localedata/tst-fmon-locales/tstfmon_n12y11: Likewise.
	* localedata/tst-fmon-locales/tstfmon_n20n32: Likewise.
	* localedata/tst-fmon-locales/tstfmon_n30y20: Likewise.
	* localedata/tst-fmon-locales/tstfmon_n41n00: Likewise.
	* localedata/tst-fmon-locales/tstfmon_y01y10: Likewise.
	* localedata/tst-fmon-locales/tstfmon_y02n22: Likewise.
	* localedata/tst-fmon-locales/tstfmon_y22n42: Likewise.
	* localedata/tst-fmon-locales/tstfmon_y30y21: Likewise.
	* localedata/tst-fmon-locales/tstfmon_y32n31: Likewise.
	* localedata/tst-fmon-locales/tstfmon_y40y00: Likewise.
	* localedata/tst-fmon-locales/tstfmon_y42n21: Likewise.

	* stdlib/strfmon.c: Correct problems with missing or extra
	spaces for unusual combinations of sign_posn and sep_by_space.
	Improved left-precision alignment code.

2000-04-07  Andreas Jaeger  <aj@suse.de>

	* posix/Makefile (CFLAGS-regex.c): Remove DEBUG.

2000-04-10  Andreas Jaeger  <aj@suse.de>

	* intl/Makefile: Don't run do-gettext-test when cross-compiling.

2000-04-09  Ulrich Drepper  <drepper@redhat.com>

	Implement handling of restartable conversion functions according to
	ISO C.
	* iconv/gconv.h (__gconv_fct): Add additional parameter.
	* iconv/gconv_int.h (__BUILTIN_TRANS): Likewise.
	* iconv/gconv.c: Pass additional parameter to conversion function.
	* iconv/gconv_simple.c (internal_ucs4_loop_single): New function.
	(internal_ucs4le_loop_single): New function.
	(__gconv_transform_ascii_internal): Define ONE_DIRECTION.
	(__gconv_transform_internal_ascii): Likewise.
	(__gconv_transform_internal_utf8): Likewise.
	(__gconv_transform_utf8_internal): Likewise.
	(__gconv_transform_ucs2_internal): Likewise.
	(__gconv_transform_internal_ucs2): Likewise.
	(__gconv_transform_ucs2reverse_internal): Likewise.
	(__gconv_transform_internal_ucs2reverse): Likewise.
	(internal_ucs4le_loop_unaligned): Before return
	__GCONV_INCOMPLETE_INPUT check that the remaining bytes really form
	a valid character.  Otherwise return __GCONV_ILLEGAL_INPUT.
	(__gconv_transform_utf8_internal): Define STORE_REST and UNPACK_BYTES.
	* iconv/loop.c: Fit in definition of function to convert one character
	for processing of left-over bytes from the state object.
	* iconv/skeleton.c (gconv): Rename inbuf to inptrp and inbufend to
	inend to match names in loop functions.
	(RESET_INPUT_BUFFER): Change apprpriately.
	(gconv): If needed, call function to process bytes from the state
	object.  Similar at the end: store left over bytes if input is
	incomplete.
	Take extra argument and add new argument to all calls of the
	conversion function.
	* iconvdata/iso-2022-cn.c: Adjust numeric values used to store
	information in the state object to not conflict with length count.
	* iconvdata/iso-2022-jp.c: Likewise.
	* iconvdata/iso-2022-kr.c: Likewise.
	* iconvdata/unicode.c: Adjust for change change in parameters of
	skeleton function.
	* iconvdata/utf-16.c: Likewise.
	* libio/iofwide.c: Add new parameter to all calls of conversion
	function.
	* wcsmbs/btowc.c: Likewise.
	* wcsmbs/mbrtowc.c: Likewise.
	* wcsmbs/mbsnrtowcs.c: Likewise.
	* wcsmbs/mbsrtowcs.c: Likewise.
	* wcsmbs/wcrtomb.c: Likewise.
	* wcsmbs/wcsnrtombs.c: Likewise.
	* wcsmbs/wcsrtombs.c: Likewise.
	* wcsmbs/wctob.c: Likewise.

	* iconvdata/gbgbk.c: Always define MAX_NEEDED_OUTPUT and
	MAX_NEEDED_INPUT.

2000-04-07  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/mips/kernel_sigaction.h: Updated for
	newer kernels.

2000-04-07  Ulrich Drepper  <drepper@redhat.com>

	* wcsmbs/wchar.h (__mbstate_t): Rename elements.  Make __value
	element a union to allow byte access.
	* iconvdata/iso-2022-cn.c: Adjust for change of element name in
	mbstate_t.
	* iconvdata/iso-2022-jp.c: Likewise.
	* iconvdata/iso-2022-kr.c: Likewise.
	* wcsmbs/mbsinit.c: Likewise.
	* stdlib/mblen.c: Likewise.
	* stdio-common/printf-parse.h: Likewise.

2000-04-06  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/getdents.c (__getdents): The Linux
	kernel does not allow relative seeks on descriptors associated
	with directories.  Go back to get the position in the directory
	every time we enter the function.  Return -1 and set errno if one
	entry could be read from the kernel but does not fit into the
	buffer passed in by the user.

	* locale/programs/charmap.c (charmap_new_char): Add parameter step.
	Support ..(2).. ellipsis.
	(parse_charmap): Recognize ..(2).. etc and pass step down.
	Correctly generate names for UCS4 characters.

	* locale/programs/ld-ctype.c (struct translit_ignore_t): Add step.
	(ctype_finish): We know the wide character value for <SP>,
	don't search.
	(charclass_symbolic_ellipsis): Handle ..(2).. ellipsis.
	(charclass_ucs4_ellipsis): Likewise.
	(read_translit_ignore_entry): Store ellipsis step.
	(ctype_read): Recognize ..(2).. etc and pass step down.

	* locale/programs/linereader.c (lr_token): When seeing comment
	character ignore only rest of line in sources but stop at escaped
	newline.
	Recognize ..(2).. and ....(2).....

	* locale/programs/locfile-token.h (enum token_t): Add tok_ellipsis2_2
	and tok_ellipsis4_2.

2000-04-06  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/alpha/Dist: init-first.h has been
	removed, remove it here also.
	* sysdeps/unix/sysv/linux/arm/Dist: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/Dist: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc32/Dist: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/Dist: Likewise.

2000-04-06  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/sparc/sparc32/register-dump.h: Don't
	include bits/sigcontext.h.
	* sysdeps/unix/sysv/linux/sparc/sparc64/register-dump.h: Likewise.

2000-04-06  Ulrich Drepper  <drepper@redhat.com>

	* locale/programs/ld-collate.c (collate_read): Handle ellipsis in
	collation symbol definition.  Value in quivalence definition must
	be defined, don't check that it is not.

	* locale/programs/charmap.c (parse_charmap): Recognize <Uxxxx>
	values as character names.

	* locale/programs/ld-ctype.c (get_character): Handle missing
	repertoire map correctly.

2000-04-05  Cristian Gafton  <gafton@redhat.com>

	* ctype/ctype.h (__isctype_l): Define even if not __OPTIMIZE__
	because it is used in generic code.
	* wctype/wctrans.c: Define __ctype32_toupper and __ctype32_tolower.
	* wcsmbs/wcwidth.h: Declare __ctype32_b.
	* intl/gettext.c: Include <locale.h>.
	* intl/ngettext.c: Likewise.

2000-04-05  Jakub Jelinek  <jakub@redhat.com>

	* resolv/inet_ntop.c (inet_ntop4, inet_ntop6, inet_ntop): Use
	socklen_t type for size.
	* sysdeps/sparc/sparc32/dl-machine.h (RTLD_START): Rewrite for new
	init function interface.
	* sysdeps/sparc/sparc64/dl-machine.h (RTLD_START): Likewise.
	* sysdeps/unix/sysv/linux/sparc/bits/setjmp.h: Don't include
	sys/ucontext.h.
	(__jmp_buf): Declare the whole type structure here, don't use
	ucontext.

2000-04-05  Ulrich Drepper  <drepper@redhat.com>

	* iconv/skeleton.c (put16u): Fix typo.
	Reported by Bruno Haible <haible@ilog.fr>.

	* sysdeps/unix/sysv/linux/alpha/init-first.h: Not needed anymore.
	* sysdeps/unix/sysv/linux/arm/init-first.h: Likewise.
	* sysdeps/unix/sysv/linux/mips/init-first.h: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/init-first.h: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc32/init-first.h: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/init-first.h: Likewise.

	* sysdeps/unix/sysv/linux/Dist: Remove getresuid and getresgid.
	* Makefile (distribute): Add abi-versions.awk and
	firstversions.awk.
	Patches by Torsten Duwe <duwe@caldera.de>.

2000-04-05  Andreas Schwab  <schwab@suse.de>

	* nss/Makefile ($(objpfx)makedb): Move $(libdl) after db-open.o.

2000-04-05  Andreas Schwab  <schwab@suse.de>

	* sysdeps/m68k/dl-machine.h (RTLD_START): Readd _dl_start_user
	entry point, used on Hurd.

2000-04-04  Andreas Jaeger  <aj@suse.de>

	* intl/Makefile: Only run the gettext test with shared libraries.

2000-03-16  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/unix/sysv/linux/i386/sys/procfs.h (prfpregset_t):
	Typedef for elf_fpregset_t instead of `elf_fpregset_t *'.

2000-04-05  Roland McGrath  <roland@baalperazim.frob.com>

	* Makeconfig: Undo last change.
	* configure.in: If --disable-shared was given, don't set VERSIONING,
	don't define DO_VERSIONING, and don't give scare warning for no
	versioning.
	* configure: Regenerated.

2000-04-04  Roland McGrath  <roland@baalperazim.frob.com>

	* Makeconfig [$(build-shared) != yes] (versioning): Set to `no'.

2000-04-04  Andreas Jaeger  <aj@suse.de>

	* sysdeps/generic/fgetexcptflg.c: Use shlib-compat macros.

2000-04-04  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-runtime.c (fixup): Correct handling of symbols marked
	STV_HIDDEN and STV_INTERNAL during lookup.
	(profile_fixup): Likewise.
	* elf/dl-reloc.c (RESOLVE): Likewise.

	* iconv/skeleton.c (FUNCTION_NAME): Reorder initialization of
	unaligned so that it compiles for system which need unaligned
	access handling.

2000-04-04  Andreas Schwab  <schwab@suse.de>

	* elf/cache.c (print_entry): Only look at the type field when
	printing the type.

2000-04-04  Andreas Schwab  <schwab@suse.de>

	* iconvdata/big5.c (BODY): Fix typo.

2000-04-04  Andreas Schwab  <schwab@suse.de>

	* sysdeps/m68k/dl-machine.h (RTLD_START): Rewrite for new init
	function interface.  Remove unused _dl_start_user entry point.

2000-04-03  Andreas Jaeger  <aj@suse.de>

	* include/arpa/inet.h (__inet_aton): Add protoype.

2000-04-01  Andreas Jaeger  <aj@suse.de>

	* sysdeps/mach/hurd/mips/init-first.c: Use SHARED instead of PIC.

	* sysdeps/unix/mips/sysdep.h: Use __PIC__ instead of PIC.
	* sysdeps/mach/mips/thread_state.h: Likewise.

	* sysdeps/generic/fclrexcpt.c: Use shlib-compat macros.
	* sysdeps/generic/fegetenv.c: Likewise.
	* sysdeps/generic/fesetenv.c: Likewise.
	* sysdeps/generic/feupdateenv.c: Likewise.
	* sysdeps/generic/fraiseexcpt.c: Likewise.
	* sysdeps/generic/fsetexcptflg.c: Likewise.
	* sysdeps/unix/sysv/linux/alpha/glob.c: Likewise.
	* sysdeps/unix/sysv/linux/arm/errlist.c: Likewise.
	* sysdeps/unix/sysv/linux/errlist.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/chown.c: Likewise.

2000-04-02  H.J. Lu  <hjl@gnu.org>

	* elf/ldconfig.h (FLAG_IA64_LIB64): New. Defined.

2000-04-03  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-load.c (_dl_dst_substitute): Pretty print comment.
	(add_name_to_object): Add cast in malloc call.
	(fillin_rpath): Optimize loop to initialize ->status a bit.

	* sysdeps/i386/dl-machine.h: Undo last change.
	* sysdeps/mach/hurd/i386/dl-machine.h (RTLD_START_SPECIAL_INIT):
	Restore %edx register after call here.

	* sysdeps/arm/atomicity.h: New file.
	Contributed by Jesper Skov <jskov@redhat.com>.

2000-04-03  Roland McGrath  <roland@baalperazim.frob.com>

	* Makeconfig (preprocess-versions): Undo last change.
	Instead, pass -I$(common-objdir) -I$(..)include instead of $(CPPFLAGS).

	* sysdeps/mach/hurd/i386/init-first.c (init): Don't set __environ
	here, before we might move the stack.
	(posixland_init): Set __libc_argc, __libc_argc, and __environ here.
	(init1): And not here.

	* sysdeps/i386/dl-machine.h (RTLD_START): Fix code broken by last
	change, to restore argc value in call-clobbered register after
	RTLD_START_SPECIAL_INIT, which will contain a call.

	* elf/dl-deps.c (_dl_map_object_deps): Fix size calculations for
	allocating and initializing L->l_initfini.

	* resolv/Makefile (headers): Add bits/netdb.h, so it gets installed.

2000-04-03  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-load.c (_dl_init_paths): Use (void*) -1 to signal non-existing
	RUNPATH, RPATH, and LD_LIBRARY_PATH.
	(open_path): Change type of fourth parameter.  Make pointer to array
	of pointers.  Create variable dirs with original type.
	Track whether any directory for the object exists and if not,
	change *DIRSP to (void*) -1 to signal there is no such search path.
	(_dl_map_object): Change all calls of open_path.
	Rewrite decompose_rpath calls.

2000-03-31  Andreas Schwab  <schwab@suse.de>

	* string/strfry.c: Declare STATE as array of char instead of int
	and do not initialize it (done by initstate_r).  Pass correct
	size.

2000-04-03  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/generic/ldsodefs.h: Fix typo in comment.

	* sysdeps/i386/dl-machine.h (RTLD_START): Squeeze one more
	instruction out of the code.

2000-04-02  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-fini.c (_dl_fini): Increment j counter after swapping in
	element at this position.

	* elf/Versions [ld.so] (GLIBC_2.2): Export _dl_load_lock.
	* elf/link.h (struct link_map): Add l_reldepsmax, l_reldepsact, and
	l_reldeps elements.
	* elf/dl-lookup.c (add_dependency): New function.
	(_dl_lookup_symbol): Use it whenever symbol was found in a global,
	dynamically loaded object.
	(_dl_lookup_symbol_skip): Likewise.
	(_dl_lookup_versioned_symbol): Likewise.
	(_dl_lookup_versioned_symbol_skip): Likewise.
	* elf/dl-open.c: Don't define _dl_load_lock here...
	* elf/rtld.c: ...but here...
	* elf/dl-support.c: ...and here.
	* elf/dl-close.c (_dl_close): Close also dependent objects introduce
	through relocation.
	* elf/dl-fini.c (_dl_fini): Also take dependencies introduced through
	relocations.
	* dlfcn/Makefile (glrefmain.out): Test is not expected to fail
	anymore.
	* dlfcn/glrefmain.c: Add one more debug message.

	* Makeconfig (preprocess-versions): Don't add $(CPPFLAGS) to compiler
	command line.
	* Makerules (sysd-versions): Use ( ) instead of { }.

	* elf/dl-load.c: Use __builtin_expect to signal that compiler should
	optimize for the non-debugging case.
	* elf/dl-lookup.c: Likewise.
	* sysdeps/generic/libc-start.c: Likewise.

2000-04-02  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/mach/hurd/i386/init-first.c: Replace PIC #ifdefs with SHARED.
	(init1): Don't initialize __environ here, since init already does it.
	(first_init): New function, broken out of _init.
	(_hurd_stack_setup): Use it.
	[SHARED] (_dl_init_first): New function, renamed from old _init.
	(init1) [SHARED]: Don't call posixland_init here.
	(posixland_init): Take ENVP arg, so signature is usual for initializer.
	[SHARED] (_init): Define as alias for posixland_init.
	[! SHARED] (__libc_first_init): Define as alias for posixland_init.
	* sysdeps/i386/dl-machine.h (RTLD_START): Insert the macro
	RTLD_START_SPECIAL_INIT before calling initializers.
	(RTLD_START_SPECIAL_INIT): Define to empty if undefined.
	* sysdeps/mach/hurd/i386/dl-machine.h: New file.
	* sysdeps/mach/hurd/dl-sysdep.c (_dl_init_first): New weak function.
	* elf/Versions ({libc,ld.so}: GLIBC_2.2): Add _dl_init_first.

	* stdio-common/tmpfile.c [! USE_IN_LIBIO]: No alias needed,
	since we define the function with the name `tmpfile'.

	* mach/Versions: Define SHARED instead of PIC to affect shlib-compat.h.
	* hurd/Versions: Likewise.

2000-04-02  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-runtime.c (fixup): Fix typo in comment.

	* resolv/netdb.h (getnameinfo): All length parameters are of type
	socklen_t.
	* inet/getnameinfo.c: Likewise.

2000-04-01  Ulrich Drepper  <drepper@redhat.com>

	* posix/unistd.h (socklen_t): Define if it has not yet happened.
	(gethostname): Change type of second parameter to socklen_t.
	* include/unistd.h (__gethostname): Change type of second
	parameter to socklen_t.
	* sysdeps/generic/gethostname.c (__gethostname): Likewise.
	* sysdeps/mach/hurd/gethostname.c (__gethostname): Likewise.
	* sysdeps/unix/sysv/gethostname.c (__gethostname): Likewise.
	* sysdeps/unix/sysv/sysv4/solaris2/gethostname.c (__gethostname):
	Likewise.
	* sysdeps/unix/sysv/linux/gethostname.c: Removed.
	* sysdeps/generic/bits/socket.h: Use __socklen_t to define socklen_t.
	Allow definition elsewhere.
	* sysdeps/unix/sysv/aix/bits/socket.h: Likewise.
	* sysdeps/unix/sysv/linux/bits/socket.h: Likewise.
	* sysdeps/unix/sysv/linux/mips/bits/socket.h: Likewise.
	* sysdeps/generic/bits/types.h: Define __socklen_t.
	* sysdeps/unix/sysv/aix/bits/types.h: Likewise.
	* sysdeps/unix/sysv/hpux/bits/types.h: Likewise.
	* sysdeps/unix/sysv/linux/alpha/bits/types.h: Likewise.
	* sysdeps/unix/sysv/linux/bits/types.h: Likewise.
	* sysdeps/unix/sysv/linux/mips/bits/types.h: Likewise.
	* sysdeps/unix/sysv/linux/sparc/bits/types.h: Likewise.
	* sysdeps/unix/sysv/sysv4/solaris2/bits/types.h: Likewise.

	* inet/arpa/inet.h (inet_addr): Change return type to in_addr_t.
	(inet_lnaof): Likewise.
	(inet_netof): Likewise.
	(inet_network): Likewise.
	(inet_aton): Likewise.
	(inet_makeaddr): Change parameter types to in_addr_t.
	(inet_neta): Likewise.
	(inet_ntop): Change type of last parameter to socklen_t.
	(inet_aton): Only make available if __USE_MISC.
	(inet_neta): Likewise.
	(inet_net_ntop): Likewise.
	(inet_net_pton): Likewise.
	(inet_nsap_ntoa): Likewise.

	* inet/in.h: Define in_port_t type.
	Define in_addr_t type.
	(struct in_addr): Use in_addr_t in definition.
	(IN_CLASSA): Use cast to in_addr_t.
	(IN_CLASSB): Likewise.
	(IN_CLASSC): Likewise.
	(IN_CLASSD): Likewise.
	(IN_EXPERIMENTAL): Likewise.
	(IN_BADCLASS): Likewise.
	(INADDR_ANY): Likewise.
	(INADDR_BROADCAST): Likewise.
	(INADDR_NONE): Likewise.
	(INADDR_LOOPBACK): Likewise.
	(INADDR_UNSPEC_GROUP): Likewise.
	(INADDR_ALLHOSTS_GROUP): Likewise.
	(INADDR_ALLRTRS_GROUP): Likewise.
	(INADDR_MAX_LOCAL_GROUP): Likewise.
	(struct sockaddr_in): Use in_port_t for sin_port element.
	(struct sockaddr_in6): Use in_port_t for sin6_port element.
	Use uint8_t instead of u_int8_t.

	* resolv/inet_addr.c (inet_addr): Change return type to in_addr_t.
	Call __inet_aton instead of inet_aton.
	(__inet_aton): Renamed from inet_aton.  Add weak alias under old name.

	* resolv/netdb.h (gethostbyname2): Define only is __USE_MISC.
	(innetgr): Likewise.
	(struct addrinfo): Use socklen_t for ai_addrlen element.

	* sysdeps/unix/sysv/linux/bits/in.h (IPV6_MTU_DISCOVER, IPV6_MTU,
	IPV6_RECVERR): New defines.

	* include/netdb.h: Change type of first parameter of __getnetbyaddr_r.
	* inet/getnetbyad.c: Likewise.
	* inet/getnetbyad_r.c: Likewise.
	* nis/nss_nis/nis-network.c: Likewise.
	* nis/nssplus_nis/nisplus-network.c: Likewise.
	* nss/nss_files/files-network.c: Likewise.
	* resolv/netdb.h: Define uint32_t if not already happened.
	Include bits/netdb.h.  Remove definition of struct netent.
	Change type of first parameter of getnetbyaddr_r and getnetbyaddr.
	* sysdeps/generic/stdint.h: Allow definition of uint32_t elsewhere.
	* sysdeps/generic/bits/netdb.h: New file.
	* sysdeps/unix/sysv/linux/alpha/bits/netdb.h: New file.

	* dlfcn/Makefile (distribute): Add glreflib1.c and glreflib2.c.
	(tests): Add glrefmain.
	Add rules to build modules and run tests.  Ignore result of glrefmain
	for now since it fails.
	* dlfcn/glrefmain.c: New file.
	* dlfcn/glreflib1.c: New file.
	* dlfcn/glreflib2.c: New file.

	* test-skeleton.c: Include <string.h> for strsignal prototype.

	* locale/programs/ld-collate.c (check_duplicate): Allow repertoire
	to be missing.

	* sysdeps/unix/sysv/linux/init-first.c (init): Add code from
	former init-first.h.  Initialize __libc_multiple_libcs.

2000-03-31  Ulrich Drepper  <drepper@redhat.com>

	* iconv/skeleton.c: Define access macros with u suffix.  Adjust
	#if expression for use of unaligned function to the one used in
	the definition of these functions.
	* iconv/loop.c: Undefined `unaligned' before recursive inclusion.
	* iconv/gconv_simple.c (internal_ucs4_loop_unaligned): New function.
	(internal_ucs4le_loop_unaligned): New function.

	* elf/Makefile (distribute): Add dep1.c, dep2.c, dep3.c, and dep4.c.
	(tests): Add order.
	(module-names): Add dep1, dep2, dep3, and dep4.
	Add dependencies for dep* modules and order.
	Define rule for order.out which checks the result.
	* elf/dep1.c: New file.
	* elf/dep2.c: New file.
	* elf/dep3.c: New file.
	* elf/dep4.c: New file.
	* elf/order.c: New file.

	* elf/dl-init.c: Fix typo in comment.

2000-03-31  Andreas Jaeger  <aj@suse.de>

	* sysdeps/mips/dl-machine.h (RTLD_START): Rewritten to match new
	init function interface.
	* sysdeps/mips/mips64/dl-machine.h (RTLD_START): Likewise.

2000-03-31  Andreas Jaeger  <aj@suse.de>

	* sysdeps/mips/fpu/fgetexcptflg.c: Fix last patch to use #if.
	* sysdeps/mips/fpu/fegetenv.c: Likewise.
	* sysdeps/mips/fpu/feupdateenv.c: Likewise.
	* sysdeps/mips/fpu/fclrexcpt.c: Likewise.
	* sysdeps/mips/fpu/fesetenv.c: Likewise.

	* sysdeps/generic/ldsodefs.h: DT_INIT_ARRAY is not relocated
	anymore, update comment.

	* sysdeps/unix/sysv/linux/shmctl.c: Likewise.

	* sysdeps/unix/sysv/linux/semctl.c (struct __old_semid_ds): Remove
	SHLIB_COMPAT - the struct is always needed.

2000-03-31  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/i386/dl-machine.h (RTLD_START): Optimize for i686.
	* elf/dl-support.c: Define _dl_starting_up.

2000-03-30  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-init.c (_dl_init): Clear _dl_starting_up at end of function.
	* sysdeps/i386/dl-machine.h: Remove code to clear _dl_starting_up.

	* misc/sys/cdefs.h: Don't allow gcc in traditional mode to be used.

	* elf/Makefile (dl-routines): Remove preinit.
	* elf/Versions: Remove _dl_preinit.
	* elf/dl-preinit.c: Removed.  Move content into...
	* elf/dl-init.c: ...here.
	* sysdeps/i386/dl-machine.h (RTLD_START): Remove call to _dl_preinit.

	* sysdeps/generic/bits/shm.h (struct shmid_ds): Correct names of
	elements.

2000-03-29  Geoff Clare  <gwc@unisoft.com>

	* stdlib/strfmon.c: Corrected problems with the code that
	sets default values for [np]_sep_by_space and
	[np]_sign_posn; also the new positive/negative alignment
	code from the previous patch was not quite right for
	[np]_sign_posn = 0.

	* localedata/tst-fmon.data: Changes corresponding to the
	two sets of fixes made to stdlib/strfmon.c.

2000-03-29  Jes Sorensen  <jes@pcatls01.cern.ch>

	* malloc/malloc.c: Declare bit flags UL so that they will not
	default to int size when being inverted.

2000-03-29  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/arm/errlist.c: Use shlib-compat macros.
	* sysdeps/unix/sysv/linux/arm/siglist.c: Likewise.

2000-03-29  Andreas Jaeger  <aj@suse.de>,
	    Ralf Baechle <ralf@uni-koblenz.de>

	* Makeconfig: Introduce new variable SHARED to mark code used in
	the shared library.
	* elf/dl-close.c: Use it instead of PIC.
	* elf/dl-load.c: Likewise.
	* elf/dl-open.c: Likewise.
	* hurd/geteuids.c: Likewise.
	* include/libc-symbols.h: Likewise.
	* include/shlib-compat.h: Likewise.
	* libio/freopen.c: Likewise.
	* linuxthreads/cancel.c: Likewise.
	* linuxthreads/pthread.c: Likewise.
	* linuxthreads/wrapsyscall.c: Likewise.
	* nss/nsswitch.c: Likewise.
	* stdio-common/vfprintf.c: Likewise.
	* sysdeps/arm/init-first.c: Likewise.
	* sysdeps/i386/init-first.c: Likewise
	* sysdeps/generic/init-first.c: Likewise.
	* sysdeps/generic/libc-start.c: Likewise.
	* sysdeps/mips/init-first.c: Likewise.
	* sysdeps/powerpc/elf/libc-start.c: Likewise.
	* sysdeps/unix/sysv/linux/init-first.c: Likewise.
	* sysdeps/unix/sysv/linux/arm/siglist.c: Likewise.
	* sysdeps/unix/sysv/linux/arm/errlist.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/chown.c: Likewise.

	* sysdeps/mips/machine-gmon.h (asm): Use __PIC__ as check.

2000-03-29  Andreas Jaeger  <aj@suse.de>

	* sysdeps/sparc/sparc64/dl-machine.h (elf_machine_runtime_setup):
	Use D_PTR to access relocated entries in l_info.
	(elf_machine_rela): Likewise.

	* sysdeps/sparc/sparc32/dl-machine.h (elf_machine_runtime_setup):
	Likewise.
	(elf_machine_rela): Likewise.

	* sysdeps/powerpc/dl-machine.c (__elf_machine_runtime_setup):
	Likewise.
	(__elf_machine_fixup_plt): Likewise.
	(__process_machine_rela): Likewise.

	* sysdeps/m68k/dl-machine.h (elf_machine_runtime_setup): Likewise.
	(elf_machine_rela): Likewise.

	* sysdeps/arm/dl-machine.h (elf_machine_runtime_setup): Likewise.
	(elf_machine_rel): Likewise.

	* sysdeps/alpha/dl-machine.h (elf_machine_runtime_setup): Likewise.
	(elf_machine_fixup_plt): Likewise.
	(elf_machine_rela): Likewise.

2000-03-29  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/msgctl.c: Use shlib-compat macros.
	* sysdeps/unix/sysv/linux/semctl.c: Likewise.
	* sysdeps/unix/sysv/linux/shmctl.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/getrlimit.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/getrlimit64.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/msgctl.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/oldgetrlimit64.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/semctl.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/setrlimit.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/shmctl.c: Likewise.
	* sysdeps/unix/sysv/linux/alpha/msgctl.c: Likewise.
	* sysdeps/unix/sysv/linux/alpha/semctl.c: Likewise.
	* sysdeps/unix/sysv/linux/alpha/shmctl.c: Likewise.
	* sysdeps/unix/sysv/linux/alpha/adjtime.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/chown.c: Likewise.

	* sysdeps/unix/sysv/linux/alpha/oldglob.c: Use shlib-compat
	macros, remove K&R prototypes.

2000-03-30  Ulrich Drepper  <drepper@redhat.com>

	* posix/getopt.c (_getopt_internal): Return -1 if argc < 1.
	Reported by Andrew Wiseman <a.wiseman@bandc.dircon.co.uk>
	(PR libc/1677).

2000-03-30  Andreas Jaeger  <aj@suse.de>

	* misc/sys/cdefs.h: Remove K&R support.

2000-03-30  Ulrich Drepper  <drepper@redhat.com>

	* iconv/skeleton.c: Avoid compiling unaligned versions in some
	more cases.
	* iconv/loop.c: Likewise.

2000-03-29  Bruno Haible  <haible@clisp.cons.org>

	* iconv/loop.c (put16): Remove __const. Fix access index.
	(put32): Remove __const. Use uint32_t instead of uint16_t.
	* iconv/skeleton.c: Likewise.

2000-03-30  Roland McGrath  <roland@baalperazim.frob.com>

	* mach/Versions (libc: GLIBC_2.0)
	[SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_1)]: Conditionalize
	__vm_allocate on this.
	[SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_2)]: Conditionalize
	mutex- and spinlock-related symbols on this.
	[!SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_2)] (libc: HURD_CTHREADS_0.3):
	New version set.  Lock-related symbols go here instead in this case.
	* sysdeps/mach/hurd/Versions (libc: GLIBC_2.0): Remove
	_cthread_exit_routine, _cthread_init_routine, cthread_keycreate,
	cthread_getspecific, cthread_setspecific, __libc_getspecific.
	* hurd/Versions
	[SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_2)] (libc: GLIBC_2.0):
	Put them here instead.
	[!SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_2)] (libc: HURD_CTHREADS_0.3):
	New version set.  Those cthreads symbols go here instead in this case.
	* Versions.def (libc) [USE_IN_LIBIO]: Add HURD_CTHREADS_0.3 version.

2000-03-30  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-init.c (_dl_init): We don't need to call constructors
	recursively.  Fold _dl_init_rec in _dl_init and optimize a bit more.

	Implement dynamic determination of constructor/destructor order in
	the dynamic linker.
	* elf/Versions [ld.so] (GLIBC_2.0): Remove _dl_init_next.
	(GLIBC_2.2): Add _dl_init.
	* elf/dl-close.c: Also call all destructors in FINI_ARRAY.
	r_duplist is not anymore allocated separately.  l_initfini is and
	therefore free it if necessary.
	* elf/dl-deps.c: If a searchlist has to be allocated, put all in one
	malloc block.  Otherwise allocate l_initfini list only.
	Put dependencies for the object in l_initfini list.
	Sort dependencies for the object to be loaded topologically.
	* elf/dl-fini.c: Before running the destructors sort the topologically.
	* elf/dl-init.c (_dl_init): Renamed from _dl_init_next.  Rewrite to
	call constructors instead of iterating over the pointers.  Get list of
	objects for which to run constructors from l_initfini element. Accept
	argc, argv, and env as parameters and pass them to the constructors.
	* elf/ld-load.c (_dl_map_object_from_fd): Initialize l_ldnum member
	with size of dynamic section.
	* elf/dl-open.c (dl_open_worker): Only call _dl_init instead of
	_dl_init_next and calling constructors ourself.
	* elf/dl-preinit.c (_dl_preinit): Renamed from _dl_preinit_next.
	Take argc, argv, and env as parameters and pass them to the
	constructors.  Rewrite to call all constructors and not iterate over
	the pointers.
	* elf/dynamic-link.h: Don't relocate DT_FINI_ARRAY entry.  Don't
	precompute l_initcount and l_preinitcount.
	* elf/link.h (struct link_map): Add l_ldnum member.
	Make l_phdr_allocated part of the bitfield.  Remove l_runcount,
	l_initcount, and l_preinitcount.  Add l_initfini.
	* sysdeps/generic/ldsodefs.h: Replace _dl_init_next prototype with
	one for _dl_init.
	* sysdeps/i386/dl-machine (RTLD_START): Rewrite to match new init
	function interface.
	* sysdeps/unix/sysv/linux/init-first.h: Removed.
	* sysdeps/unix/sysv/linux/Dist: Delete file here as well.
	* sysdeps/unix/sysv/linux/init-first.c [PIC]: Don't use
	SYSDEP_CALL_INIT.  Make _init a strong alias of init.  The calling
	conventions now match.

	* sysdeps/generic/libc-start.c: Calling __libc_init_first has no
	effect for shared objects.  Don't emit message and call only for
	static library.

2000-03-29  Ulrich Drepper  <drepper@redhat.com>

	* iconvdata/testdata/CSA_Z243.4-1985-1..UCS-2BE: Renamed from
	CSA_Z243.4-1985-1..UCS2.
	* iconvdata/testdata/ISO-8859-10..UCS-2BE: Renamed from
	ISO-8859-10..UCS2.

2000-03-29  Andreas Jaeger  <aj@suse.de>

	* include/unistd.h: Remove duplicate entry for __rmdir.
	Remove declaration of __mkdir since __mkdir is declared in
	sys/stat.h.

	* manual/creature.texi (Feature Test Macros): Fix typo, reported
	by Michael Deutschmann <michael@talamasca.ocis.net>.

	* sysdeps/mips/fpu/fclrexcpt.c: Use shlib-compat macros.
	* sysdeps/mips/fpu/fegetenv.c: Likewise.
	* sysdeps/mips/fpu/fesetenv.c: Likewise.
	* sysdeps/mips/fpu/feupdateenv.c: Likewise.
	* sysdeps/mips/fpu/fgetexcptflg.c: Likewise.

2000-03-28  Andreas Jaeger  <aj@suse.de>

	* sysdeps/i386/fpu/bits/mathinline.h (__sincos): Remove redundant
	declaration, the prototype is defined via bits/mathcalls.h.
	(__sincosf): Likewise.
	(__sincosl): Likewise.
	(ldexp): Likewise.
	(ldexpf): Likewise.
	(ldexpl): Likewise.
	(__finite): Likewise.
	(__inline_mathcodeNP): New macro without prototype
	declarations.
	(__inline_mathcodeNP2): Likewise.
	(__inline_mathcodeNP3): Likewise.
	(__inline_mathcodeNP_): Likewise.
	(__inline_mathcodeNP2_): Likewise.
	(__inline_mathcodeNP3_): Likewise.
	(__inline_mathopNP): Likewise.
	(__inline_mathop_declNP): Likewise.
	(__inline_mathop_declNP_): Likewise.
	(__inline_mathcode_): Use __inline_mathcodeNP_.
	(__inline_mathcode2_): Use __inline_mathcodeNP2_.
	(__inline_mathcode3_): Use __inline_mathcodeNP3_.
	(__inline_mathop_decl_): Use __inline_mathop_declNP__.
	(__expm1l): Don't define prototype, the prototype is defined via
	bits/mathcalls.h.
	(exp): Likewise.
	(__expl): Likewise.
	(tan): Likewise.
	(atan2): Likewise.
	(__atan2l): Likewise.
	(fmod): Likewise.
	(pow): Likewise.
	(fabsf): Likewise.
	(fabsl): Likewise.
	(__fabsl): Likewise.
	(asin): Likewise.
	(acos): Likewise.
	(sinh): Likewise.
	(cosh): Likewise.
	(tanh): Likewise.
	(floor): Likewise.
	(ceil): Likewise.
	(expm1): Likewise.
	(log1p): Likewise.
	(asinh): Likewise.
	(acosh): Likewise.
	(atanh): Likewise.
	(hypot): Likewise.
	(logb): Likewise.
	(fma): Likewise.
	(drem): Likewise.
	(sqrt): Likewise.
	(__sqrtl): Likewise.
	(sin): Likewise.
	(cos): Likewise.
	(atan): Likewise.
	(log): Likewise.
	(log10): Likewise.
	(asinh): Likewise.
	(log2): Likewise.
	(rint): Likewise.

2000-03-28  Ulrich Drepper  <drepper@redhat.com>

	* Makerules: If make variable md5 is defined to yes after
	generating dependencies generate MD5 sum for the object.

	* iconv/gconv_builtin.h: Fix length in transformation definition
	for UNICODEBIG.

	* iconvdata/TESTS: Use UCS-2BE instead of UCS2.

	* iconv/loop.c: Define get16, get32, put16, and put32 macros to
	allow as well reading from/writing to unaligned addresses on machines
	which don't support this in hardware.  Use FCTNAME macro to define
	function name.  Include the file a second time for platforms which
	need special unaligned handling.
	* iconv/skeleton.c: Define get16u, get32u, put16u, and put32u macros
	to access potentially unaligned addresses.  These macros are intended
	to be used only outside the loops.
	(unaligned): New definition.  In case the machine can handle unaligned
	access define as zero.  Otherwise as a variable which is initialized
	as nonzero in case the buffer passed in at runtime is unaligned with
	respect to the character set encoding involved.
	Call aligned or unaligned looop functions according to unaligned
	variable.
	* iconvdata/8bit-gap.c: Use get16, get32, put16, and put32 instead
	of direct casting pointer to potentially handle unaligned memory
	accesses.
	* iconvdata/8bit-generic.c: Likewise.
	* iconvdata/ansi_x3.110.c: Likewise.
	* iconvdata/big5.c: Likewise.
	* iconvdata/euc-cn.c: Likewise.
	* iconvdata/euc-jp.c: Likewise.
	* iconvdata/euc-kr.c: Likewise.
	* iconvdata/euc-tw.c: Likewise.
	* iconvdata/gbk.c: Likewise.
	* iconvdata/iso-2022-cn.c: Likewise.
	* iconvdata/iso-2022-jp.c: Likewise.
	* iconvdata/iso-2022-kr.c: Likewise.
	* iconvdata/iso646.c: Likewise.
	* iconvdata/iso_6937-2.c: Likewise.
	* iconvdata/iso_6937.c: Likewise.
	* iconvdata/johab.c: Likewise.
	* iconvdata/sjis.c: Likewise.
	* iconvdata/t.61.c: Likewise.
	* iconvdata/uhc.c: Likewise.
	* iconvdata/unicode.c: Likewise.
	* iconvdata/utf-16.c: Likewise.

	* locale/programs/simple-hash.c: Little optimizations.  Remove K&R
	prototypes.

	* malloc/Versions [libc] (GLIBC_2.2): Add mcheck_check_all.
	* malloc/mcheck.c (mcheck_check_all): Renamed from check_all and made
	public.
	* malloc/mcheck.h (mcheck_check_all): Declare.

	* stdio-common/Makefile (tests): Add tst-obprintf.

2000-03-28  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/generic/bits/sigthread.h: Clean up conditionals.
	Declare pthread_sigmask.

	* csu/version.c: Add 2000 to copyright years.
	Remove Emacs local variables section.

2000-03-23  Bruno Haible  <haible@clisp.cons.org>

	* iconv/gconv_int.h (__gconv_transform_ucs2little_internal,
	__gconv_transform_internal_ucs2little): Remove declarations.
	* iconv/gconv_simple.c (__gconv_transform_ucs2_internal,
	__gconv_transform_internal_ucs2): Never	need to bswap_16.
	(__gconv_transform_ucs2reverse_internal,
	__gconv_transform_internal_ucs2reverse): Always need to bswap_16.

2000-03-27  Roland McGrath  <roland@baalperazim.frob.com>

	* include/shlib-compat.h (SHLIB_COMPAT): Make the test handle the
	obsoleting version not being defined at all, in which case the
	result is always true.

	* Makeconfig (preprocess-versions): New canned sequence for running
	cpp on shlib-versions and the like.
	(soversions.i): Use it.
	* Makerules (Versions.all, sysd-versions): Use it to preprocess the
	Versions.def and Versions files.

2000-03-27  Ulrich Drepper  <drepper@redhat.com>

	* stdio-common/tst-obprintf.c (main): Add another check to see
	obstack_printf handling all possible beginnings of the block
	inside an obstack chunk.

	* locale/programs/localedef.c: Use __malloc_initialize_hook to
	install mcheck handler.

	* libio/obprintf.c (_IO_obstack_vprintf): Fix one more memory
	handling problem.

2000-03-27  Roland McGrath  <roland@baalperazim.frob.com>

	* stdio-common/tmpfile.c: Use <shlib-compat.h> macros.

	* include/shlib-compat.h: Conditionalize <abi-versions.h> include
	on [HAVE_ELF && DO_VERSIONING].

2000-03-27  Ulrich Drepper  <drepper@redhat.com>

	* stdio-common/tst-obprintf.c: New file.

2000-03-26  Ulrich Drepper  <drepper@redhat.com>

	* libio/genops.c (_IO_default_xsputn): Little optimization.  Call
	_IO_OVERFLOW directly instead through __overflow.

	* locale/programs/localedef.c (construct_output_path): If path
	contains a / compute the end of the directory name correctly.

	* include/features.h: Undef and document __USE_XOPEN2K.

	* malloc/mcheck.c: Implement pedantic checking of all allocated blocks
	whenever a function is called.  Initiated by calling mcheck_pedantic
	instead of mcheck.
	* malloc/mcheck.h: Declare mcheck_pedantic.
	* malloc/Versions [libc] (GLIBC_2.2): Add mcheck_pedantic.
	* locale/programs/localdef.c: Use mcheck_pedantic instead of mcheck
	for now.

2000-03-26  Roland McGrath  <roland@baalperazim.frob.com>

	* dlfcn/dlopen.c: Use <shlib-compat.h> macros.
	* dlfcn/dlopenold.c: Likewise.
	* nss/getXXbyYY_r.c: Likewise.
	* nss/getXXent_r.c: Likewise.
	* hurd/hurdinit.c: Likewise.
	* hurd/compat-20.c: Likewise.
	* libio/oldiofopen.c: Likewise.
	* libio/oldiofclose.c: Likewise.
	* libio/oldiofdopen.c: Likewise.
	* libio/oldfileops.c: Likewise.
	* libio/oldstdfiles.c: Likewise.
	* libio/oldiofsetpos.c: Likewise.
	* libio/oldiofgetpos.c: Likewise.
	* libio/oldiofgetpos64.c: Likewise.
	* libio/oldiofsetpos64.c: Likewise.
	* libio/oldiopopen.c: Likewise.
	* libio/oldpclose.c: Likewise.
	* libio/oldtmpfile.c: Likewise.
	* libio/freopen.c (freopen): Likewise.
	* libio/iofclose.c (_IO_new_fclose): Likewise.

	* sysdeps/mach/sys/reboot.h: Include <features.h>.
	(reboot): Declare it.

	* libio/Makefile (headers): Add bits/stdio-lock.h here.

	* sysdeps/mach/hurd/bits/stdio-lock.h: New file.

	* include/shlib-compat.h: Include <abi-versions.h> unconditionally.

	* posix/unistd.h (intptr_t): Conditionalize on [__USE_MISC ||
	__USE_XOPEN_EXTENDED] rather than on [__USE_UNIX98].
	We need this for the sbrk decl, which can be included without Unix98.

2000-03-20  Richard Henderson  <rth@cygnus.com>

	* nis/nss_nis/nis-service.c (_nss_nis_getservbyport_r): Last
	argument to yperr2nss is an int, not size_t.
	* posix/regex.c (print_partial_compiled_pattern): Cast all
	ptrdiff_t to long for printing.
	(print_compiled_pattern): Use Z for printing size_t.
	* posix/testfnm.c (tests): Avoid trigraphs.
	* sysdeps/alpha/dl-machine.h (ELF_MACHINE_RUNTIME_TRAMPOLINE):
	Use a C comment, not an assembly comment.

	* sysdeps/unix/sysv/linux/alpha/msgctl.c: Clarify use
	of __ASSUME_32BITUIDS.

2000-03-26  Ulrich Drepper  <drepper@redhat.com>

	* libio/iofopncook.c: Remove K&R prototypes.

2000-03-26  Roland McGrath  <roland@baalperazim.frob.com>

	* hurd/hurdrlimit.c (init_rlimit): Give the RLIMIT_NOFILE soft limit
	an initial value of 1024 instead of RLIM_INFINITY.

	* Versions.def (libmachuser, libhurduser): Remove these sections,
	since these libraries do not presently use symbol versions.

	* sysdeps/mach/hurd/getdtsz.c (__getdtablesize): If the resource limit
	is RLIM_INFINITY, return -1 instead.

2000-03-24  Andreas Jaeger  <aj@suse.de>

	* Makefile (postclean): Added soversions.i.

2000-03-24  Scott Bambrough  <scottb@netwinder.org>

	* sysdeps/arm/fpu/fpu_control.h: Define _FPU_MASK_IM, _FPU_MASK_ZM,
	_FPU_MASK_OM, _FPU_MASK_UM, _FPU_MASK_PM, _FPU_MASK_DM, _FPU_DEFAULT,
	and _FPU_IEEE.  Change _FPU_RESERVED.

2000-03-24  Scott Bambrough  <scottb@netwinder.org>

	* sysdeps/unix/sysv/linux/arm/sys/ucontext.h: New file.

2000-03-24  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/posix/getaddrinfo.c: Include <net/if.h> for if_nametoindex.
	(gaih_inet): Remove unused duplicate variable.

	* inet/getnameinfo.c (getnameinfo): Use IFNAMSIZ, not MAXHOSTNAMELEN.
	Don't use __libc_sa_len, which only exists for Linux.  Just handle
	AF_INET and AF_INET6 directly as well as AF_LOCAL, since those are the
	only flavors supported by this function anyway.

2000-03-24  Geoff Clare  <gwc@unisoft.com>

	* stdlib/strfmon.c: Corrected problems with missing signs and
	missing or extra spaces; allow for sign strings longer than
	one character; add padding to ensure positive and negative
	formats are aligned when a left precision is used.

2000-03-26  Ulrich Drepper  <drepper@redhat.com>

	* stdlib/random_r.c (__setstate_r): Allow RNGs of type 4.
	Patch by John Mizel <John.Mizel@msdw.com>.

2000-03-25  Ulrich Drepper  <drepper@redhat.com>

	* manual/install.texi: Remove references to crypt add-on.

2000-03-25  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/mach/hurd/setrlimit.c (setrlimit): Go into a critical
	section while taking the _hurd_rlimit_lock.
	* sysdeps/mach/hurd/getrlimit.c (__getrlimit): Likewise.

2000-03-24  Roland McGrath  <roland@baalperazim.frob.com>

	* Makerules [$(cross-compiling) = yes] (symbolic-link-prog): Define
	using $(LN_S).

	* sysdeps/mach/hurd/if_index.c: New file.

	* sysdeps/unix/sysv/linux/net/if.h: Moved to ...
	* sysdeps/gnu/net/if.h: here.
	(_IOT_ifconf, _IOT_ifreq): Hurd ioctl type macros moved from ...
	* sysdeps/mach/hurd/net/if.h: ... here; this file now removed.
	* sysdeps/generic/net/if.h: New file.  Declares just the standard
	functions and `struct if_nameindex' type.
	* socket/Makefile (headers): Add net/if.h here.
	* sysdeps/unix/sysv/linux/Makefile (sysdep_headers): Not here.
	* sysdeps/mach/hurd/Dist: Remove it here.
	* sysdeps/unix/sysv/linux/Dist: And here.
	* sysdeps/generic/if_index.c: Include <net/if.h>.

2000-03-24  Andreas Jaeger  <aj@suse.de>

	* sysdeps/mips/dl-machine.h (__dl_runtime_resolve): Use D_PTR to
	access relocated entries in l_info.
	(elf_machine_got_rel): Likewise.
	(elf_machine_runtime_setup): Likewise.
	* sysdeps/mips/mips64/dl-machine.h (elf_machine_got_rel): Likewise.
	(elf_machine_runtime_setup): Likewise.
	(__dl_runtime_resolve): Likewise.

2000-03-23  Ulrich Drepper  <drepper@redhat.com>

	* resolv/netdb.h (SCOPE_DELIMITER): New definitions.
	* inet/netinet/in.h (struct sockaddr_in6): Add sin6_scope_id
	according to RFC 2553.
	* sysdeps/posix/getaddrinfo.c: Change to follow latest RFC draft.
	* inet/getnameinfo.c: Likewise.
	Patches by YOSHIFUJI Hideaki <yoshfuji@v6.linux.or.jp>.

2000-03-23  Bruno Haible  <haible@clisp.cons.org>

	* iconv/gconv_simple.c (internal_ucs4_loop, internal_ucs4le_loop):
	Remove no-op pointer increment.

2000-03-23  Andreas Jaeger  <aj@suse.de>

	* stdio-common/tst-cookie.c (cookieseek): Change prototype to
	follow change for libio.h from 2000-03-10.

2000-03-23  Andreas Jaeger  <aj@suse.de>

	* elf/dl-addr.c: Adjust include paths for ldsodefs location
	change.
	* elf/dl-debug.c: Likewise.
	* elf/dl-deps.c: Likewise.
	* elf/dl-error.c: Likewise.
	* elf/dl-fini.c: Likewise.
	* elf/dl-init.c: Likewise.
	* elf/dl-load.c: Likewise.
	* elf/dl-lookup.c: Likewise.
	* elf/dl-minimal.c: Likewise.
	* elf/dl-object.c: Likewise.
	* elf/dl-open.c: Likewise.
	* elf/dl-preinit.c: Likewise.
	* elf/dl-profile.c: Likewise.
	* elf/dl-profstub.c: Likewise.
	* elf/dl-reloc.c: Likewise.
	* elf/dl-runtime.c: Likewise.
	* elf/dl-support.c: Likewise.
	* elf/dl-symbol.c: Likewise.
	* elf/dl-version.c: Likewise.
	* elf/rtld.c: Likewise.
	* elf/sprof.c: Likewise.
	* sysdeps/generic/dl-cache.c: Likewise.
	* sysdeps/generic/dl-origin.c: Likewise.
	* sysdeps/generic/dl-sysdep.c: Likewise.
	* sysdeps/generic/elf/backtracesyms.c: Likewise.
	* sysdeps/generic/elf/backtracesymsfd.c: Likewise.
	* sysdeps/generic/libc-start.c: Likewise.
	* sysdeps/mach/hurd/dl-sysdep.c: Likewise.
	* sysdeps/powerpc/dl-machine.c: Likewise.
	* sysdeps/powerpc/elf/libc-start.c: Likewise.
	* sysdeps/sparc/sparc32/dl-machine.h: Likewise.
	* sysdeps/sparc/sparc64/dl-machine.h: Likewise.
	* sysdeps/unix/sysv/linux/dl-origin.c: Likewise.

	* elf/ldsodefs.h: Move file to ...
	* sysdeps/generic/ldsodefs.h: ... here.

	* sysdeps/generic/ldsodefs.h: Add definition for D_PTR.

	* sysdeps/mips/elf/ldsodefs.h: New file.

	* elf/dl-version.c (match_symbol): Use D_PTR to access relocated
	entries in l_info.
	(_dl_check_map_versions): Likewise.
	* elf/dl-reloc.c (_dl_relocate_object): Likewise.
	* elf/dl-load.c (_dl_init_paths): Likewise.
	(_dl_map_object): Likewise.
	* elf/dynamic-link.h (_ELF_DYNAMIC_DO_RELOC): Likewise.
	(elf_get_dynamic_info): Likewise.
	* elf/do-lookup.h (FCT): Likewise.
	* elf/do-rel.h (elf_dynamic_do_rel): Likewise.
	* elf/dl-deps.c (_dl_map_object_deps): Likewise.
	* elf/dl-addr.c (_dl_addr): Likewise.
	* elf/dl-runtime.c (profile_fixup): Likewise.
	(fixup): Likewise.
	* elf/dl-init.c (_dl_init_next): Likewise.
	* sysdeps/generic/dl-machine.h (elf_machine_runtime_setup): Likewise.
	* sysdeps/unix/sysv/linux/i386/dl-librecon.h
	(DISTINGUISH_LIB_VERSIONS): Likewise.
	* sysdeps/i386/dl-machine.h (elf_machine_runtime_setup): Likewise.
	(elf_machine_rel): Likewise.

	* elf/dynamic-link.h (elf_get_dynamic_info): Only change l_info
	for writable dynamic section.

2000-03-22  Ulrich Drepper  <drepper@redhat.com>

	* inet/getnameinfo.c (getnameinfo): Check that addrlen value is
	large enough.  Patch by YOSHIFUJI Hideaki <yoshfuji@v6.linux.or.jp>.

2000-03-22  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/powerpc/bits/mman.h (MADV_*): Add flags
	from latest Linux kernel.

2000-03-21  Andreas Jaeger  <aj@suse.de>

	* Versions.def: Add version 2.1.4.

2000-03-21  Ulrich Drepper  <drepper@redhat.com>

	* libio/oldtmpfile.c: Update for new SHLIB_COMPAT definition.
	* libio/oldiofopen.c: Likewise.
	* libio/oldiofclose.c: Likewise.
	* sysdeps/unix/sysv/linux/errlist.c: Likewise.

2000-03-22  Roland McGrath  <roland@baalperazim.frob.com>

	* include/shlib-compat.h (SHLIB_COMPAT): Take a third argument,
	indicating the first version set to obsolete the conditionalized code.
	(compat_symbol): New macro.
	* scripts/abi-versions.awk: For subsumed versions, make ABI_* defn's
	rhs be the ABI_* macro for the subsuming version.  Assign increasing
	integer values to the ABI_* macros for supported versions.
	* sysdeps/gnu/siglist.c: Use new SHLIB_COMPAT convention, and use
	compat_symbol macro.

2000-03-21  Ulrich Drepper  <drepper@redhat.com>

	* nscd/connections.c (nscd_run): Pretty print.
	* elf/dl-runtime.c: Include stdlib.h for alloca prototype.

	* manual/charset.texi: Fix typos.  Rephrase.
	* manual/process.texi: Likewise.
	* manual/signal.texi: Likewise.
	Patches by Mike Coleman <mkc@kc.net>.

	* libio/oldtmpfile.c: Use new macros from shlib-compat.h to define
	versions.
	* libio/iofdopen.c: Likewise.
	* libio/iofgetpos.c: Likewise.
	* libio/iofgetpos64.c: Likewise.
	* libio/iofopen.c: Likewise.
	* libio/iofsetpos.c: Likewise.
	* libio/iofsetpos64.c: Likewise.
	* libio/iopopen.c: Likewise.
	* libio/oldiofopen.c: Likewise.
	* libio/pclose.c: Likewise.
	* sysdeps/gnu/siglist.c: Likewise.
	* sysdeps/unix/sysv/linux/errlist.c: Likewise.

	* include/shlib-compat.h (versioned_symbol): Give preprocessor the
	chance to expand VERSION_##lib##_##version.

	* libio/fileops.c: Use new macros from shlib-compat.h to define
	versions.
	* libio/iofclose.c: Likewise.
	* libio/oldiofclose.c: Likewise.
	Patch by Roland McGrath <roland@frob.com>.

2000-03-21  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/sparc/bits/sigcontext.h: Clean up namespace.
	Lay out struct sigcontext according to what really gets passed on
	the stack.
	* sysdeps/unix/sysv/linux/sparc/sys/procfs.h: Don't include asm/elf.h.
	(elf_gregset_t, elf_greg_t, elf_fpregset_t, ELF_NGREG): Define.
	(prgregset_t, prfpregset_t): Define to elf_* types.
	* sysdeps/unix/sysv/linux/sparc/sys/ptrace.h (PTRACE_WRITEDATA):
	Define to correct value.
	* sysdeps/unix/sysv/linux/sparc/sparc32/profil-counter.h: Use struct
	sigcontext.
	* sysdeps/unix/sysv/linux/sparc/sparc32/sigcontextinfo.h: Likewise.

2000-03-21  Roland McGrath  <roland@baalperazim.frob.com>

	* scripts/firstversions.awk: Allow multiple version sets in the
	"earliest version" specification, meaning that version sets in the
	gaps between listed versions should be folded into the earliest later
	version that is explicitly listed.
	* shlib-versions (mips.*-.*-linux.*): Use that syntax for to say
	we support GLIBC_2.0 and GLIBC_2.2 but not the intervening sets.

2000-03-21  Ulrich Drepper  <drepper@redhat.com>

	* iconv/gconv_builtin.c: Include <endian.h>.
	* iconv/gconv_builtin.h: Add UCS-BE aliases.
	Add UCS-4LE transformation.  Define UNICODEBIG and UNICODELITTLE
	according to current platform.
	* iconv/gconv_int.h: Declare __gconv_transform_ucs2reverse_internal,
	__gconv_transform_internal_ucs2reverse, and
	__gconv_transform_internal_ucs4le.
	* iconv/gconv_simple.c: Implement __gconv_transform_internal_ucs4le,
	__gconv_transform_ucs2reverse_internal and
	__gconv_transform_internal_ucs2reverse.
	* iconvdata/Makefile (modules): Add UNICODE.
	(distribute): Add unicode.c.
	* iconvdata/gconv-modules: Add definitions for UNICODE module.
	* iconvdata/unicode.c: New file.

	* iconvdata/utf-16.c: Rewrite code to emit BOM.  Correct code to
	determine byte order of input and convert accordingly.

	* iconvdata/utf-16.c (gconv_init): Fix typo.

2000-03-20  Ulrich Drepper  <drepper@redhat.com>

	* iconvdata/gconv-modules: Fix typo.

	* sysdeps/unix/sysv/linux/configure.in: Remove `crypt' from one
	more messages.

	* sysdeps/unix/sysv/aix/*: Add initial code for port to AIX 4.3.

2000-03-16  Thorsten Kukuk  <kukuk@suse.de>

	* sysdeps/unix/sysv/linux/sparc/bits/sigcontext.h: New.

2000-03-20  Ulrich Drepper  <drepper@redhat.com>

	* misc/Makefile (routines): Add mincore.

2000-03-20  Andreas Jaeger  <aj@suse.de>

	* sysdeps/generic/mincore.c: New stub file.

	* sysdeps/unix/sysv/linux/arm/bits/mman.h (MADV_*): Add flags
	from latest Linux kernel.

2000-03-20  Ulrich Drepper  <drepper@redhat.com>

	* grp/initgroups.c (compat_call): Use _SC_GETGR_R_SIZE_MAX instead of
	_SC_GETPW_R_SIZE_MAX.

2000-03-20  Richard Henderson  <rth@cygnus.com>

	* sysdeps/unix/sysv/linux/alpha/Versions: Put pciconfig_iobase
	in GLIBC_2.1.4.

2000-03-20  Richard Henderson  <rth@cygnus.com>

	* sysdeps/alpha/fpu/fraiseexcpt.c: Use get/set_fp_control instead
	of arithmetic instructions.

	* sysdeps/alpha/fpu/s_ceil.c: Use round to -inf instead of playing
	with the fpcr.  Protect from INV exception.
	* sysdeps/alpha/fpu/s_ceilf.c: Likewise.
	* sysdeps/alpha/fpu/s_floor.c: Protect from INV exception.
	* sysdeps/alpha/fpu/s_floorf.c: Likewise.

	* sysdeps/alpha/fpu/s_copysign.c: New.
	* sysdeps/alpha/fpu/s_copysignf.c: New.
	* sysdeps/alpha/fpu/s_fabs.c: New.
	* sysdeps/alpha/fpu/s_fabsf.c: New.
	* sysdeps/alpha/fpu/s_rint.c: New.
	* sysdeps/alpha/fpu/s_rintf.c: New.

	* sysdeps/unix/sysv/linux/alpha/bits/mman.h: Add MADV constants.

	* sysdeps/unix/sysv/linux/alpha/Makefile (sysdep_routines):
	Kill sethae.
	* sysdeps/unix/sysv/linux/alpha/Versions: Add pciconfig_iobase.
	* sysdeps/unix/sysv/linux/alpha/ioperm.c (all address constants):
	Use physical addresses not KSEG addresses.
	(io_system): Add PYXIS.
	(io): Remove hae.reg, sys, hae_shift.
	(stb_mb, stw_mb, stl_mb, __sethae): New.
	(inline_outb, inline_outw, inline_outl): Don't set hae.
	(inline_inb, inline_inw, inline_inl): Likewise.
	(dense_sethae): New null function.
	(struct cpuinfo_data): New.
	(process_cpuinfo): Use local and stack variables, not static.
	Move readlink check here from init_iosys.
	(init_iosys): Use __pciconfig_iobase first.  Know SX and LX as PYXIS.
	(_iopl): Simplify.
	(_hae_shift): Calculate it here.
	* sysdeps/unix/sysv/linux/alpha/syscalls.list: Remove sethae,
	add pciconfig_iobase.

2000-03-20  Roland McGrath  <roland@baalperazim.frob.com>

	* locale/programs/ld-time.c (time_finish): Use %Z instead of %z.
	* locale/programs/ld-ctype.c (ctype_finish, ctype_class_new): Likewise.

	* scripts/versions.awk: Fixed version renaming code to distinguish
	libraries properly.

2000-03-19  Ulrich Drepper  <drepper@redhat.com>

	* include/stdlib.h: Add prototype for __cxa_atexit.

	* sysdeps/unix/sysv/linux/i386/sys/debugreg.h: Update comment about
	_SLOWDOWN flags.  Patch by Jim Blandy <jimb@cygnus.com>.

2000-03-17  Cristian Gafton  <gafton@redhat.com>

	* elf/Makefile ($(rtld-version-installed-name)): Delay replacing
	existing rtld-installed-name.
	($(rtld-installed-name)): Request libc-$(version) be installed too.
	replace existing rtld-installed-name using $(symbolic-link-prog).

2000-03-17  Roland McGrath  <roland@baalperazim.frob.com>

	* locale/programs/ld-collate.c (collate_read): Remove bogus cast.
	(insert_value, handle_ellipsis, collate_read): Replace %zu in format
	strings with %Zu, because gcc-2.95.2's -Wformat knows about the latter
	but not the former.

2000-03-19  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/generic/glob.c [_LIBC]: Always use __xstat64, not only for
	glob64.  Since there is no glob64 in the LFS proposal applications
	can assume that glob handles LFS situations.  glob64 is only needed
	if alternative filesystem functions are used.

2000-03-19  Geoff Clare  <gwc@unisoft.com>

	* sysdeps/generic/glob.c: Correct gl_pathc value returned
	when GLOB_DOOFFS is set; correct handling of patterns
	containing escaped wildcards (and no unescaped ones);
	GLOB_ERR flag was being ignored in some situations.

	* posix/globtest.c, posix/globtest.sh: Updated to include
	tests for the problems fixed by the above changes to glob.c.

	* manual/pattern.texi (Calling Glob): Update description of gl_pathc.

2000-03-19  Roland McGrath  <roland@baalperazim.frob.com>

	* Makeconfig (soversion.i): Use only first match for each lib.

	* Makeconfig (soversion.i): Pass -undef to $(CC) -E.

	* Makerules (Versions.all, sysd-versions): Test $(sysd-sorted-done)
	rather than $(sysd-dirs-done) to protect these rules.

	* Makerules (version-renames.def): Target removed.
	(Versions.all): Depend on soversions.i directly and parse it.

	* Makeconfig (soversions.i): New target, input-reading parts of
	soversions.mk generation moved here; result is a canonicalized
	list "LIB VERSION [SET]" for this configuration.
	(soversions.mk): Use that as input.  Don't emit map-firstversions.
	* Makerules (version-renames.def): New target, generated from
	soversions.i with contents that was in $(map-firstversions).
	(Versions.all): Don't depend on soversions.mk, depend on
	version-renames.def instead; just cat it into the input.

	* Makerules (Versions.all): Use $(foreach ...) instead of sh for loop
	for $(map-firstversions), which better handles it being empty.

	* shlib-versions [USE_IN_LIBIO] (.*-.*-gnu-gnu*): Set earliest
	supported version for libc 0.2.90.libio to GLIBC_2.2.

	* Makeconfig (soversions.mk): Grok new third column in shlib-versions,
	and use it to emit new variable `map-firstversions'.
	* scripts/firstversions.awk: New file.
	* Makerules (Versions.all): Use scripts/firstversions.awk and
	the $(map-firstversions) value to generate a modified versions list
	that includes renames in "A = B" syntax for each version set earlier
	than the "earliest symbol version" named in shlib-versions.
	* scripts/versions.awk: Recognize "A = B" lines in the input to mean
	rename version set A to B in the output to the intermediate file.
	* scripts/abi-versions.awk: New file.
	* Makerules (abi-versions.h): New target, generated by that script.
	[$(versioning) = yes] (before-compile): Prepend abi-versions.h.
	* include/shlib-compat.h: New file, uses that generated header.

2000-03-18  Roland McGrath  <roland@baalperazim.frob.com>

	* Makeconfig (soversions.mk): Convert % -> # in shlib-versions
	after stripping # comments, and then run it through cpp.
	This allows things like "%ifdef FOO" based on config.h settings.
	* shlib-versions [USE_IN_LIBIO] (.*-.*-gnu-gnu*): libc=0.2.90.libio

	* hurd/intr-msg.c (_hurd_intr_rpc_mach_msg): For MACH_SEND_INTERRUPTED
	and other errors that indicate a pseudo-receive happened, grok through
	the message buffer for port rights that need references fixed up.

2000-03-16  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/syscalls.list: Added madvise and mincore.

	* sysdeps/unix/sysv/linux/madvise.c: Remove.

	* sysdeps/unix/sysv/linux/sparc/bits/mman.h (MADV_*): Add flags
	from latest Linux kernel.
	* sysdeps/unix/sysv/linux/i386/bits/mman.h (MADV_*): Likewise.

	* misc/sys/mman.h: Add prototype for mincore.

2000-03-17  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/i386/syscalls.list: Add oldsetrlimit
	entry for GLIBC_2.0 version of setrlimit.
	Patch by Shinya Hanataka <hanataka@abyss.rim.or.jp>.

2000-03-16  Thorsten Kukuk  <kukuk@suse.de>

	* nis/nss_nis/nis-ethers.c: Return with error if malloc fails.
	* nis/nss_compat/compat-initgroups.c: Likewise.
	* nis/nss_nis/nis-initgroups.c: Likewise.
	* nis/nss_nis/nis-netgrp.c: Likewise.
	* nis/nss_nis/nis-proto.c: Likewise.
	* nis/nss_nis/nis-rpc.c: Likewise.
	* nis/nss_nis/nis-service.c: Likewise.
	* nis/ypclnt.c: Likewise.

2000-03-16  Andreas Jaeger  <aj@suse.de>

	* manual/Makefile: MAKEINFO is set to `:' from configure if it
	doesn't exist, correct checks.  Fixes PR libc/1649.

2000-03-16  Thorsten Kukuk  <kukuk@suse.de>

	* nscd/hstcache.c: Restore correct UID.
	* nscd/pwdcache.c: Likewise.
	Patch from Gabor Gombas <gombasg@inf.elte.hu>.

2000-03-17  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/i386/sys/ucontext.h: Prepend REG_ to enum values and
	macros for register names, in line with 2000-03-14 linux change.

	* sysdeps/mach/sched_yield.c: New file.

2000-03-13  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/generic/lockfile.c: Include <stdio.h>
	(_IO_flockfile, _IO_funlockfile, _IO_ftrylockfile): #undef these in
	case <libio.h> defined them.
	(__flockfile, __funlockfile, __ftrylockfile): Functions renamed
	from __internal_*.
	(flockfile, _IO_flockfile, funlockfile, _IO_funlockfile,
	ftrylockfile, _IO_ftrylockfile): Fix aliases accordingly.

	* sysdeps/generic/bits/stdio-lock.h (_IO_lock_initializer): Use ...
	for more pleasing parse error.

2000-03-16  Ulrich Drepper  <drepper@redhat.com>

	* locale/lc-time.c (_nl_init_era_entries): Correct allocation of
	memory for eras.
	Patch by Shinya Hanataka <hanataka@abyss.rim.or.jp>.

	* elf/Makefile: Add rules to compile and run constload1 test.
	* elf/constload1.c: New file.
	* elf/constload2.c: New file.
	* elf/constload3.c: New file.

2000-03-15  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/posix/open64.c: Make __open64 weak alias.
	* sysdeps/posix/pread64.c: Make __pread64 weak alias.
	* sysdeps/unix/sysv/linux/pread64.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/pread64.c: Likewise.
	* sysdeps/unix/sysv/linux/mips/pread64.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/pread64.c: Likewise.
	* sysdeps/posix/pwrite64.c: Make __pwrite64 weak alias.
	* sysdeps/unix/sysv/linux/pwrite64.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/pwrite64.c: Likewise.
	* sysdeps/unix/sysv/linux/mips/pwrite64.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/pwrite64.c: Likewise.

2000-03-14  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/alpha/ioperm.c (platform): Add entry for
	Nautilus.  Patch by Soohoon Lee <soohoon.lee@alpha-processor.com>.

2000-03-16  Mark Kettenis  <kettenis@gnu.org>

	* sysdeps/unix/sysv/linux/i386/sys/procfs.h (prfpregset_t):
	Typedef for elf_fpregset_t instead of `elf_fpregset_t *'.

2000-03-08  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/scsi/sg.h: Sync with Linux 2.3.50.

2000-03-14  Ulrich Drepper  <drepper@redhat.com>

	* timezone/africa: Update from tzdata2000d.
	* timezone/asia: Likewise.
	* timezone/australasia: Likewise.
	* timezone/europe: Likewise.
	* timezone/northamerica: Likewise.
	* timezone/southamerica: Likewise.

	* po/fr.po: Update from translation team.
	* po/de.po: Likewise.

	* elf/dl-deps.c (_dl_map_object_deps): Change return type and remove
	last parameter.  Move code to add map to global scope from here...
	* elf/dl-open.c (dl_open_worker): ...here.
	* elf/ldsodefs.h: Adjust declaration of _dl_map_object_deps.
	* elf/rtld.c: Adjust call to _dl_map_object_deps.

	* locale/programs/ld-collate.c (collate_read): Fix warning.

	* sysdeps/unix/sysv/linux/i386/sys/ucontext.h: Prepend REG_ to enum
	values and macros for register names.

	* libio/iofopncook.c (_IO_cookie_seek): Return error only if value
	returned by seek cookie function is -1.

2000-03-14  Andreas Jaeger  <aj@suse.de>

	* locale/localeconv.c (localeconv): Fix typo.
	Reported by Andre Charbonneau <andrec@corel.com>.

2000-03-14  Ulrich Drepper  <drepper@redhat.com>

	* iconv/skeleton.c: Increment __invocation_counter in inner loop
	since modules depend on it counting the number of times the conversion
	function got called.

	* iconv/gconv_open.c: Optimize loop to setup step data structure.

	* iconv/gconv.h: Pretty print.

2000-03-04  Ulrich Drepper  <drepper@redhat.com>

	* posix/wordexp-test.c: Correct one of the tests added in the last
	change.  Really get the root passwd entry to check again ~root.

2000-03-10  Andreas Jaeger  <aj@suse.de>

	* manual/filesys.texi (Working Directory): Fix last patch.
	Patch by Martin Buchholz  <martin@xemacs.org>.

2000-03-10  Andreas Jaeger  <aj@suse.de>

	* manual/creature.texi (Feature Test Macros): Fix language.

2000-03-10  Roland McGrath  <roland@baalperazim.frob.com>

	* mach/devstream.c (devstream_write, devstream_read): New functions.
	(input, output): Functions removed.
	(mach_open_devstream): Use devstream_{read,write} as cookie functions,
	using only the vanilla fopencookie interface.

	* hurd/fopenport.c [! USE_IN_LIBIO] (cookie_io_functions_t): Define
	as macro for __io_functions.
	(funcsio): Use cookie_io_functions_t type name.
	(fopenport): Renamed from __fopenport.  Rewrite to call fopencookie.

	* libio/iofopncook.c (_IO_cookie_init): New function, broken out of
	fopencookie.
	(fopencookie): Use it.
	* libio/libio.h: Declare _IO_cookie_init.
	* hurd/vpprintf.c (vpprintf) [USE_IN_LIBIO]: Implement using
	_IO_cookie_init.

	* libio/libio.h (__io_seek_fn): Fix second argument type
	to be a pointer, in line with the manual and the old stdio.
	* libio/iofopncook.c (_IO_cookie_seek): Fix (sole) caller.

	* sysdeps/generic/bits/stdio-lock.h: New file.
	This is a stub with #error, but that's better than no file at all.

2000-03-09  Martin Buchholz  <martin@xemacs.org>

	* sysdeps/unix/sysv/linux/alpha/syscall.S: Doc Fixes.
	* manual/message.texi (Using gettextized software): Doc Fixes.
	* manual/message.texi (Message Translation): Doc Fixes.
	* manual/filesys.texi (File Size): Doc Fixes.
	* manual/charset.texi (glibc iconv Implementation): Doc Fixes.
	* locale/programs/ld-collate.c (collate_output): Doc Fixes.
	* iconv/gconv_db.c (find_derivation): Doc Fixes.
	* manual/install.texi: Doc Fixes.
	* manual/search.texi (Hash Search Function): Doc Fixes.
	* manual/stdio.texi (Output Conversion Syntax): Doc Fixes.
	* FAQ.in: Doc Fixes.
	* config.h.in: Doc Fixes.
	* sysdeps/generic/dl-sysdep.c: Doc Fixes.
	Doc Fixes.  `allows to' is not correct English.

	* elf/rtld.c: Doc fixes.
	* manual/creature.texi (Feature Test Macros): Doc fixes.
	* manual/memory.texi (Hooks for Malloc): Doc Fixes.

	* manual/filesys.texi (Working Directory): Check for ERANGE to
	avoid infloop.

2000-02-23  Roland McGrath  <roland@baalperazim.frob.com>

	* string/argz-stringify.c (__argz_stringify): Fix loop termination
	conditions so as not to clobber the final '\0' when there is only one
	element in the vector.

2000-03-09  Roland McGrath  <roland@baalperazim.frob.com>

	* io/sys/stat.h: Fix inverted sense of `defined __S_IFSOCK' test,
	broken by 2000-02-27 change.

	* sysdeps/generic/bits/poll.h (POLLRDNORM, POLLRDBAND): New macros.

2000-02-23  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/mach/hurd/sigstack.c (sigstack): Remove `const' from
	argument type, for 2000-02-22 change in signal/signal.h declaration.

2000-03-09  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/generic/getdents64.c (__getdirentries64): Renamed
	to getdirentries64 (no __), since the Linux implementation
	has no __ name, and there is no declaration for the __ name.

	* sysdeps/mach/bits/libc-lock.h (__libc_cleanup_end): New macro.

	* sysdeps/mach/hurd/Makefile ($(common-objpfx)errnos.d): Tighten up
	sed regexp so as not to break directory names including /../ within.

	* sysdeps/unix/bsd/bits/waitflags.h: File removed.
	The sysdeps/generic file is right for BSD.  This file was in fact the
	Hurd file, but the only difference was the WNOREAP flag that was never
	actually implemented or used anywhere.

	* configure.in (PERL, INSTALL_INFO): Don't AC_SUBST these,
	since AC_PATH_PROG already does it for us.
	(PERL): Rewrite check added in 2000-02-29 change for syntactic
	correctness and sh portability.  I replaced the broken check
	with a more sensible implementation of the apparently intended
	semantics, which might still be questionable.  Using expr causes
	a non-numeric value for `perl -V:apiversion` to be accepted,
	refusing to use only a perl that reports a number less than 5;
	on my system, perl (5.004_04) -V:apiversion produces UNKNOWN.
	* configure: Regenerated.

2000-03-08  Andreas Jaeger  <aj@suse.de>

	* manual/crypt.texi: Fix paths.

2000-03-07  Andreas Jaeger  <aj@suse.de>

	* resolv/netdb.h: The descriptions of rresvport and rresvport_af
	were swapped.
	Patch by YOSHIFUJI Hideaki <yoshfuji@ecei.tohoku.ac.jp>, closes PR
	libc/1636.

2000-03-06  Andreas Jaeger  <aj@suse.de>

	* sysdeps/i386/fpu/bits/mathinline.h: Fix union definition error
	in __sgn1l, otherwise g++ fails to parse this.
	Reported by Sean Chen <sean.chen@turbolinux.com>.

2000-03-03  Geoff Keating  <geoffk@cygnus.com>

	* configure.in: Compute sizeof-long-double.
	* configure: Regenerated.
	* config.make.in: Make sizeof-long-double available to sub-makes.

2000-03-03  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/init-first.c: Remove trace of personality
	call.

2000-03-03  Geoff Keating  <geoffk@cygnus.com>

	* Makeconfig (rpath-dirs): Add crypt.
	(all-subdirs): Remove md5crypt.
	* crypt/sysdeps/unix/crypt.c: Move to crypt/.
	* crypt/sysdeps/unix/crypt-entry.c: Move to crypt/.
	* sysdeps/generic/crypt-entry.c: Delete.
	* crypt/sysdeps/unix/crypt.h: Move to crypt/.
	* sysdeps/generic/crypt.h: Delete.
	* crypt/sysdeps/unix/crypt-private.h: Move to crypt/.
	* crypt/sysdeps/unix/crypt_util.c: Move to crypt/.
	* crypt/sysdeps/unix/des_impl.c: Move to sunrpc/.
	* sysdeps/generic/des_impl.c: Delete.
	* crypt/sysdeps/unix/ufc-crypt.h: Move to crypt/.
	* crypt/sysdeps: Delete.
	* crypt/crypt_util.c: Don't use `patchlevel.h'.
	* md5-crypt/Versions: Move to crypt/.
	* md5-crypt/md5-crypt.c: Move to crypt/.
	* md5-crypt/md5.c: Move to crypt/.
	* md5-crypt/md5c-test.c: Move to crypt/.
	* md5-crypt/md5test.c: Move to crypt/.
	* md5-crypt: Delete.
	* crypt/Makefile: Adjust for new structure.

2000-03-03  Paul Eggert  <eggert@twinsun.com>

	* posix/regex.c (MB_LEN_MAX): Include <limits.h> to define;
	define to 1 if not defined.

2000-03-03  Andreas Jaeger  <aj@suse.de>

	* sunrpc/xdr.c (xdr_hyper): Correctly handle lower half of llp.

2000-03-03  Andreas Jaeger  <aj@suse.de>

	* sunrpc/xdr_intXX_t.c (xdr_uint16_t): Fix ENCODE and DECODE
	cases.
	(xdr_int64_t): Correctly handle lower half.
	Fix by Sten Dahlgren <stda@enea.se>, closes PR libc/1623.

2000-03-03  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/init-first.c: Remove trace of personality
	call.

2000-03-02  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/scsi/sg.h: Integrate changes from Linux
	2.3.43.

2000-03-02  Andreas Jaeger  <aj@suse.de>

	* resolv/Makefile (headers): Add arpa/nameser_compat.h.

2000-03-01  Andreas Jaeger  <aj@suse.de>

	* time/Makefile (tst-getdate-ENV): New flag to pass DATEMSK.
	(tests): Added tst-getdate.

	* time/tst-getdate.c: New file.

	* time/datemsk: New file, needed for tst-getdate.

2000-02-29  Cristian Gafton  <gafton@redhat.com>

	* configure.in (CCVERSION): Require at least veersion 5 of perl API.

2000-02-17  H.J. Lu  <hjl@gnu.org>

	* sunrpc/rpc/svc.h (SVCXPRT): Add a "xp_pad" field at the end.

	* sunrpc/svc_udp.c (svcudp_bufcreate): Turn on IP_PKTINFO if
	available.
	(svcudp_recv): Set up message with the new "xp_pad" field for
	IP_PKTINFO.
	(svcudp_reply): Support IP_PKTINFO if available.

2000-03-01  Andreas Jaeger  <aj@suse.de>

	* time/getdate.c (check_mday): Fix check for february.
	Reported by ane@np.bs1.fc.nec.co.jp and Akira YOSHIYAMA
	<yosshy@cts.ne.jp>, closes PR libc/1617 and PR libc/1619.

2000-03-02  Andreas Jaeger  <aj@suse.de>

	* posix/unistd.h: __THROW has to precede __attribute__, otherwise
	g++ fails to parse this.
	Reported by Sean Chen <sean.chen@turbolinux.com>.

2000-02-28  Ulrich Drepper  <drepper@redhat.com>

	* io/creat.c: Moved to...
	* sysdeps/generic/creat.c: ...here.
	* io/creat64.c: Moved to...
	* sysdeps/generic/creat64.c: ...here.
	* io/lockf.c: Moved to...
	* sysdeps/generic/lockf.c: ...here.

	* crypt/crypt.texi: Moved to...
	* manual/crypt.texi: ...here.
	* crypt/examples/genpass.c: Moved to...
	* manual/examples/genpass.c: ...here.
	* crypt/examples/mygenpass.c: Moved to...
	* manual/examples/mygenpass.c: ...here.
	* crypt/examples/testpass.c: Moved to...
	* manual/examples/testpass.c: ...here.

	* manual/Makefile (chapters): Add crypt.
	* manual/conf.texi: Add usual header for not-last chapter.
	* manual/crypt.texi: Add special header for last chapter.

2000-02-28  Geoff Keating  <geoffk@cygnus.com>

	* Makeconfig (all-subdirs): Add 'crypt' subdirectory.
	* sysdeps/unix/sysv/linux/configure.in (inhibit_glue): Don't
	complain if there is no crypt add-on.
	* crypt/configure: Removed.

	* crypt/crypt.texi: Update documentation of US export restrictions
	to match the 14 Jan 2000 regulations.

2000-02-28  Geoff Keating  <geoffk@cygnus.com>

	* crypt: New subdirectory, merged in from the crypt add-on.

2000-02-28  Ulrich Drepper  <drepper@redhat.com>

	* include/unistd.h: Add __rmdir and __mkdir prototypes.


See ChangeLog.10 for earlier changes.
